
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="yuygfgg">
      
      
      
        <link rel="prev" href="postfix2infix.html">
      
      
        <link rel="next" href="transform.html">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>test_atan2 - y5gfunc</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#y5gfuncexprtest_atan2" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="y5gfunc" class="md-header__button md-logo" aria-label="y5gfunc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            y5gfunc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              test_atan2
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/yuygfgg/y5gfunc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    yuygfgg/y5gfunc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../utils.html" class="md-tabs__link">
          
  
  
  API

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="y5gfunc" class="md-nav__button md-logo" aria-label="y5gfunc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    y5gfunc
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/yuygfgg/y5gfunc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    yuygfgg/y5gfunc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Encode
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Encode
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/chapter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    chapter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/mux.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/qc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    qc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/subtitle.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    subtitle
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/video.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    video
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_2_7" id="__nav_2_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            Audio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/audio/audio.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    audio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/audio/audio_config.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    audio_config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../encode/audio/utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Expr
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Expr
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="emulator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="expr_utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    expr_utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="infix2postfix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    infix2postfix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="optimize.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    optimize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="postfix2infix.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    postfix2infix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="test_atan2.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    test_atan2
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="transform.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="verify.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    verify
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Filter
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Filter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/aa.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aa
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/deband.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    deband
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/denoise.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    denoise
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/ivtc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ivtc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/mask.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mask
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/morpho.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    morpho
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/resample.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    resample
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/rescale.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rescale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/scenecut.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scenecut
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/stripe.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    stripe
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/temporal.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    temporal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/tonemap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tonemap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter/utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Preview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Preview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview/output.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    output
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preview/screen_shot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    screen_shot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Shader
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Shader
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shader/chroma.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    chroma
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shader/superes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    superes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shader/lazy_loader/lazy_loader.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lazy_loader
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Source
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Source
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/rpu.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rpu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/source.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    source
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/timecodes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    timecodes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_4" >
        
          
          <label class="md-nav__link" for="__nav_2_7_4" id="__nav_2_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Wobbly
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_4">
            <span class="md-nav__icon md-icon"></span>
            Wobbly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/errors.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/types.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/utils.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_4_4" >
        
          
          <label class="md-nav__link" for="__nav_2_7_4_4" id="__nav_2_7_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_4_4">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/core/context.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/core/presets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    presets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/core/source.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    source
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_4_5" >
        
          
          <label class="md-nav__link" for="__nav_2_7_4_5" id="__nav_2_7_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Io
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_4_5">
            <span class="md-nav__icon md-icon"></span>
            Io
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/io/json.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    json
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/io/video.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    video
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_4_6" >
        
          
          <label class="md-nav__link" for="__nav_2_7_4_6" id="__nav_2_7_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Processors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_4_6">
            <span class="md-nav__icon md-icon"></span>
            Processors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/crop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    crop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/custom_lists.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    custom_lists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/resize.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    resize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/sections.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sections
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/special_frames.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    special_frames
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/processors/trim.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trim
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_4_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7_4_7" id="__nav_2_7_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Timecodes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_4_7">
            <span class="md-nav__icon md-icon"></span>
            Timecodes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/timecodes/base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/timecodes/v1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    v1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../source/wobbly/timecodes/v2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    v2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Vfx
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Vfx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vfx/draw_2d.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    draw_2d
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vfx/draw_3d.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    draw_3d
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vfx/misc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    misc
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="y5gfuncexprtest_atan2"><code>y5gfunc.expr.test_atan2</code><a class="headerlink" href="#y5gfuncexprtest_atan2" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<h1 id="y5gfunc.expr.test_atan2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">test_atan2</span>


<a href="#y5gfunc.expr.test_atan2" class="headerlink" title="Permanent link">&para;</a></h1>

    <div class="doc doc-contents first">






<p><span class="doc-section-title">Modules:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            infix2postfix (y5gfunc.expr.test_atan2.infix2postfix)" href="infix2postfix.html#y5gfunc.expr.infix2postfix">infix2postfix</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            postfix2infix (y5gfunc.expr.test_atan2.postfix2infix)" href="postfix2infix.html#y5gfunc.expr.postfix2infix">postfix2infix</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            rescale (y5gfunc.expr.test_atan2.rescale)" href="../filter/rescale.html#y5gfunc.filter.rescale">rescale</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            screen_shot (y5gfunc.expr.test_atan2.screen_shot)" href="../preview/screen_shot.html#y5gfunc.preview.screen_shot">screen_shot</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            tonemap (y5gfunc.expr.test_atan2.tonemap)" href="../filter/tonemap.html#y5gfunc.filter.tonemap">tonemap</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Classes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            OptimizeLevel (y5gfunc.expr.test_atan2.OptimizeLevel)" href="#y5gfunc.expr.test_atan2.OptimizeLevel">OptimizeLevel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Optimization level.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ConstantValues


  
      dataclass
   (y5gfunc.expr.test_atan2.ConstantValues)" href="#y5gfunc.expr.test_atan2.ConstantValues">ConstantValues</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.expr.test_atan2.BM3DPreset)" href="#y5gfunc.expr.test_atan2.BM3DPreset">BM3DPreset</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>BM3D speed vs quality presets. <code>MAGIC</code> is better classified as tune but whatever.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DescaleMode (y5gfunc.expr.test_atan2.DescaleMode)" href="#y5gfunc.expr.test_atan2.DescaleMode">DescaleMode</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.expr.test_atan2.ColorMatrixManager)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager">ColorMatrixManager</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Manager for a specific RGB-OPP conversion matrix and its related transformations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ColorSpace (y5gfunc.expr.test_atan2.ColorSpace)" href="#y5gfunc.expr.test_atan2.ColorSpace">ColorSpace</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Color spaces used in tonemapping operations.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ColorPrimaries (y5gfunc.expr.test_atan2.ColorPrimaries)" href="#y5gfunc.expr.test_atan2.ColorPrimaries">ColorPrimaries</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Color primaries standards.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            GamutMapping (y5gfunc.expr.test_atan2.GamutMapping)" href="#y5gfunc.expr.test_atan2.GamutMapping">GamutMapping</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Gamut mapping functions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ToneMappingFunction (y5gfunc.expr.test_atan2.ToneMappingFunction)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction">ToneMappingFunction</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Tone mapping functions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            Metadata (y5gfunc.expr.test_atan2.Metadata)" href="#y5gfunc.expr.test_atan2.Metadata">Metadata</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Metadata sources for tone-mapping.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ZoomMode (y5gfunc.expr.test_atan2.ZoomMode)" href="#y5gfunc.expr.test_atan2.ZoomMode">ZoomMode</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Controls the zoom behavior of <code>rotate_image</code> function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BoundaryMode (y5gfunc.expr.test_atan2.BoundaryMode)" href="#y5gfunc.expr.test_atan2.BoundaryMode">BoundaryMode</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Controls how boundary pixels are handled in <code>rotate_image</code> function.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            WobblySource (y5gfunc.expr.test_atan2.WobblySource)" href="#y5gfunc.expr.test_atan2.WobblySource">WobblySource</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Wobbly source processing class</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            RpuFile (y5gfunc.expr.test_atan2.RpuFile)" href="#y5gfunc.expr.test_atan2.RpuFile">RpuFile</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Represents a Dolby Vision RPU binary file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ProcessMode (y5gfunc.expr.test_atan2.ProcessMode)" href="#y5gfunc.expr.test_atan2.ProcessMode">ProcessMode</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Defines how an audio track should be processed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.expr.test_atan2.TrackConfig)" href="#y5gfunc.expr.test_atan2.TrackConfig">TrackConfig</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            AudioConfig


  
      dataclass
   (y5gfunc.expr.test_atan2.AudioConfig)" href="#y5gfunc.expr.test_atan2.AudioConfig">AudioConfig</a></code></td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            QcMode (y5gfunc.expr.test_atan2.QcMode)" href="#y5gfunc.expr.test_atan2.QcMode">QcMode</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Which metrics to use for quality check</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ReturnType (y5gfunc.expr.test_atan2.ReturnType)" href="#y5gfunc.expr.test_atan2.ReturnType">ReturnType</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>What to return after quality check</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.expr.test_atan2.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Represents a variable that is lazily loaded from a URL.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Functions:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            to_std_expr (y5gfunc.expr.test_atan2.to_std_expr)" href="#y5gfunc.expr.test_atan2.to_std_expr">to_std_expr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert an akarin.Expr expression to a std.Expr expression.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            optimize_akarin_expr (y5gfunc.expr.test_atan2.optimize_akarin_expr)" href="#y5gfunc.expr.test_atan2.optimize_akarin_expr">optimize_akarin_expr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Fold constants and convert dynamic pixel access to static when possible.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convert_drop (y5gfunc.expr.test_atan2.convert_drop)" href="#y5gfunc.expr.test_atan2.convert_drop">convert_drop</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Replaces all 'drop' and 'dropN' operations in an expression string with their std.Expr emulated equivalents.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convert_sort (y5gfunc.expr.test_atan2.convert_sort)" href="#y5gfunc.expr.test_atan2.convert_sort">convert_sort</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Expand sortN instructions in an RPN string to their equivalent min/max/swap/dup/varload(@)/varstore(!) sequences.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convert_var (y5gfunc.expr.test_atan2.convert_var)" href="#y5gfunc.expr.test_atan2.convert_var">convert_var</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Rewrite variable store/load (<code>x!</code>, <code>x@</code>) to stack ops (<code>dup</code>, <code>swap</code>, <code>drop</code>).</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convert_clip_names (y5gfunc.expr.test_atan2.convert_clip_names)" href="#y5gfunc.expr.test_atan2.convert_clip_names">convert_clip_names</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Replace clip names with their std.Expr equivalents.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convert_pow (y5gfunc.expr.test_atan2.convert_pow)" href="#y5gfunc.expr.test_atan2.convert_pow">convert_pow</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Replace ** with pow.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convert_clip_clamp (y5gfunc.expr.test_atan2.convert_clip_clamp)" href="#y5gfunc.expr.test_atan2.convert_clip_clamp">convert_clip_clamp</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Replace clip and clamp operators with their std.Expr equivalents.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            verify_akarin_expr (y5gfunc.expr.test_atan2.verify_akarin_expr)" href="#y5gfunc.expr.test_atan2.verify_akarin_expr">verify_akarin_expr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Verify if an expression is valid in akarin.Expr.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            verify_std_expr (y5gfunc.expr.test_atan2.verify_std_expr)" href="#y5gfunc.expr.test_atan2.verify_std_expr">verify_std_expr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Verify if an expression is valid in std.Expr.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            emulate_expr (y5gfunc.expr.test_atan2.emulate_expr)" href="#y5gfunc.expr.test_atan2.emulate_expr">emulate_expr</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Emulate Akarin.Expr with the given constants, clip values and properties.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            sakiko_deband (y5gfunc.expr.test_atan2.sakiko_deband)" href="#y5gfunc.expr.test_atan2.sakiko_deband">sakiko_deband</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Sakiko Togawa is good at de-band</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            Fast_BM3DWrapper (y5gfunc.expr.test_atan2.Fast_BM3DWrapper)" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper">Fast_BM3DWrapper</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>BM3D/V-BM3D denoising</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            hybrid_denoise (y5gfunc.expr.test_atan2.hybrid_denoise)" href="#y5gfunc.expr.test_atan2.hybrid_denoise">hybrid_denoise</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>mc_degrain + bm3d denoise</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            magic_denoise (y5gfunc.expr.test_atan2.magic_denoise)" href="#y5gfunc.expr.test_atan2.magic_denoise">magic_denoise</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Uses dark magic to denoise heavy grain from videos.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            adaptive_denoise (y5gfunc.expr.test_atan2.adaptive_denoise)" href="#y5gfunc.expr.test_atan2.adaptive_denoise">adaptive_denoise</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            TIVTC_VFR (y5gfunc.expr.test_atan2.TIVTC_VFR)" href="#y5gfunc.expr.test_atan2.TIVTC_VFR">TIVTC_VFR</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convenient wrapper on tivtc to perform automatic vfr decimation with one function.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            DBMask (y5gfunc.expr.test_atan2.DBMask)" href="#y5gfunc.expr.test_atan2.DBMask">DBMask</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Lolihouse's deband mask</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            AnimeMask (y5gfunc.expr.test_atan2.AnimeMask)" href="#y5gfunc.expr.test_atan2.AnimeMask">AnimeMask</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates edge/ringing mask for anime based on gradient operator.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_oped_mask (y5gfunc.expr.test_atan2.get_oped_mask)" href="#y5gfunc.expr.test_atan2.get_oped_mask">get_oped_mask</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            kirsch (y5gfunc.expr.test_atan2.kirsch)" href="#y5gfunc.expr.test_atan2.kirsch">kirsch</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            prewitt (y5gfunc.expr.test_atan2.prewitt)" href="#y5gfunc.expr.test_atan2.prewitt">prewitt</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            retinex_edgemask (y5gfunc.expr.test_atan2.retinex_edgemask)" href="#y5gfunc.expr.test_atan2.retinex_edgemask">retinex_edgemask</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            comb_mask (y5gfunc.expr.test_atan2.comb_mask)" href="#y5gfunc.expr.test_atan2.comb_mask">comb_mask</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Comb mask from TIVTC/TFM plugin.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            Gammarize (y5gfunc.expr.test_atan2.Gammarize)" href="#y5gfunc.expr.test_atan2.Gammarize">Gammarize</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            GammaMask (y5gfunc.expr.test_atan2.GammaMask)" href="#y5gfunc.expr.test_atan2.GammaMask">GammaMask</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            descale_cropping_args (y5gfunc.expr.test_atan2.descale_cropping_args)" href="#y5gfunc.expr.test_atan2.descale_cropping_args">descale_cropping_args</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            Descale (y5gfunc.expr.test_atan2.Descale)" href="#y5gfunc.expr.test_atan2.Descale">Descale</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            register_opp_matrix (y5gfunc.expr.test_atan2.register_opp_matrix)" href="#y5gfunc.expr.test_atan2.register_opp_matrix">register_opp_matrix</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Register a new OPP matrix variant and create its manager.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            yuv2opp (y5gfunc.expr.test_atan2.yuv2opp)" href="#y5gfunc.expr.test_atan2.yuv2opp">yuv2opp</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert YUV to OPP color space.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            opp2yuv (y5gfunc.expr.test_atan2.opp2yuv)" href="#y5gfunc.expr.test_atan2.opp2yuv">opp2yuv</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert OPP to YUV color space.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            rgb2opp (y5gfunc.expr.test_atan2.rgb2opp)" href="#y5gfunc.expr.test_atan2.rgb2opp">rgb2opp</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert RGB to OPP color space.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            opp2rgb (y5gfunc.expr.test_atan2.opp2rgb)" href="#y5gfunc.expr.test_atan2.opp2rgb">opp2rgb</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Convert OPP to RGB color space.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            SSIM_downsample (y5gfunc.expr.test_atan2.SSIM_downsample)" href="#y5gfunc.expr.test_atan2.SSIM_downsample">SSIM_downsample</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>SSIM downsampler</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            is_stripe (y5gfunc.expr.test_atan2.is_stripe)" href="#y5gfunc.expr.test_atan2.is_stripe">is_stripe</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Detects scenes potentially containing strong vertical stripes using FFT analysis.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            convolution (y5gfunc.expr.test_atan2.convolution)" href="#y5gfunc.expr.test_atan2.convolution">convolution</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            maximum (y5gfunc.expr.test_atan2.maximum)" href="#y5gfunc.expr.test_atan2.maximum">maximum</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            minimum (y5gfunc.expr.test_atan2.minimum)" href="#y5gfunc.expr.test_atan2.minimum">minimum</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            inflate (y5gfunc.expr.test_atan2.inflate)" href="#y5gfunc.expr.test_atan2.inflate">inflate</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            deflate (y5gfunc.expr.test_atan2.deflate)" href="#y5gfunc.expr.test_atan2.deflate">deflate</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            scd_koala (y5gfunc.expr.test_atan2.scd_koala)" href="#y5gfunc.expr.test_atan2.scd_koala">scd_koala</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Koala-36M Based Scenecut Detector</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            temporal_stabilize (y5gfunc.expr.test_atan2.temporal_stabilize)" href="#y5gfunc.expr.test_atan2.temporal_stabilize">temporal_stabilize</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Temporally stabilizes a processed video clip using motion compensation based on a reference clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            nn2x (y5gfunc.expr.test_atan2.nn2x)" href="#y5gfunc.expr.test_atan2.nn2x">nn2x</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Doubles the resolution of input clip with nnedi3.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            double_aa (y5gfunc.expr.test_atan2.double_aa)" href="#y5gfunc.expr.test_atan2.double_aa">double_aa</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Apply light anti-aliasing to input video clip. Suitable for recent non-descalable anime.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            is_optimized_cpu (y5gfunc.expr.test_atan2.is_optimized_cpu)" href="#y5gfunc.expr.test_atan2.is_optimized_cpu">is_optimized_cpu</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_line (y5gfunc.expr.test_atan2.draw_line)" href="#y5gfunc.expr.test_atan2.draw_line">draw_line</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw a line on a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_circle (y5gfunc.expr.test_atan2.draw_circle)" href="#y5gfunc.expr.test_atan2.draw_circle">draw_circle</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw a circle on a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_ellipse (y5gfunc.expr.test_atan2.draw_ellipse)" href="#y5gfunc.expr.test_atan2.draw_ellipse">draw_ellipse</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw an ellipse on a video clip, defined by its two focal points.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_bezier_curve (y5gfunc.expr.test_atan2.draw_bezier_curve)" href="#y5gfunc.expr.test_atan2.draw_bezier_curve">draw_bezier_curve</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw a cubic Bezier curve on a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_mandelbrot_zoomer (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer)" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer">draw_mandelbrot_zoomer</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw a zooming animation into the Mandelbrot set.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_spiral (y5gfunc.expr.test_atan2.draw_spiral)" href="#y5gfunc.expr.test_atan2.draw_spiral">draw_spiral</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw a spiral on a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            draw_3d_polyhedron (y5gfunc.expr.test_atan2.draw_3d_polyhedron)" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron">draw_3d_polyhedron</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Draw a 3D regular polyhedron on a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            render_triangle_scene (y5gfunc.expr.test_atan2.render_triangle_scene)" href="#y5gfunc.expr.test_atan2.render_triangle_scene">render_triangle_scene</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Renders a scene composed of triangles on a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            render_model_scene (y5gfunc.expr.test_atan2.render_model_scene)" href="#y5gfunc.expr.test_atan2.render_model_scene">render_model_scene</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Render a 3D model scene.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            load_mesh (y5gfunc.expr.test_atan2.load_mesh)" href="#y5gfunc.expr.test_atan2.load_mesh">load_mesh</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Load a 3D model from a file and apply transformations.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            rotate_image (y5gfunc.expr.test_atan2.rotate_image)" href="#y5gfunc.expr.test_atan2.rotate_image">rotate_image</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Rotate a video clip</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            reset_output_index (y5gfunc.expr.test_atan2.reset_output_index)" href="#y5gfunc.expr.test_atan2.reset_output_index">reset_output_index</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Resets the global output index counter and the set of used indices.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            set_preview (y5gfunc.expr.test_atan2.set_preview)" href="#y5gfunc.expr.test_atan2.set_preview">set_preview</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Outputs VapourSynth clips in vspreview.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            load_source (y5gfunc.expr.test_atan2.load_source)" href="#y5gfunc.expr.test_atan2.load_source">load_source</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Bestsource and Wobbly wrapper to load a video source.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_frame_timestamp (y5gfunc.expr.test_atan2.get_frame_timestamp)" href="#y5gfunc.expr.test_atan2.get_frame_timestamp">get_frame_timestamp</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get the timestamp of a frame in a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            clip_to_timecodes


  
      cached
   (y5gfunc.expr.test_atan2.clip_to_timecodes)" href="#y5gfunc.expr.test_atan2.clip_to_timecodes">clip_to_timecodes</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generate timecodes for a video clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            load_dv_p7 (y5gfunc.expr.test_atan2.load_dv_p7)" href="#y5gfunc.expr.test_atan2.load_dv_p7">load_dv_p7</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Loads a Dolby Vision Profile 7 video file.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            write_rpu (y5gfunc.expr.test_atan2.write_rpu)" href="#y5gfunc.expr.test_atan2.write_rpu">write_rpu</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Writes the RPU data to the clip.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            encode_audio (y5gfunc.expr.test_atan2.encode_audio)" href="#y5gfunc.expr.test_atan2.encode_audio">encode_audio</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Encodes or copies a single audio track from an input file using FFmpeg.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            extract_audio_tracks (y5gfunc.expr.test_atan2.extract_audio_tracks)" href="#y5gfunc.expr.test_atan2.extract_audio_tracks">extract_audio_tracks</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extracts and processes audio tracks from a media file based on AudioConfig.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_bd_chapter (y5gfunc.expr.test_atan2.get_bd_chapter)" href="#y5gfunc.expr.test_atan2.get_bd_chapter">get_bd_chapter</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extracts chapters from a Blu-ray MPLS or M2TS file to an OGM chapter file.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_mkv_chapter (y5gfunc.expr.test_atan2.get_mkv_chapter)" href="#y5gfunc.expr.test_atan2.get_mkv_chapter">get_mkv_chapter</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extracts chapters from an MKV file using mkvextract to an OGM chapter file.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            mux_mkv (y5gfunc.expr.test_atan2.mux_mkv)" href="#y5gfunc.expr.test_atan2.mux_mkv">mux_mkv</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Muxes video, audio, subtitle tracks, chapters, and fonts into an MKV file.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            encode_check (y5gfunc.expr.test_atan2.encode_check)" href="#y5gfunc.expr.test_atan2.encode_check">encode_check</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Perform a quality check on an encoded video using SSIM and/or CAMBI metrics.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            subset_fonts (y5gfunc.expr.test_atan2.subset_fonts)" href="#y5gfunc.expr.test_atan2.subset_fonts">subset_fonts</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Create a subset of fonts containing only the glyphs used by specified ASS files.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            extract_pgs_subtitles (y5gfunc.expr.test_atan2.extract_pgs_subtitles)" href="#y5gfunc.expr.test_atan2.extract_pgs_subtitles">extract_pgs_subtitles</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Extract all PGS (HDMV PGS) subtitle tracks from an M2TS file.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_language_by_trackid (y5gfunc.expr.test_atan2.get_language_by_trackid)" href="#y5gfunc.expr.test_atan2.get_language_by_trackid">get_language_by_trackid</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get the language code for a specific track ID within an M2TS file.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            encode_video (y5gfunc.expr.test_atan2.encode_video)" href="#y5gfunc.expr.test_atan2.encode_video">encode_video</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Encode one or multiple VapourSynth video nodes using external encoders or output directly to stdout.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            check_audio_stream_lossless (y5gfunc.expr.test_atan2.check_audio_stream_lossless)" href="#y5gfunc.expr.test_atan2.check_audio_stream_lossless">check_audio_stream_lossless</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Checks if an audio stream from ffprobe represents a lossless format.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            ranger (y5gfunc.expr.test_atan2.ranger)" href="#y5gfunc.expr.test_atan2.ranger">ranger</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates a sequence of numbers similar to range(), but allows floats.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            PickFrames (y5gfunc.expr.test_atan2.PickFrames)" href="#y5gfunc.expr.test_atan2.PickFrames">PickFrames</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Return a new clip with frames picked from input clip from the indices array.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            calc_atan2_expr (y5gfunc.expr.test_atan2.calc_atan2_expr)" href="#y5gfunc.expr.test_atan2.calc_atan2_expr">calc_atan2_expr</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_pixel_value (y5gfunc.expr.test_atan2.get_pixel_value)" href="#y5gfunc.expr.test_atan2.get_pixel_value">get_pixel_value</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            test_atan2 (y5gfunc.expr.test_atan2.test_atan2)" href="#y5gfunc.expr.test_atan2.test_atan2">test_atan2</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            math_functions


  
      module-attribute
   (y5gfunc.expr.test_atan2.math_functions)" href="#y5gfunc.expr.test_atan2.math_functions">math_functions</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            STANDARD_OPP


  
      module-attribute
   (y5gfunc.expr.test_atan2.STANDARD_OPP)" href="#y5gfunc.expr.test_atan2.STANDARD_OPP">STANDARD_OPP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            NORMALIZED_OPP


  
      module-attribute
   (y5gfunc.expr.test_atan2.NORMALIZED_OPP)" href="#y5gfunc.expr.test_atan2.NORMALIZED_OPP">NORMALIZED_OPP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            MAWEN_OPP


  
      module-attribute
   (y5gfunc.expr.test_atan2.MAWEN_OPP)" href="#y5gfunc.expr.test_atan2.MAWEN_OPP">MAWEN_OPP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            get_peak_value_full


  
      module-attribute
   (y5gfunc.expr.test_atan2.get_peak_value_full)" href="#y5gfunc.expr.test_atan2.get_peak_value_full">get_peak_value_full</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            cfl_shader


  
      module-attribute
   (y5gfunc.expr.test_atan2.cfl_shader)" href="#y5gfunc.expr.test_atan2.cfl_shader">cfl_shader</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            KrigBilateral


  
      module-attribute
   (y5gfunc.expr.test_atan2.KrigBilateral)" href="#y5gfunc.expr.test_atan2.KrigBilateral">KrigBilateral</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            fsrcnnx_x2


  
      module-attribute
   (y5gfunc.expr.test_atan2.fsrcnnx_x2)" href="#y5gfunc.expr.test_atan2.fsrcnnx_x2">fsrcnnx_x2</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            artcnn_c4f16


  
      module-attribute
   (y5gfunc.expr.test_atan2.artcnn_c4f16)" href="#y5gfunc.expr.test_atan2.artcnn_c4f16">artcnn_c4f16</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            artcnn_c4f16_DS


  
      module-attribute
   (y5gfunc.expr.test_atan2.artcnn_c4f16_DS)" href="#y5gfunc.expr.test_atan2.artcnn_c4f16_DS">artcnn_c4f16_DS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            artcnn_c4f32


  
      module-attribute
   (y5gfunc.expr.test_atan2.artcnn_c4f32)" href="#y5gfunc.expr.test_atan2.artcnn_c4f32">artcnn_c4f32</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            artcnn_c4f32_DS


  
      module-attribute
   (y5gfunc.expr.test_atan2.artcnn_c4f32_DS)" href="#y5gfunc.expr.test_atan2.artcnn_c4f32_DS">artcnn_c4f32_DS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            output


  
      module-attribute
   (y5gfunc.expr.test_atan2.output)" href="#y5gfunc.expr.test_atan2.output">output</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            SynDeband


  
      module-attribute
   (y5gfunc.expr.test_atan2.SynDeband)" href="#y5gfunc.expr.test_atan2.SynDeband">SynDeband</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.math_functions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">math_functions</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.math_functions" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">math_functions</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">function fma(var1, var2, var3) {</span><span class="se">\n</span><span class="s1">    return var1 * var2 + var3</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function copysign(val, sign) {</span><span class="se">\n</span><span class="s1">    return (sign &lt; 0) ? -abs(val) : abs(val)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1"># https://stackoverflow.com/a/23097989</span><span class="se">\n</span><span class="s1">function atan(var) {</span><span class="se">\n</span><span class="s1">    zz = abs(var)</span><span class="se">\n</span><span class="s1">    aa = (zz &gt; 1) ? (1 / zz) : zz</span><span class="se">\n</span><span class="s1">    ss = aa ** 2</span><span class="se">\n</span><span class="s1">    qq = ss ** 2</span><span class="se">\n</span><span class="s1">    pp =             -2.0258553044340116e-5</span><span class="se">\n</span><span class="s1">    tt =              2.2302240345710764e-4</span><span class="se">\n</span><span class="s1">    pp = fma(pp, qq, -1.1640717779912220e-3)</span><span class="se">\n</span><span class="s1">    tt = fma(tt, qq,  3.8559749383656407e-3)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, qq, -9.1845592187222193e-3)</span><span class="se">\n</span><span class="s1">    tt = fma(tt, qq,  1.6978035834594660e-2)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, qq, -2.5826796814492296e-2)</span><span class="se">\n</span><span class="s1">    tt = fma(tt, qq,  3.4067811082715810e-2)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, qq, -4.0926382420509999e-2)</span><span class="se">\n</span><span class="s1">    tt = fma(tt, qq,  4.6739496199158334e-2)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, qq, -5.2392330054601366e-2)</span><span class="se">\n</span><span class="s1">    tt = fma(tt, qq,  5.8773077721790683e-2)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, qq, -6.6658603633512892e-2)</span><span class="se">\n</span><span class="s1">    tt = fma(tt, qq,  7.6922129305867892e-2)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, ss,                     tt)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, ss, -9.0909012354005267e-2)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, ss,  1.1111110678749421e-1)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, ss, -1.4285714271334810e-1)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, ss,  1.9999999999755005e-1)</span><span class="se">\n</span><span class="s1">    pp = fma(pp, ss, -3.3333333333331838e-1)</span><span class="se">\n</span><span class="s1">    pp = fma(pp * ss, aa, aa)</span><span class="se">\n</span><span class="s1">    rr = (zz &gt; 1) ? fma(0.93282184640716537, 1.6839188885261840, -pp): pp</span><span class="se">\n</span><span class="s1">    return copysign(rr, var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function atan2(var_y, var_x) {</span><span class="se">\n</span><span class="s1">    theta = 0</span><span class="se">\n</span><span class="s1">    theta = (var_x &gt; 0) ? atan(var_y / var_x) : theta</span><span class="se">\n</span><span class="s1">    theta = (var_x &lt; 0) ? (atan(var_y / var_x) + copysign($pi, var_y)) : theta</span><span class="se">\n</span><span class="s1">    theta = ((var_x == 0) &amp;&amp; var_y) ? (copysign($pi / 2, var_y)) : theta</span><span class="se">\n</span><span class="s1">    theta = ((var_x == 0) &amp;&amp; (var_y == 0)) ? 0 : theta</span><span class="se">\n</span><span class="s1">    theta = (var_x == 0) ? copysign($pi / 2, var_y) : theta</span><span class="se">\n</span><span class="s1">    return theta</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function cot(var) {</span><span class="se">\n</span><span class="s1">    return cos(var) / sin(var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function sec(var) {</span><span class="se">\n</span><span class="s1">    return 1 / cos(var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function csc(var) {</span><span class="se">\n</span><span class="s1">    return 1 / sin(var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function asin(var) {</span><span class="se">\n</span><span class="s1">    return 2 * atan(var / (1 + sqrt(1 - var ** 2)))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function acos(var) {</span><span class="se">\n</span><span class="s1">    return 2 * atan(sqrt((1 - var) / (1 + var)))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function acot(var) {</span><span class="se">\n</span><span class="s1">    return $pi / 2 - atan(var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function sinh(var) {</span><span class="se">\n</span><span class="s1">    return (exp(var) - exp(-var)) / 2</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function cosh(var) {</span><span class="se">\n</span><span class="s1">    return (exp(var) + exp(-var)) / 2</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function tanh(var) {</span><span class="se">\n</span><span class="s1">    return (exp(2 * var) - 1) / (exp(2 * var) + 1)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function coth(var) {</span><span class="se">\n</span><span class="s1">    return (exp(2 * var) + 1) / (exp(2 * var) - 1)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function sech(var) {</span><span class="se">\n</span><span class="s1">    return 1 / cosh(var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function csch(var) {</span><span class="se">\n</span><span class="s1">    return 1 / sinh(var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function arsinh(var) {</span><span class="se">\n</span><span class="s1">    return log(var + sqrt(var ** 2 + 1))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function arcosh(var) {</span><span class="se">\n</span><span class="s1">    return log(var + sqrt(var ** 2 - 1))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function artanh(var) {</span><span class="se">\n</span><span class="s1">    return 0.5 * log((1 + var) / (1 - var))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function arcoth(var) {</span><span class="se">\n</span><span class="s1">    return 0.5 * log((var + 1) / (var - 1))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function arsech(var) {</span><span class="se">\n</span><span class="s1">    return log((1 + sqrt(1 - var ** 2)) / var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function arcsch(var) {</span><span class="se">\n</span><span class="s1">    return log(1 / var + sqrt(1 / (var ** 2) + 1))</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1"># https://stackoverflow.com/a/77465269</span><span class="se">\n</span><span class="s1">function cbrt(var) {</span><span class="se">\n</span><span class="s1">    abs_var = abs(var)</span><span class="se">\n</span><span class="s1">    est = abs_var ? exp(log(abs_var) / 3) : var</span><span class="se">\n</span><span class="s1">    est = copysign(est, var)</span><span class="se">\n</span><span class="s1">    cube = est ** 3 </span><span class="se">\n</span><span class="s1">    return abs_var? fma(-est, ((cube - var) / (2 * cube + var)), est) : var</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1"># https://github.com/kravietz/nist-sts/blob/master/erf.c</span><span class="se">\n</span><span class="s1">function erf(var) {</span><span class="se">\n</span><span class="s1">    abs_var = abs(var)</span><span class="se">\n</span><span class="s1">    tt = 1 / (1 + 0.3275911 * abs_var)</span><span class="se">\n</span><span class="s1">    yy = 1 - (((((1.061405429 * tt + -1.453152027) * tt) + 1.421413741) * tt + -0.284496736) * tt + 0.254829592) * tt * exp(-abs_var * abs_var)</span><span class="se">\n</span><span class="s1">    return copysign(yy, var)</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1"># https://github.com/kravietz/nist-sts/blob/master/erf.c</span><span class="se">\n</span><span class="s1">function erfc(var) {</span><span class="se">\n\t</span><span class="s1">zz = abs(var)</span><span class="se">\n\t</span><span class="s1">tt = 1 / (1 + 0.5 * zz)</span><span class="se">\n\t</span><span class="s1">ans = tt * exp(-zz * zz - 1.26551223 + tt * (1.00002368 + tt * (0.37409196 + tt * (0.09678418 + tt * (-0.18628806 + tt * (0.27886807 + tt * (-1.13520398 + tt * (1.48851587 + tt * (-0.82215223 + tt * 0.17087277)))))))))</span><span class="se">\n\t</span><span class="s1">return var &gt;= 0 ? ans : 2 - ans</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function gamma_sign(var_z) {</span><span class="se">\n</span><span class="s1">    is_pole = (var_z &lt;= 0) &amp;&amp; (floor(var_z) == var_z)</span><span class="se">\n</span><span class="s1">    use_reflection = (var_z &lt; 0.5) &amp;&amp; !is_pole</span><span class="se">\n</span><span class="s1">    sign_direct = 1</span><span class="se">\n</span><span class="s1">    sin_pi_var_z = sin($pi * var_z)</span><span class="se">\n</span><span class="s1">    sign_reflected = (sin_pi_var_z &gt;= 0) ? 1 : -1</span><span class="se">\n</span><span class="s1">    calc_sign = use_reflection ? sign_reflected : sign_direct</span><span class="se">\n</span><span class="s1">    return is_pole ? 1 : calc_sign</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function lgamma_val(var_z) {</span><span class="se">\n</span><span class="s1">    is_pole = (var_z &lt;= 0) &amp;&amp; (floor(var_z) == var_z)</span><span class="se">\n</span><span class="s1">    use_reflection = (var_z &lt; 0.5) &amp;&amp; !is_pole</span><span class="se">\n</span><span class="s1">    var_z_calc = use_reflection ? (1 - var_z) : var_z</span><span class="se">\n</span><span class="s1">    var_z_minus_1 = var_z_calc - 1</span><span class="se">\n</span><span class="s1">    tmp = var_z_minus_1 + 7 + 0.5</span><span class="se">\n</span><span class="s1">    series = 0.99999999999980993227684700473478</span><span class="se">\n</span><span class="s1">    series = series + 676.52036812188509856700919044401 / (var_z_minus_1 + 1)</span><span class="se">\n</span><span class="s1">    series = series + -1259.1392167224028704715607875528 / (var_z_minus_1 + 2)</span><span class="se">\n</span><span class="s1">    series = series + 771.32342877765307884893049653757 / (var_z_minus_1 + 3)</span><span class="se">\n</span><span class="s1">    series = series + -176.61502916214059906584551354002 / (var_z_minus_1 + 4)</span><span class="se">\n</span><span class="s1">    series = series + 12.507343278686904814458936853287 / (var_z_minus_1 + 5)</span><span class="se">\n</span><span class="s1">    series = series + -0.13857109526572011689554707118956 / (var_z_minus_1 + 6)</span><span class="se">\n</span><span class="s1">    series = series + 9.9843695780195708595638234185252e-6 / (var_z_minus_1 + 7)</span><span class="se">\n</span><span class="s1">    series = series + 1.5056327351493115583497230996790e-7 / (var_z_minus_1 + 8)</span><span class="se">\n</span><span class="s1">    log_series = log(max(series, 1e9))</span><span class="se">\n</span><span class="s1">    log_gamma_core = 0.5 * log(2 * $pi) + (var_z_calc - 0.5) * log(max(tmp, 1e9)) - tmp + log_series</span><span class="se">\n</span><span class="s1">    sin_pi_var_z = sin($pi * var_z)</span><span class="se">\n</span><span class="s1">    log_abs_sin = log(max(abs(sin_pi_var_z), 1e9))</span><span class="se">\n</span><span class="s1">    reflection_adjustment = log($pi) - log_abs_sin</span><span class="se">\n</span><span class="s1">    final_log_gamma = use_reflection ? (reflection_adjustment - log_gamma_core) : log_gamma_core</span><span class="se">\n</span><span class="s1">    return is_pole ? 1e9 : final_log_gamma</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n\n</span><span class="s1">function tgamma(var_z) {</span><span class="se">\n</span><span class="s1">    sign = gamma_sign(var_z)</span><span class="se">\n</span><span class="s1">    lgamma_val = lgamma_val(var_z)</span><span class="se">\n</span><span class="s1">    is_inf = (lgamma_val &gt;= 1e9)</span><span class="se">\n</span><span class="s1">    abs_gamma = exp(lgamma_val)</span><span class="se">\n</span><span class="s1">    signed_gamma = sign * abs_gamma</span><span class="se">\n</span><span class="s1">    return is_inf ? (sign * 1e9) : signed_gamma</span><span class="se">\n</span><span class="s1">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.STANDARD_OPP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">STANDARD_OPP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.STANDARD_OPP" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">STANDARD_OPP</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            register_opp_matrix (y5gfunc.filter.resample.register_opp_matrix)" href="../filter/resample.html#y5gfunc.filter.resample.register_opp_matrix">register_opp_matrix</a></span><span class="p">(</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n"><span title="sympy.Matrix">Matrix</span></span><span class="p">([[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="p">[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]]))</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.NORMALIZED_OPP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">NORMALIZED_OPP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.NORMALIZED_OPP" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">NORMALIZED_OPP</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            register_opp_matrix (y5gfunc.filter.resample.register_opp_matrix)" href="../filter/resample.html#y5gfunc.filter.resample.register_opp_matrix">register_opp_matrix</a></span><span class="p">(</span><span class="s1">&#39;normalized&#39;</span><span class="p">,</span> <span class="n"><span title="sympy.Matrix">Matrix</span></span><span class="p">([[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="p">[</span><span class="n"><span title="sympy.S">S</span></span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n"><span title="sympy.sqrt">sqrt</span></span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n"><span title="sympy.S">S</span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n"><span title="sympy.sqrt">sqrt</span></span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n"><span title="sympy.S">S</span></span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n"><span title="sympy.sqrt">sqrt</span></span><span class="p">(</span><span class="mi">18</span><span class="p">),</span> <span class="n"><span title="sympy.S">S</span></span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n"><span title="sympy.sqrt">sqrt</span></span><span class="p">(</span><span class="mi">18</span><span class="p">),</span> <span class="n"><span title="sympy.S">S</span></span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n"><span title="sympy.sqrt">sqrt</span></span><span class="p">(</span><span class="mi">18</span><span class="p">)]]))</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.MAWEN_OPP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">MAWEN_OPP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.MAWEN_OPP" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">MAWEN_OPP</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            register_opp_matrix (y5gfunc.filter.resample.register_opp_matrix)" href="../filter/resample.html#y5gfunc.filter.resample.register_opp_matrix">register_opp_matrix</a></span><span class="p">(</span><span class="s1">&#39;mawen&#39;</span><span class="p">,</span> <span class="n"><span title="sympy.Matrix">Matrix</span></span><span class="p">([[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="p">[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n"><span title="sympy.Rational">Rational</span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]]))</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.get_peak_value_full" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">get_peak_value_full</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.get_peak_value_full" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">get_peak_value_full</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="functools.partial" href="https://docs.python.org/3/library/functools.html#functools.partial">partial</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-external" title="vstools.get_peak_value" href="https://sgt0.github.io/jet-docs/api/vstools/utils/scale/#vstools.utils.scale.get_peak_value">get_peak_value</a></span><span class="p">,</span> <span class="n"><span title="functools.partial(range_in)">range_in</span></span><span class="o">=</span><span class="n"><span title="vstools.ColorRange.FULL">FULL</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.cfl_shader" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">cfl_shader</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.cfl_shader" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cfl_shader</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="url (y5gfunc.shader.lazy_loader.LazyVariable(url))" href="#y5gfunc.expr.test_atan2.LazyVariable(url)">url</a></span><span class="o">=</span><span class="s1">&#39;https://raw.githubusercontent.com/Artoriuz/glsl-chroma-from-luma-prediction/refs/heads/main/CfL_Prediction.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.KrigBilateral" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">KrigBilateral</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.KrigBilateral" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">KrigBilateral</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="url (y5gfunc.shader.lazy_loader.LazyVariable(url))" href="#y5gfunc.expr.test_atan2.LazyVariable(url)">url</a></span><span class="o">=</span><span class="s1">&#39;https://raw.githubusercontent.com/awused/dotfiles/refs/heads/master/mpv/.config/mpv/shaders/KrigBilateral.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.fsrcnnx_x2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">fsrcnnx_x2</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.fsrcnnx_x2" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">fsrcnnx_x2</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/awused/dotfiles/refs/heads/master/mpv/.config/mpv/shaders/fsrcnnx/FSRCNNX_x2_16-0-4-1.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.artcnn_c4f16" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">artcnn_c4f16</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.artcnn_c4f16" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">artcnn_c4f16</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/Artoriuz/ArtCNN/refs/heads/main/GLSL/ArtCNN_C4F16.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.artcnn_c4f16_DS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">artcnn_c4f16_DS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.artcnn_c4f16_DS" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">artcnn_c4f16_DS</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/Artoriuz/ArtCNN/refs/heads/main/GLSL/ArtCNN_C4F16_DS.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.artcnn_c4f32" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">artcnn_c4f32</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.artcnn_c4f32" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">artcnn_c4f32</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/Artoriuz/ArtCNN/refs/heads/main/GLSL/ArtCNN_C4F32.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.artcnn_c4f32_DS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">artcnn_c4f32_DS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.artcnn_c4f32_DS" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">artcnn_c4f32_DS</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            LazyVariable (y5gfunc.shader.lazy_loader.LazyVariable)" href="#y5gfunc.expr.test_atan2.LazyVariable">LazyVariable</a></span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/Artoriuz/ArtCNN/refs/heads/main/GLSL/ArtCNN_C4F32_DS.glsl&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.output" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">output</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.output" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">output</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            set_preview (y5gfunc.preview.set_preview)" href="#y5gfunc.expr.test_atan2.set_preview">set_preview</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="y5gfunc.expr.test_atan2.SynDeband" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">SynDeband</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.SynDeband" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">SynDeband</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            sakiko_deband (y5gfunc.filter.sakiko_deband)" href="#y5gfunc.expr.test_atan2.sakiko_deband">sakiko_deband</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.OptimizeLevel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">OptimizeLevel</span>


<a href="#y5gfunc.expr.test_atan2.OptimizeLevel" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Optimization level.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            O0


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.OptimizeLevel.O0)" href="#y5gfunc.expr.test_atan2.OptimizeLevel.O0">O0</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No optimization.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            O1


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.OptimizeLevel.O1)" href="#y5gfunc.expr.test_atan2.OptimizeLevel.O1">O1</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Basic constant folding that preserves all variables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            O2


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.OptimizeLevel.O2)" href="#y5gfunc.expr.test_atan2.OptimizeLevel.O2">O2</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Slightly more aggressive optimization that may remove some variables.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            O3


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.OptimizeLevel.O3)" href="#y5gfunc.expr.test_atan2.OptimizeLevel.O3">O3</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Aggressive optimization that sacrifices readability for performance.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            OFast


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.OptimizeLevel.OFast)" href="#y5gfunc.expr.test_atan2.OptimizeLevel.OFast">OFast</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Most aggressive optimization that may slightly change the result. (Generally more accurate though)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.OptimizeLevel.O0" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">O0</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.OptimizeLevel.O0" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">O0</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.OptimizeLevel.O1" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">O1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.OptimizeLevel.O1" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">O1</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.OptimizeLevel.O2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">O2</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.OptimizeLevel.O2" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">O2</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.OptimizeLevel.O3" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">O3</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.OptimizeLevel.O3" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">O3</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.OptimizeLevel.OFast" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">OFast</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.OptimizeLevel.OFast" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">OFast</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ConstantValues" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ConstantValues</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ConstantValues</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.ConstantValues(pi)">pi</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="math.pi" href="https://docs.python.org/3/library/math.html#math.pi">pi</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.ConstantValues(N)">N</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.ConstantValues(X)">X</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.ConstantValues(Y)">Y</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.ConstantValues(width)">width</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.ConstantValues(height)">height</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">













<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            pi


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ConstantValues.pi)" href="#y5gfunc.expr.test_atan2.ConstantValues.pi">pi</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            N


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ConstantValues.N)" href="#y5gfunc.expr.test_atan2.ConstantValues.N">N</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            X


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ConstantValues.X)" href="#y5gfunc.expr.test_atan2.ConstantValues.X">X</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            Y


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ConstantValues.Y)" href="#y5gfunc.expr.test_atan2.ConstantValues.Y">Y</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            width


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ConstantValues.width)" href="#y5gfunc.expr.test_atan2.ConstantValues.width">width</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            height


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ConstantValues.height)" href="#y5gfunc.expr.test_atan2.ConstantValues.height">height</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ConstantValues.pi" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">pi</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues.pi" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">pi</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="math.pi" href="https://docs.python.org/3/library/math.html#math.pi">pi</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ConstantValues.N" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">N</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues.N" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">N</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ConstantValues.X" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">X</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues.X" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">X</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ConstantValues.Y" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">Y</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues.Y" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Y</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ConstantValues.width" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">width</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues.width" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">width</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ConstantValues.height" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">height</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ConstantValues.height" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">height</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.BM3DPreset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BM3DPreset</span>


<a href="#y5gfunc.expr.test_atan2.BM3DPreset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.StrEnum" href="https://docs.python.org/3/library/enum.html#enum.StrEnum">StrEnum</a></code></p>


        <p>BM3D speed vs quality presets. <code>MAGIC</code> is better classified as tune but whatever.</p>
<p>modified from <a href="https://github.com/HomeOfVapourSynthEvolution/VapourSynth-BM3D?tab=readme-ov-file#profile-default">https://github.com/HomeOfVapourSynthEvolution/VapourSynth-BM3D?tab=readme-ov-file#profile-default</a>
preset 'magic' is from rksfunc</p>












<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            FAST


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BM3DPreset.FAST)" href="#y5gfunc.expr.test_atan2.BM3DPreset.FAST">FAST</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LC


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BM3DPreset.LC)" href="#y5gfunc.expr.test_atan2.BM3DPreset.LC">LC</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            NP


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BM3DPreset.NP)" href="#y5gfunc.expr.test_atan2.BM3DPreset.NP">NP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HIGH


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BM3DPreset.HIGH)" href="#y5gfunc.expr.test_atan2.BM3DPreset.HIGH">HIGH</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            MAGIC


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BM3DPreset.MAGIC)" href="#y5gfunc.expr.test_atan2.BM3DPreset.MAGIC">MAGIC</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BM3DPreset.FAST" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">FAST</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BM3DPreset.FAST" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">FAST</span> <span class="o">=</span> <span class="s1">&#39;fast&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BM3DPreset.LC" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">LC</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BM3DPreset.LC" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">LC</span> <span class="o">=</span> <span class="s1">&#39;lc&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BM3DPreset.NP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">NP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BM3DPreset.NP" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">NP</span> <span class="o">=</span> <span class="s1">&#39;np&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BM3DPreset.HIGH" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HIGH</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BM3DPreset.HIGH" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HIGH</span> <span class="o">=</span> <span class="s1">&#39;high&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BM3DPreset.MAGIC" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">MAGIC</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BM3DPreset.MAGIC" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">MAGIC</span> <span class="o">=</span> <span class="s1">&#39;magic&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.DescaleMode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DescaleMode</span>


<a href="#y5gfunc.expr.test_atan2.DescaleMode" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.StrEnum" href="https://docs.python.org/3/library/enum.html#enum.StrEnum">StrEnum</a></code></p>













<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            W


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.DescaleMode.W)" href="#y5gfunc.expr.test_atan2.DescaleMode.W">W</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            H


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.DescaleMode.H)" href="#y5gfunc.expr.test_atan2.DescaleMode.H">H</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            WH


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.DescaleMode.WH)" href="#y5gfunc.expr.test_atan2.DescaleMode.WH">WH</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HW


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.DescaleMode.HW)" href="#y5gfunc.expr.test_atan2.DescaleMode.HW">HW</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.DescaleMode.W" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">W</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.DescaleMode.W" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">W</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.DescaleMode.H" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">H</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.DescaleMode.H" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">H</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.DescaleMode.WH" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">WH</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.DescaleMode.WH" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">WH</span> <span class="o">=</span> <span class="s1">&#39;wh&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.DescaleMode.HW" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HW</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.DescaleMode.HW" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HW</span> <span class="o">=</span> <span class="s1">&#39;hw&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ColorMatrixManager" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ColorMatrixManager</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ColorMatrixManager</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="rgb_opp_matrix (y5gfunc.expr.test_atan2.ColorMatrixManager(rgb_opp_matrix))" href="#y5gfunc.expr.test_atan2.ColorMatrixManager(rgb_opp_matrix)">rgb_opp_matrix</a></span><span class="p">:</span> <span class="n"><span title="sympy.Matrix">Matrix</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="name (y5gfunc.expr.test_atan2.ColorMatrixManager(name))" href="#y5gfunc.expr.test_atan2.ColorMatrixManager(name)">name</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Manager for a specific RGB-OPP conversion matrix and its related transformations.</p>

        <p>Initialize the ColorMatrixManager with a specific RGB to OPP matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager(rgb_opp_matrix)" class="doc doc-heading doc-heading-parameter">                  <code>rgb_opp_matrix</code>
<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager(rgb_opp_matrix)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="sympy.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 3x3 sympy.Matrix for RGB to OPP conversion</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager(name)" class="doc doc-heading doc-heading-parameter">                  <code>name</code>
<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager(name)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Identifier for this specific OPP transform variant</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            register_yuv_matrix (y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix">register_yuv_matrix</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Register a YUV to RGB matrix type.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            initialize (y5gfunc.expr.test_atan2.ColorMatrixManager.initialize)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.initialize">initialize</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Initialize all matrices and coefficients.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_yuv_to_opp_coefs (y5gfunc.expr.test_atan2.ColorMatrixManager.get_yuv_to_opp_coefs)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_yuv_to_opp_coefs">get_yuv_to_opp_coefs</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get YUV to OPP conversion coefficients for a specific matrix type.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_opp_to_yuv_coefs (y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_yuv_coefs)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_yuv_coefs">get_opp_to_yuv_coefs</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get OPP to YUV conversion coefficients for a specific matrix type.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_rgb_to_opp_coefs (y5gfunc.expr.test_atan2.ColorMatrixManager.get_rgb_to_opp_coefs)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_rgb_to_opp_coefs">get_rgb_to_opp_coefs</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get RGB to OPP conversion coefficients.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_opp_to_rgb_coefs (y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_rgb_coefs)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_rgb_coefs">get_opp_to_rgb_coefs</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Get OPP to RGB conversion coefficients.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            name


  
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorMatrixManager.name)" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.name">name</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rgb_opp_matrix</span><span class="p">:</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Initialize the ColorMatrixManager with a specific RGB to OPP matrix.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        rgb_opp_matrix: A 3x3 sympy.Matrix for RGB to OPP conversion</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        name: Identifier for this specific OPP transform variant</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_rgb_opp_matrix</span> <span class="o">=</span> <span class="n">rgb_opp_matrix</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_rgb_from_opp_matrix</span> <span class="o">=</span> <span class="n">rgb_opp_matrix</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_rgb_matrices</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_opp_matrices</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_yuv_matrices</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_opp_coefs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_yuv_coefs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_rgb_to_opp_coefs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_rgb_coefs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.name" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.name" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">name</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="name (y5gfunc.filter.resample.ColorMatrixManager(name))" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager(name)">name</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">register_yuv_matrix</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">register_yuv_matrix</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="matrix_ids (y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(matrix_ids))" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(matrix_ids)">matrix_ids</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">]],</span> <span class="n"><a class="autorefs autorefs-internal" title="yuv_to_rgb_matrix (y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(yuv_to_rgb_matrix))" href="#y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(yuv_to_rgb_matrix)">yuv_to_rgb_matrix</a></span><span class="p">:</span> <span class="n"><span title="sympy.Matrix">Matrix</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Register a YUV to RGB matrix type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(matrix_ids)" class="doc doc-heading doc-heading-parameter">                  <code>matrix_ids</code>
<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(matrix_ids)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matrix id</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(yuv_to_rgb_matrix)" class="doc doc-heading doc-heading-parameter">                  <code>yuv_to_rgb_matrix</code>
<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.register_yuv_matrix(yuv_to_rgb_matrix)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="sympy.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A sympy 3x3 Matrix representing YUV-&gt;RGB conversion</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_yuv_matrix</span><span class="p">(</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">matrix_ids</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">]],</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">yuv_to_rgb_matrix</span><span class="p">:</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Register a YUV to RGB matrix type.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        matrix_ids: The matrix id</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        yuv_to_rgb_matrix: A sympy 3x3 Matrix representing YUV-&gt;RGB conversion</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix_ids</span><span class="p">,</span> <span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">):</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">matrix_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">matrix_ids</span><span class="p">]</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">for</span> <span class="n">matrix_id</span> <span class="ow">in</span> <span class="n">matrix_ids</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_rgb_matrices</span><span class="p">[</span><span class="n">matrix_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">yuv_to_rgb_matrix</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_recalculate_for_matrix</span><span class="p">(</span><span class="n">matrix_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.initialize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">initialize</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.initialize" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">initialize</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize all matrices and coefficients.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize all matrices and coefficients.&quot;&quot;&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">return</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="c1"># Calculate direct RGBOPP coefficients</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_rgb_to_opp_coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix_to_coefs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rgb_opp_matrix</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_rgb_coefs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matrix_to_coefs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rgb_from_opp_matrix</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="c1"># Calculate matrices and coefficients for all registered matrix types</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">for</span> <span class="n">matrix_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_rgb_matrices</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_recalculate_for_matrix</span><span class="p">(</span><span class="n">matrix_type</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.get_yuv_to_opp_coefs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_yuv_to_opp_coefs</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_yuv_to_opp_coefs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_yuv_to_opp_coefs</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.ColorMatrixManager.get_yuv_to_opp_coefs(matrix_type)">matrix_type</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get YUV to OPP conversion coefficients for a specific matrix type.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_yuv_to_opp_coefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get YUV to OPP conversion coefficients for a specific matrix type.&quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">if</span> <span class="n">matrix_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_opp_coefs</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported matrix type: </span><span class="si">{</span><span class="n">matrix_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_yuv_to_opp_coefs</span><span class="p">[</span><span class="n">matrix_type</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_yuv_coefs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_opp_to_yuv_coefs</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_yuv_coefs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_opp_to_yuv_coefs</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_yuv_coefs(matrix_type)">matrix_type</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get OPP to YUV conversion coefficients for a specific matrix type.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_opp_to_yuv_coefs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix_type</span><span class="p">:</span> <span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get OPP to YUV conversion coefficients for a specific matrix type.&quot;&quot;&quot;</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="n">matrix_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_yuv_coefs</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported matrix type: </span><span class="si">{</span><span class="n">matrix_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_yuv_coefs</span><span class="p">[</span><span class="n">matrix_type</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.get_rgb_to_opp_coefs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_rgb_to_opp_coefs</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_rgb_to_opp_coefs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_rgb_to_opp_coefs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get RGB to OPP conversion coefficients.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_rgb_to_opp_coefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get RGB to OPP conversion coefficients.&quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rgb_to_opp_coefs</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_rgb_coefs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_opp_to_rgb_coefs</span>


<a href="#y5gfunc.expr.test_atan2.ColorMatrixManager.get_opp_to_rgb_coefs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_opp_to_rgb_coefs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get OPP to RGB conversion coefficients.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_opp_to_rgb_coefs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get OPP to RGB conversion coefficients.&quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_opp_to_rgb_coefs</span>  <span class="c1"># type: ignore</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ColorSpace" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ColorSpace</span>


<a href="#y5gfunc.expr.test_atan2.ColorSpace" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Color spaces used in tonemapping operations.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            SDR


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorSpace.SDR)" href="#y5gfunc.expr.test_atan2.ColorSpace.SDR">SDR</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard Dynamic Range</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HDR10


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorSpace.HDR10)" href="#y5gfunc.expr.test_atan2.ColorSpace.HDR10">HDR10</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>High Dynamic Range (HDR10)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HLG


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorSpace.HLG)" href="#y5gfunc.expr.test_atan2.ColorSpace.HLG">HLG</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hybrid Log-Gamma</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DOLBY_VISION


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorSpace.DOLBY_VISION)" href="#y5gfunc.expr.test_atan2.ColorSpace.DOLBY_VISION">DOLBY_VISION</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dolby Vision</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorSpace.SDR" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">SDR</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorSpace.SDR" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">SDR</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorSpace.HDR10" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HDR10</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorSpace.HDR10" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HDR10</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorSpace.HLG" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HLG</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorSpace.HLG" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HLG</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorSpace.DOLBY_VISION" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">DOLBY_VISION</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorSpace.DOLBY_VISION" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DOLBY_VISION</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ColorPrimaries" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ColorPrimaries</span>


<a href="#y5gfunc.expr.test_atan2.ColorPrimaries" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Color primaries standards.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            UNKNOWN


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.UNKNOWN)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.UNKNOWN">UNKNOWN</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unknown primaries</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT601_525


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.BT601_525)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT601_525">BT601_525</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ITU-R Rec. BT.601 (525-line = NTSC, SMPTE-C)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT601_625


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.BT601_625)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT601_625">BT601_625</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ITU-R Rec. BT.601 (625-line = PAL, SECAM)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT709


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.BT709)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT709">BT709</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ITU-R Rec. BT.709 (HD), also sRGB</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT470M


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.BT470M)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT470M">BT470M</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ITU-R Rec. BT.470 M</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            EBU_TECH_3213E


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.EBU_TECH_3213E)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.EBU_TECH_3213E">EBU_TECH_3213E</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EBU Tech. 3213-E / JEDEC P22 phosphors</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT2020


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.BT2020)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT2020">BT2020</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ITU-R Rec. BT.2020 (UltraHD)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            APPLE_RGB


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.APPLE_RGB)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.APPLE_RGB">APPLE_RGB</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Apple RGB</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ADOBE_RGB


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.ADOBE_RGB)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.ADOBE_RGB">ADOBE_RGB</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Adobe RGB (1998)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            PROPHOTO_RGB


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.PROPHOTO_RGB)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.PROPHOTO_RGB">PROPHOTO_RGB</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ProPhoto RGB (ROMM)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            CIE1931_RGB


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.CIE1931_RGB)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.CIE1931_RGB">CIE1931_RGB</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CIE 1931 RGB primaries</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DCI_P3


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3">DCI_P3</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DCI-P3 (Digital Cinema)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DCI_P3_D65


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3_D65)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3_D65">DCI_P3_D65</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DCI-P3 (Digital Cinema) with D65 white point</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            V_GAMUT


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.V_GAMUT)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.V_GAMUT">V_GAMUT</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Panasonic V-Gamut (VARICAM)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            S_GAMUT


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.S_GAMUT)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.S_GAMUT">S_GAMUT</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sony S-Gamut</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            FILM_C


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.FILM_C)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.FILM_C">FILM_C</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Traditional film primaries with Illuminant C</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ACES0


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.ACES0)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.ACES0">ACES0</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ACES Primaries #0 (ultra wide)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ACES1


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ColorPrimaries.ACES1)" href="#y5gfunc.expr.test_atan2.ColorPrimaries.ACES1">ACES1</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ACES Primaries #1</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.UNKNOWN" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">UNKNOWN</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.UNKNOWN" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">UNKNOWN</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.BT601_525" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT601_525</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT601_525" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT601_525</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.BT601_625" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT601_625</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT601_625" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT601_625</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.BT709" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT709</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT709" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT709</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.BT470M" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT470M</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT470M" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT470M</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.EBU_TECH_3213E" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">EBU_TECH_3213E</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.EBU_TECH_3213E" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">EBU_TECH_3213E</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.BT2020" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT2020</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.BT2020" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT2020</span> <span class="o">=</span> <span class="mi">6</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.APPLE_RGB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">APPLE_RGB</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.APPLE_RGB" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">APPLE_RGB</span> <span class="o">=</span> <span class="mi">7</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.ADOBE_RGB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ADOBE_RGB</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.ADOBE_RGB" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ADOBE_RGB</span> <span class="o">=</span> <span class="mi">8</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.PROPHOTO_RGB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">PROPHOTO_RGB</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.PROPHOTO_RGB" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">PROPHOTO_RGB</span> <span class="o">=</span> <span class="mi">9</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.CIE1931_RGB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">CIE1931_RGB</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.CIE1931_RGB" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">CIE1931_RGB</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">DCI_P3</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DCI_P3</span> <span class="o">=</span> <span class="mi">11</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3_D65" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">DCI_P3_D65</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.DCI_P3_D65" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DCI_P3_D65</span> <span class="o">=</span> <span class="mi">12</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.V_GAMUT" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">V_GAMUT</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.V_GAMUT" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">V_GAMUT</span> <span class="o">=</span> <span class="mi">13</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.S_GAMUT" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">S_GAMUT</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.S_GAMUT" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">S_GAMUT</span> <span class="o">=</span> <span class="mi">14</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.FILM_C" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">FILM_C</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.FILM_C" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">FILM_C</span> <span class="o">=</span> <span class="mi">15</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.ACES0" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ACES0</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.ACES0" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ACES0</span> <span class="o">=</span> <span class="mi">16</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ColorPrimaries.ACES1" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ACES1</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ColorPrimaries.ACES1" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ACES1</span> <span class="o">=</span> <span class="mi">17</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.GamutMapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">GamutMapping</span>


<a href="#y5gfunc.expr.test_atan2.GamutMapping" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Gamut mapping functions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            CLIP


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.CLIP)" href="#y5gfunc.expr.test_atan2.GamutMapping.CLIP">CLIP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs no gamut-mapping, just hard clips out-of-range colors per-channel</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            PERCEPTUAL


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.PERCEPTUAL)" href="#y5gfunc.expr.test_atan2.GamutMapping.PERCEPTUAL">PERCEPTUAL</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs a perceptually balanced (saturation) gamut mapping with a soft knee function</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            SOFTCLIP


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.SOFTCLIP)" href="#y5gfunc.expr.test_atan2.GamutMapping.SOFTCLIP">SOFTCLIP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs perceptually balanced gamut mapping using a soft knee function and hue shifting</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            RELATIVE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.RELATIVE)" href="#y5gfunc.expr.test_atan2.GamutMapping.RELATIVE">RELATIVE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs relative colorimetric clipping, maintaining exponential brightness/chromaticity relationship</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            SATURATION


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.SATURATION)" href="#y5gfunc.expr.test_atan2.GamutMapping.SATURATION">SATURATION</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs simple RGB-&gt;RGB saturation mapping; never clips but may distort hues</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ABSOLUTE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.ABSOLUTE)" href="#y5gfunc.expr.test_atan2.GamutMapping.ABSOLUTE">ABSOLUTE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs absolute colorimetric clipping without adapting white point</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DESATURATE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.DESATURATE)" href="#y5gfunc.expr.test_atan2.GamutMapping.DESATURATE">DESATURATE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs constant-luminance colorimetric clipping, desaturating colors towards white</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DARKEN


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.DARKEN)" href="#y5gfunc.expr.test_atan2.GamutMapping.DARKEN">DARKEN</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Uniformly darkens the input to prevent highlight clipping, then clamps colorimetrically</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HIGHLIGHT


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.HIGHLIGHT)" href="#y5gfunc.expr.test_atan2.GamutMapping.HIGHLIGHT">HIGHLIGHT</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Performs no gamut mapping, but highlights out-of-gamut pixels</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LINEAR


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.GamutMapping.LINEAR)" href="#y5gfunc.expr.test_atan2.GamutMapping.LINEAR">LINEAR</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Linearly/uniformly desaturates the image to bring it into the target gamut</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.CLIP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">CLIP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.CLIP" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">CLIP</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.PERCEPTUAL" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">PERCEPTUAL</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.PERCEPTUAL" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">PERCEPTUAL</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.SOFTCLIP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">SOFTCLIP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.SOFTCLIP" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">SOFTCLIP</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.RELATIVE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">RELATIVE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.RELATIVE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">RELATIVE</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.SATURATION" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">SATURATION</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.SATURATION" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">SATURATION</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.ABSOLUTE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ABSOLUTE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.ABSOLUTE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ABSOLUTE</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.DESATURATE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">DESATURATE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.DESATURATE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DESATURATE</span> <span class="o">=</span> <span class="mi">6</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.DARKEN" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">DARKEN</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.DARKEN" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DARKEN</span> <span class="o">=</span> <span class="mi">7</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.HIGHLIGHT" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HIGHLIGHT</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.HIGHLIGHT" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HIGHLIGHT</span> <span class="o">=</span> <span class="mi">8</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.GamutMapping.LINEAR" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">LINEAR</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.GamutMapping.LINEAR" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">LINEAR</span> <span class="o">=</span> <span class="mi">9</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ToneMappingFunction" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ToneMappingFunction</span>


<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Tone mapping functions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            CLIP


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.CLIP)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.CLIP">CLIP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No tone-mapping, just clips out-of-range colors</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            SPLINE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.SPLINE)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.SPLINE">SPLINE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simple spline consisting of two polynomials joined by a pivot point</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ST2094_40


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_40)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_40">ST2094_40</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EETF from SMPTE ST 2094-40 Annex B, using Bezier curves</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ST2094_10


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_10)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_10">ST2094_10</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EETF from SMPTE ST 2094-10 Annex B.2</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT2390


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.BT2390)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.BT2390">BT2390</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EETF from ITU-R Report BT.2390, a hermite spline roll-off with linear segment</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BT2446A


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.BT2446A)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.BT2446A">BT2446A</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>EETF from ITU-R Report BT.2446, method A</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            REINHARD


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.REINHARD)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.REINHARD">REINHARD</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simple non-linear curve named after Erik Reinhard</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            MOBIUS


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.MOBIUS)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.MOBIUS">MOBIUS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generalization of reinhard algorithm (legacy/low-quality)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HABLE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.HABLE)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.HABLE">HABLE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Piece-wise, filmic tone-mapping algorithm by John Hable (legacy/low-quality)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            GAMMA


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.GAMMA)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.GAMMA">GAMMA</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fits a gamma (power) function between source and target (legacy/low-quality)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LINEAR


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.LINEAR)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.LINEAR">LINEAR</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Linearly stretches input range to output range in PQ space</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LINEARLIGHT


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ToneMappingFunction.LINEARLIGHT)" href="#y5gfunc.expr.test_atan2.ToneMappingFunction.LINEARLIGHT">LINEARLIGHT</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Like LINEAR but in linear light instead of PQ</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.CLIP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">CLIP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.CLIP" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">CLIP</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.SPLINE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">SPLINE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.SPLINE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">SPLINE</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_40" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ST2094_40</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_40" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ST2094_40</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_10" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ST2094_10</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.ST2094_10" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ST2094_10</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.BT2390" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT2390</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.BT2390" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT2390</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.BT2446A" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BT2446A</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.BT2446A" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BT2446A</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.REINHARD" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">REINHARD</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.REINHARD" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">REINHARD</span> <span class="o">=</span> <span class="mi">6</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.MOBIUS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">MOBIUS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.MOBIUS" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">MOBIUS</span> <span class="o">=</span> <span class="mi">7</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.HABLE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HABLE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.HABLE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HABLE</span> <span class="o">=</span> <span class="mi">8</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.GAMMA" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">GAMMA</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.GAMMA" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">GAMMA</span> <span class="o">=</span> <span class="mi">9</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.LINEAR" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">LINEAR</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.LINEAR" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">LINEAR</span> <span class="o">=</span> <span class="mi">10</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ToneMappingFunction.LINEARLIGHT" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">LINEARLIGHT</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ToneMappingFunction.LINEARLIGHT" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">LINEARLIGHT</span> <span class="o">=</span> <span class="mi">11</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.Metadata" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Metadata</span>


<a href="#y5gfunc.expr.test_atan2.Metadata" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Metadata sources for tone-mapping.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            AUTO


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.Metadata.AUTO)" href="#y5gfunc.expr.test_atan2.Metadata.AUTO">AUTO</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Automatic selection based on available metadata</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            NONE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.Metadata.NONE)" href="#y5gfunc.expr.test_atan2.Metadata.NONE">NONE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No metadata (disabled)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HDR10


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.Metadata.HDR10)" href="#y5gfunc.expr.test_atan2.Metadata.HDR10">HDR10</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>HDR10 static metadata</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            HDR10_PLUS


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.Metadata.HDR10_PLUS)" href="#y5gfunc.expr.test_atan2.Metadata.HDR10_PLUS">HDR10_PLUS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>HDR10+ (MaxRGB) dynamic metadata</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LUMINANCE


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.Metadata.LUMINANCE)" href="#y5gfunc.expr.test_atan2.Metadata.LUMINANCE">LUMINANCE</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Luminance (CIE Y) derived metadata</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.Metadata.AUTO" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">AUTO</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.Metadata.AUTO" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">AUTO</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.Metadata.NONE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">NONE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.Metadata.NONE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">NONE</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.Metadata.HDR10" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HDR10</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.Metadata.HDR10" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HDR10</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.Metadata.HDR10_PLUS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">HDR10_PLUS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.Metadata.HDR10_PLUS" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">HDR10_PLUS</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.Metadata.LUMINANCE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">LUMINANCE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.Metadata.LUMINANCE" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">LUMINANCE</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ZoomMode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ZoomMode</span>


<a href="#y5gfunc.expr.test_atan2.ZoomMode" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Controls the zoom behavior of <code>rotate_image</code> function</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            NO_ZOOM


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ZoomMode.NO_ZOOM)" href="#y5gfunc.expr.test_atan2.ZoomMode.NO_ZOOM">NO_ZOOM</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rotate the clip without any scaling; missing border pixels will be interpolated</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ZOOM_TO_FIT


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ZoomMode.ZOOM_TO_FIT)" href="#y5gfunc.expr.test_atan2.ZoomMode.ZOOM_TO_FIT">ZOOM_TO_FIT</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dynamically scale the clip to ensure the entire image fits within the frame, thus avoids additional interpolation on the borders</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            CONSTANT_MAX_ZOOM


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ZoomMode.CONSTANT_MAX_ZOOM)" href="#y5gfunc.expr.test_atan2.ZoomMode.CONSTANT_MAX_ZOOM">CONSTANT_MAX_ZOOM</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use a constant scaling factor based on a 45 rotation to prevent dynamic changes during rotation</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ZoomMode.NO_ZOOM" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">NO_ZOOM</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ZoomMode.NO_ZOOM" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">NO_ZOOM</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ZoomMode.ZOOM_TO_FIT" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ZOOM_TO_FIT</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ZoomMode.ZOOM_TO_FIT" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ZOOM_TO_FIT</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ZoomMode.CONSTANT_MAX_ZOOM" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">CONSTANT_MAX_ZOOM</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ZoomMode.CONSTANT_MAX_ZOOM" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">CONSTANT_MAX_ZOOM</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.BoundaryMode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BoundaryMode</span>


<a href="#y5gfunc.expr.test_atan2.BoundaryMode" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.IntEnum" href="https://docs.python.org/3/library/enum.html#enum.IntEnum">IntEnum</a></code></p>


        <p>Controls how boundary pixels are handled in <code>rotate_image</code> function.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            CLAMPED


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BoundaryMode.CLAMPED)" href="#y5gfunc.expr.test_atan2.BoundaryMode.CLAMPED">CLAMPED</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Edge pixels are extended beyond the boundary.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            MIRRORED


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.BoundaryMode.MIRRORED)" href="#y5gfunc.expr.test_atan2.BoundaryMode.MIRRORED">MIRRORED</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The image is mirrored at the boundaries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BoundaryMode.CLAMPED" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">CLAMPED</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BoundaryMode.CLAMPED" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">CLAMPED</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.BoundaryMode.MIRRORED" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">MIRRORED</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.BoundaryMode.MIRRORED" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">MIRRORED</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.WobblySource" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">WobblySource</span>


<a href="#y5gfunc.expr.test_atan2.WobblySource" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">WobblySource</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="wob_project_path (y5gfunc.expr.test_atan2.WobblySource(wob_project_path))" href="#y5gfunc.expr.test_atan2.WobblySource(wob_project_path)">wob_project_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            PathLike


  
      module-attribute
   (y5gfunc.source.wobbly.types.PathLike)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.PathLike">PathLike</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="timecode_output_path (y5gfunc.expr.test_atan2.WobblySource(timecode_output_path))" href="#y5gfunc.expr.test_atan2.WobblySource(timecode_output_path)">timecode_output_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            PathLike


  
      module-attribute
   (y5gfunc.source.wobbly.types.PathLike)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.PathLike">PathLike</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="timecode_version (y5gfunc.expr.test_atan2.WobblySource(timecode_version))" href="#y5gfunc.expr.test_atan2.WobblySource(timecode_version)">timecode_version</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            V2


  
      class-attribute
      instance-attribute
   (y5gfunc.source.wobbly.types.TimecodeVersion.V2)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.TimecodeVersion.V2">V2</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Wobbly source processing class</p>

        <p>Initialize Wobbly source processor</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.WobblySource(wob_project_path)" class="doc doc-heading doc-heading-parameter">                  <code>wob_project_path</code>
<a href="#y5gfunc.expr.test_atan2.WobblySource(wob_project_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            PathLike


  
      module-attribute
   (y5gfunc.source.wobbly.types.PathLike)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.PathLike">PathLike</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to Wobbly project file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.WobblySource(timecode_output_path)" class="doc doc-heading doc-heading-parameter">                  <code>timecode_output_path</code>
<a href="#y5gfunc.expr.test_atan2.WobblySource(timecode_output_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            PathLike


  
      module-attribute
   (y5gfunc.source.wobbly.types.PathLike)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.PathLike">PathLike</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional path for timecode output</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.WobblySource(timecode_version)" class="doc doc-heading doc-heading-parameter">                  <code>timecode_version</code>
<a href="#y5gfunc.expr.test_atan2.WobblySource(timecode_version)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timecode version.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            V2


  
      class-attribute
      instance-attribute
   (y5gfunc.source.wobbly.types.TimecodeVersion.V2)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.TimecodeVersion.V2">V2</a></code>
            </td>
          </tr>
      </tbody>
    </table>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            load (y5gfunc.expr.test_atan2.WobblySource.load)" href="#y5gfunc.expr.test_atan2.WobblySource.load">load</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Load project file</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            create_presets (y5gfunc.expr.test_atan2.WobblySource.create_presets)" href="#y5gfunc.expr.test_atan2.WobblySource.create_presets">create_presets</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Create preset functions</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            init_properties (y5gfunc.expr.test_atan2.WobblySource.init_properties)" href="#y5gfunc.expr.test_atan2.WobblySource.init_properties">init_properties</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Initialize frame properties and mapping</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            generate_timecodes (y5gfunc.expr.test_atan2.WobblySource.generate_timecodes)" href="#y5gfunc.expr.test_atan2.WobblySource.generate_timecodes">generate_timecodes</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generate timecodes file if requested</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            process (y5gfunc.expr.test_atan2.WobblySource.process)" href="#y5gfunc.expr.test_atan2.WobblySource.process">process</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Process the Wobbly project</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            project_path


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.project_path)" href="#y5gfunc.expr.test_atan2.WobblySource.project_path">project_path</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            timecode_path


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.timecode_path)" href="#y5gfunc.expr.test_atan2.WobblySource.timecode_path">timecode_path</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            timecode_version


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.timecode_version)" href="#y5gfunc.expr.test_atan2.WobblySource.timecode_version">timecode_version</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            keys


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.keys)" href="#y5gfunc.expr.test_atan2.WobblySource.keys">keys</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            project


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.project)" href="#y5gfunc.expr.test_atan2.WobblySource.project">project</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            ProjectData


  
      module-attribute
   (y5gfunc.source.wobbly.types.ProjectData)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.ProjectData">ProjectData</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            input_file


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.input_file)" href="#y5gfunc.expr.test_atan2.WobblySource.input_file">input_file</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            source_filter


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.source_filter)" href="#y5gfunc.expr.test_atan2.WobblySource.source_filter">source_filter</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            frame_props


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.frame_props)" href="#y5gfunc.expr.test_atan2.WobblySource.frame_props">frame_props</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            FramePropertyMap


  
      module-attribute
   (y5gfunc.source.wobbly.types.FramePropertyMap)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.FramePropertyMap">FramePropertyMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            frame_mapping


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.frame_mapping)" href="#y5gfunc.expr.test_atan2.WobblySource.frame_mapping">frame_mapping</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            FrameMap


  
      module-attribute
   (y5gfunc.source.wobbly.types.FrameMap)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.FrameMap">FrameMap</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            presets


  
      instance-attribute
   (y5gfunc.expr.test_atan2.WobblySource.presets)" href="#y5gfunc.expr.test_atan2.WobblySource.presets">presets</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            PresetDict


  
      module-attribute
   (y5gfunc.source.wobbly.types.PresetDict)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.PresetDict">PresetDict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>y5gfunc/source/wobbly/core/source.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">wob_project_path</span><span class="p">:</span> <span class="n">PathLike</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">timecode_output_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PathLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">timecode_version</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">TimecodeVersion</span><span class="o">.</span><span class="n">V2</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="p">):</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Initialize Wobbly source processor</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        wob_project_path: Path to Wobbly project file</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        timecode_output_path: Optional path for timecode output</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        timecode_version: Timecode version.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">wob_project_path</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">timecode_path</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">resolve_path</span><span class="p">(</span><span class="n">timecode_output_path</span><span class="p">)</span> <span class="k">if</span> <span class="n">timecode_output_path</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">timecode_version</span> <span class="o">=</span> <span class="n">timecode_version</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">keys</span> <span class="o">=</span> <span class="n">WobblyKeys</span><span class="p">()</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># Initialize state</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ProjectData</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">source_filter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">:</span> <span class="n">FramePropertyMap</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">:</span> <span class="n">FrameMap</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">presets</span><span class="p">:</span> <span class="n">PresetDict</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.project_path" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">project_path</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.project_path" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">project_path</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            resolve_path (y5gfunc.utils.resolve_path)" href="../utils.html#y5gfunc.utils.resolve_path">resolve_path</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="wob_project_path (y5gfunc.source.wobbly.core.source.WobblySource(wob_project_path))" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource(wob_project_path)">wob_project_path</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.timecode_path" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">timecode_path</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.timecode_path" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">timecode_path</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            resolve_path (y5gfunc.utils.resolve_path)" href="../utils.html#y5gfunc.utils.resolve_path">resolve_path</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="timecode_output_path (y5gfunc.source.wobbly.core.source.WobblySource(timecode_output_path))" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource(timecode_output_path)">timecode_output_path</a></span><span class="p">)</span> <span class="k">if</span> <span class="n"><a class="autorefs autorefs-internal" title="timecode_output_path (y5gfunc.source.wobbly.core.source.WobblySource(timecode_output_path))" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource(timecode_output_path)">timecode_output_path</a></span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.timecode_version" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">timecode_version</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.timecode_version" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">timecode_version</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="timecode_version (y5gfunc.source.wobbly.core.source.WobblySource(timecode_version))" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource(timecode_version)">timecode_version</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.keys" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">keys</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.keys" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">keys</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            WobblyKeys


  
      dataclass
   (y5gfunc.source.wobbly.types.WobblyKeys)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.WobblyKeys">WobblyKeys</a></span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.project" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">project</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.project" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">project</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            ProjectData


  
      module-attribute
   (y5gfunc.source.wobbly.types.ProjectData)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.ProjectData">ProjectData</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.input_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">input_file</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.input_file" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">input_file</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.source_filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">source_filter</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.source_filter" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">source_filter</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.frame_props" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">frame_props</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.frame_props" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">frame_props</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            FramePropertyMap


  
      module-attribute
   (y5gfunc.source.wobbly.types.FramePropertyMap)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.FramePropertyMap">FramePropertyMap</a></span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.frame_mapping" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">frame_mapping</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.frame_mapping" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">frame_mapping</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            FrameMap


  
      module-attribute
   (y5gfunc.source.wobbly.types.FrameMap)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.FrameMap">FrameMap</a></span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.WobblySource.presets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">presets</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.WobblySource.presets" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">presets</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            PresetDict


  
      module-attribute
   (y5gfunc.source.wobbly.types.PresetDict)" href="../source/wobbly/types.html#y5gfunc.source.wobbly.types.PresetDict">PresetDict</a></span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.WobblySource.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">load</span>


<a href="#y5gfunc.expr.test_atan2.WobblySource.load" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            WobblySource (y5gfunc.source.wobbly.core.source.WobblySource)" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource">WobblySource</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load project file</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            WobblySource (y5gfunc.source.wobbly.core.source.WobblySource)" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource">WobblySource</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Self instance for method chaining</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            WobblyParseError (y5gfunc.source.wobbly.errors.WobblyParseError)" href="../source/wobbly/errors.html#y5gfunc.source.wobbly.errors.WobblyParseError">WobblyParseError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When project file cannot be parsed</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            WobblyInputError (y5gfunc.source.wobbly.errors.WobblyInputError)" href="../source/wobbly/errors.html#y5gfunc.source.wobbly.errors.WobblyInputError">WobblyInputError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When there are issues with input file</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/wobbly/core/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;WobblySource&quot;</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    Load project file</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        Self instance for method chaining</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        WobblyParseError: When project file cannot be parsed</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        WobblyInputError: When there are issues with input file</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="c1"># Load project file</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">load_project</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">raise</span> <span class="n">WobblyParseError</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">error</span> <span class="ow">or</span> <span class="s2">&quot;Unknown parsing error&quot;</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">Keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="c1"># Get input file path</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">input_file</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">source_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">source_filter</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">raise</span> <span class="n">WobblyInputError</span><span class="p">(</span><span class="s2">&quot;No input file specified in the project&quot;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="c1"># Handle relative paths</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="p">):</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">wob_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">)))</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wob_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.WobblySource.create_presets" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">create_presets</span>


<a href="#y5gfunc.expr.test_atan2.WobblySource.create_presets" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">create_presets</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            WobblySource (y5gfunc.source.wobbly.core.source.WobblySource)" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource">WobblySource</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create preset functions</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            WobblySource (y5gfunc.source.wobbly.core.source.WobblySource)" href="../source/wobbly/core/source.html#y5gfunc.source.wobbly.core.source.WobblySource">WobblySource</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Self instance for method chaining</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/wobbly/core/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_presets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;WobblySource&quot;</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">    Create preset functions</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        Self instance for method chaining</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">raise</span> <span class="n">WobblyProcessError</span><span class="p">(</span><span class="s2">&quot;Project not loaded&quot;</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;create_presets&quot;</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">presets</span> <span class="o">=</span> <span class="n">create_preset_functions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.WobblySource.init_properties" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">init_properties</span>


<a href="#y5gfunc.expr.test_atan2.WobblySource.init_properties" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">init_properties</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="src (y5gfunc.expr.test_atan2.WobblySource.init_properties(src))" href="#y5gfunc.expr.test_atan2.WobblySource.init_properties(src)">src</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize frame properties and mapping</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.WobblySource.init_properties(src)" class="doc doc-heading doc-heading-parameter">                  <code>src</code>
<a href="#y5gfunc.expr.test_atan2.WobblySource.init_properties(src)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source video clip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/wobbly/core/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="k">def</span><span class="w"> </span><span class="nf">init_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Initialize frame properties and mapping</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        src: Source video clip</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="c1"># Initialize basic properties for each frame</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">num_frames</span><span class="p">):</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="s2">&quot;WobblyProject&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">)),</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="s2">&quot;WobblyVersion&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">wobbly_version</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="s2">&quot;WobblySourceFilter&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_filter</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="c1"># Initialize empty values</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="s2">&quot;WobblyCustomList&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="s2">&quot;WobblyCustomListPreset&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="s2">&quot;WobblyCustomListPosition&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="s2">&quot;WobblySectionStart&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="s2">&quot;WobblySectionEnd&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="s2">&quot;WobblySectionPresets&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="s2">&quot;WobblyMatch&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="p">}</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="c1"># Prepare data for processing</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">num_frames</span><span class="p">):</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>  <span class="c1"># Initially the mapping is identical</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.WobblySource.generate_timecodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">generate_timecodes</span>


<a href="#y5gfunc.expr.test_atan2.WobblySource.generate_timecodes" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">generate_timecodes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate timecodes file if requested</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/wobbly/core/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_timecodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    Generate timecodes file if requested</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">timecode_path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">return</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">with</span> <span class="n">safe_processing</span><span class="p">(</span><span class="s2">&quot;timecode_generation&quot;</span><span class="p">):</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="c1"># Use the timecode generator factory to create the appropriate generator</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">generator</span> <span class="o">=</span> <span class="n">TimecodeGeneratorFactory</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timecode_version</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">timecodes</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timecode_path</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">timecodes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.WobblySource.process" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">process</span>


<a href="#y5gfunc.expr.test_atan2.WobblySource.process" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">process</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Process the Wobbly project</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Processed video node</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            WobblyProcessError (y5gfunc.source.wobbly.errors.WobblyProcessError)" href="../source/wobbly/errors.html#y5gfunc.source.wobbly.errors.WobblyProcessError">WobblyProcessError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When errors occur during processing</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/wobbly/core/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    Process the Wobbly project</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        Processed video node</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        WobblyProcessError: When errors occur during processing</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span><span class="p">:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_presets</span><span class="p">()</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="c1"># Load source video</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">src</span> <span class="o">=</span> <span class="n">load_source_video</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_filter</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="c1"># Initialize properties</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">init_properties</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="c1"># Process video pipeline</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="c1"># Apply early crop</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">crop_processor</span> <span class="o">=</span> <span class="n">CropProcessor</span><span class="p">(</span><span class="n">early</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">crop_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="c1"># Apply trimming</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">trim_processor</span> <span class="o">=</span> <span class="n">TrimProcessor</span><span class="p">()</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">trim_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="c1"># Apply custom lists - PostSource</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">custom_list_processor</span> <span class="o">=</span> <span class="n">CustomListProcessor</span><span class="p">(</span><span class="n">ProcessPosition</span><span class="o">.</span><span class="n">POST_SOURCE</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">custom_list_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="c1"># Process match information</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_match_information</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="c1"># Apply custom lists - PostFieldMatch</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">custom_list_processor</span> <span class="o">=</span> <span class="n">CustomListProcessor</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">ProcessPosition</span><span class="o">.</span><span class="n">POST_FIELD_MATCH</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="p">)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">custom_list_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="c1"># Apply sections and record section info</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">section_processor</span> <span class="o">=</span> <span class="n">SectionProcessor</span><span class="p">()</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">section_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="c1"># Mark special frames</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">special_frames_processor</span> <span class="o">=</span> <span class="n">SpecialFrameMarkProcessor</span><span class="p">()</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">special_frames_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="n">src</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">presets</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="c1"># Apply frozen frames</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">frozen_frames_processor</span> <span class="o">=</span> <span class="n">FrozenFramesProcessor</span><span class="p">()</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">frozen_frames_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="c1"># Apply frame rate conversion (delete frames)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">decimation_processor</span> <span class="o">=</span> <span class="n">DecimationProcessor</span><span class="p">()</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">decimation_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="c1"># Apply custom lists - PostDecimate</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">custom_list_processor</span> <span class="o">=</span> <span class="n">CustomListProcessor</span><span class="p">(</span><span class="n">ProcessPosition</span><span class="o">.</span><span class="n">POST_DECIMATE</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">custom_list_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="c1"># Apply final crop</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">crop_processor</span> <span class="o">=</span> <span class="n">CropProcessor</span><span class="p">(</span><span class="n">early</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">crop_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="c1"># Apply resize and bit depth</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">resize_processor</span> <span class="o">=</span> <span class="n">ResizeProcessor</span><span class="p">()</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span> <span class="o">=</span> <span class="n">resize_processor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_mapping</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">presets</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="c1"># Generate timecodes if requested</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">generate_timecodes</span><span class="p">()</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="c1"># Finally: Apply all frame properties</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">src</span> <span class="o">=</span> <span class="n">apply_frame_properties</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_props</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">WobblyError</span><span class="p">):</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="k">raise</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">raise</span> <span class="n">WobblyProcessError</span><span class="p">(</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="s2">&quot;Error processing Wobbly project&quot;</span><span class="p">,</span> <span class="n">stage</span><span class="o">=</span><span class="s2">&quot;processing&quot;</span><span class="p">,</span> <span class="n">cause</span><span class="o">=</span><span class="n">e</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">return</span> <span class="n">src</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.RpuFile" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">RpuFile</span>


<a href="#y5gfunc.expr.test_atan2.RpuFile" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">RpuFile</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="file_path (y5gfunc.expr.test_atan2.RpuFile(file_path))" href="#y5gfunc.expr.test_atan2.RpuFile(file_path)">file_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">])</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Represents a Dolby Vision RPU binary file.</p>

        <p>Initializes the RpuFile instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.RpuFile(file_path)" class="doc doc-heading doc-heading-parameter">                  <code>file_path</code>
<a href="#y5gfunc.expr.test_atan2.RpuFile(file_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the RPU file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError">FileNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file path does not exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            __len__ (y5gfunc.expr.test_atan2.RpuFile.__len__)" href="#y5gfunc.expr.test_atan2.RpuFile.__len__">__len__</a></code></td>
              <td>
                <div class="doc-md-description">
                  
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_frame_data (y5gfunc.expr.test_atan2.RpuFile.get_frame_data)" href="#y5gfunc.expr.test_atan2.RpuFile.get_frame_data">get_frame_data</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Gets the payload of a single RPU frame by its index.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            file_path


  
      instance-attribute
   (y5gfunc.expr.test_atan2.RpuFile.file_path)" href="#y5gfunc.expr.test_atan2.RpuFile.file_path">file_path</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>y5gfunc/source/rpu.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Initializes the RpuFile instance.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        file_path: Path to the RPU file.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        FileNotFoundError: If the file path does not exist.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_nalu_offsets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_load_and_parse</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.RpuFile.file_path" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">file_path</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.RpuFile.file_path" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">file_path</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            resolve_path (y5gfunc.utils.resolve_path)" href="../utils.html#y5gfunc.utils.resolve_path">resolve_path</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="file_path (y5gfunc.source.rpu.RpuFile(file_path))" href="../source/rpu.html#y5gfunc.source.rpu.RpuFile(file_path)">file_path</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.RpuFile.__len__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__len__</span>


<a href="#y5gfunc.expr.test_atan2.RpuFile.__len__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/rpu.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nalu_offsets</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.RpuFile.get_frame_data" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_frame_data</span>


<a href="#y5gfunc.expr.test_atan2.RpuFile.get_frame_data" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_frame_data</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="frame_index (y5gfunc.expr.test_atan2.RpuFile.get_frame_data(frame_index))" href="#y5gfunc.expr.test_atan2.RpuFile.get_frame_data(frame_index)">frame_index</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Gets the payload of a single RPU frame by its index.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.RpuFile.get_frame_data(frame_index)" class="doc doc-heading doc-heading-parameter">                  <code>frame_index</code>
<a href="#y5gfunc.expr.test_atan2.RpuFile.get_frame_data(frame_index)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 0-based index of the frame to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RPU payload binary data (starting with 0x19) for the requested frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IndexError">IndexError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If frame_index is out of bounds.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the RPU payload (0x19) is not found within the frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/rpu.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_frame_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Gets the payload of a single RPU frame by its index.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        frame_index: The 0-based index of the frame to retrieve.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        The RPU payload binary data (starting with 0x19) for the requested frame.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        IndexError: If frame_index is out of bounds.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        ValueError: If the RPU payload (0x19) is not found within the frame.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">frame_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nalu_offsets</span><span class="p">):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="sa">f</span><span class="s2">&quot;Frame index </span><span class="si">{</span><span class="n">frame_index</span><span class="si">}</span><span class="s2"> is out of range. Valid indices are 0 to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">start_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nalu_offsets</span><span class="p">[</span><span class="n">frame_index</span><span class="p">]</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">if</span> <span class="n">frame_index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nalu_offsets</span><span class="p">):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">end_offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nalu_offsets</span><span class="p">[</span><span class="n">frame_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">end_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">frame_content_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_RPU_PAYLOAD_START_BYTE</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">if</span> <span class="n">frame_content_start</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="sa">f</span><span class="s2">&quot;Could not find RPU payload (0x19) in frame </span><span class="si">{</span><span class="n">frame_index</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">frame_content_start</span><span class="p">:</span><span class="n">end_offset</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ProcessMode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ProcessMode</span>


<a href="#y5gfunc.expr.test_atan2.ProcessMode" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.StrEnum" href="https://docs.python.org/3/library/enum.html#enum.StrEnum">StrEnum</a></code></p>


        <p>Defines how an audio track should be processed.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            COPY


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ProcessMode.COPY)" href="#y5gfunc.expr.test_atan2.ProcessMode.COPY">COPY</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep original track, stream copy if possible</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            COMPRESS


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ProcessMode.COMPRESS)" href="#y5gfunc.expr.test_atan2.ProcessMode.COMPRESS">COMPRESS</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Re-encode losslessly (e.g., to FLAC)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            LOSSY


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ProcessMode.LOSSY)" href="#y5gfunc.expr.test_atan2.ProcessMode.LOSSY">LOSSY</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Re-encode lossily (e.g., to AAC, Opus)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            DROP


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ProcessMode.DROP)" href="#y5gfunc.expr.test_atan2.ProcessMode.DROP">DROP</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Do not include this track in the output</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ProcessMode.COPY" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">COPY</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ProcessMode.COPY" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">COPY</span> <span class="o">=</span> <span class="s1">&#39;copy&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ProcessMode.COMPRESS" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">COMPRESS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ProcessMode.COMPRESS" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">COMPRESS</span> <span class="o">=</span> <span class="s1">&#39;compress&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ProcessMode.LOSSY" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">LOSSY</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ProcessMode.LOSSY" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">LOSSY</span> <span class="o">=</span> <span class="s1">&#39;lossy&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ProcessMode.DROP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">DROP</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ProcessMode.DROP" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">DROP</span> <span class="o">=</span> <span class="s1">&#39;drop&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.TrackConfig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">TrackConfig</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.TrackConfig" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">TrackConfig</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.TrackConfig(mode)">mode</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProcessMode (y5gfunc.encode.audio.audio_config.ProcessMode)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.ProcessMode">ProcessMode</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            COPY


  
      class-attribute
      instance-attribute
   (y5gfunc.encode.audio.audio_config.ProcessMode.COPY)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.ProcessMode.COPY">COPY</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TrackConfig(format)">format</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;flac&#39;</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TrackConfig(bitrate)">bitrate</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">













<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            mode


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.TrackConfig.mode)" href="#y5gfunc.expr.test_atan2.TrackConfig.mode">mode</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ProcessMode (y5gfunc.encode.audio.audio_config.ProcessMode)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.ProcessMode">ProcessMode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            format


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.TrackConfig.format)" href="#y5gfunc.expr.test_atan2.TrackConfig.format">format</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            bitrate


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.TrackConfig.bitrate)" href="#y5gfunc.expr.test_atan2.TrackConfig.bitrate">bitrate</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.TrackConfig.mode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">mode</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.TrackConfig.mode" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">mode</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProcessMode (y5gfunc.encode.audio.audio_config.ProcessMode)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.ProcessMode">ProcessMode</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            COPY


  
      class-attribute
      instance-attribute
   (y5gfunc.encode.audio.audio_config.ProcessMode.COPY)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.ProcessMode.COPY">COPY</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.TrackConfig.format" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">format</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.TrackConfig.format" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">format</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;flac&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.TrackConfig.bitrate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">bitrate</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.TrackConfig.bitrate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">bitrate</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.AudioConfig" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">AudioConfig</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">AudioConfig</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(main_lossless_2ch)">main_lossless_2ch</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_main_lossless_2ch (y5gfunc.encode.audio.audio_config.create_main_lossless_2ch)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_lossless_2ch">create_main_lossless_2ch</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(main_lossless_multi)">main_lossless_multi</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_main_lossless_multi (y5gfunc.encode.audio.audio_config.create_main_lossless_multi)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_lossless_multi">create_main_lossless_multi</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(main_lossy)">main_lossy</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_main_lossy (y5gfunc.encode.audio.audio_config.create_main_lossy)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_lossy">create_main_lossy</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(main_special)">main_special</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_main_special (y5gfunc.encode.audio.audio_config.create_main_special)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_special">create_main_special</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(comment_lossless_2ch)">comment_lossless_2ch</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossless_2ch (y5gfunc.encode.audio.audio_config.create_comment_lossless_2ch)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossless_2ch">create_comment_lossless_2ch</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(comment_lossless_multi)">comment_lossless_multi</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossless_multi (y5gfunc.encode.audio.audio_config.create_comment_lossless_multi)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossless_multi">create_comment_lossless_multi</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(comment_lossy_low)">comment_lossy_low</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossy_low (y5gfunc.encode.audio.audio_config.create_comment_lossy_low)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossy_low">create_comment_lossy_low</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(comment_lossy_2ch)">comment_lossy_2ch</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossy_2ch (y5gfunc.encode.audio.audio_config.create_comment_lossy_2ch)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossy_2ch">create_comment_lossy_2ch</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(comment_lossy_multi)">comment_lossy_multi</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossy_multi (y5gfunc.encode.audio.audio_config.create_comment_lossy_multi)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossy_multi">create_comment_lossy_multi</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.AudioConfig(lossy_threshold)">lossy_threshold</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">512</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">











<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            get_track_config (y5gfunc.expr.test_atan2.AudioConfig.get_track_config)" href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config">get_track_config</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Determines the appropriate TrackConfig based on audio track properties.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            main_lossless_2ch


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.main_lossless_2ch)" href="#y5gfunc.expr.test_atan2.AudioConfig.main_lossless_2ch">main_lossless_2ch</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            main_lossless_multi


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.main_lossless_multi)" href="#y5gfunc.expr.test_atan2.AudioConfig.main_lossless_multi">main_lossless_multi</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            main_lossy


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.main_lossy)" href="#y5gfunc.expr.test_atan2.AudioConfig.main_lossy">main_lossy</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            main_special


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.main_special)" href="#y5gfunc.expr.test_atan2.AudioConfig.main_special">main_special</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            comment_lossless_2ch


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_2ch)" href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_2ch">comment_lossless_2ch</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            comment_lossless_multi


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_multi)" href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_multi">comment_lossless_multi</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            comment_lossy_low


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_low)" href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_low">comment_lossy_low</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            comment_lossy_2ch


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_2ch)" href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_2ch">comment_lossy_2ch</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            comment_lossy_multi


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_multi)" href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_multi">comment_lossy_multi</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            lossy_threshold


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.AudioConfig.lossy_threshold)" href="#y5gfunc.expr.test_atan2.AudioConfig.lossy_threshold">lossy_threshold</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.main_lossless_2ch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">main_lossless_2ch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.main_lossless_2ch" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">main_lossless_2ch</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_main_lossless_2ch (y5gfunc.encode.audio.audio_config.create_main_lossless_2ch)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_lossless_2ch">create_main_lossless_2ch</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.main_lossless_multi" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">main_lossless_multi</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.main_lossless_multi" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">main_lossless_multi</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_main_lossless_multi (y5gfunc.encode.audio.audio_config.create_main_lossless_multi)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_lossless_multi">create_main_lossless_multi</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.main_lossy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">main_lossy</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.main_lossy" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">main_lossy</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_main_lossy (y5gfunc.encode.audio.audio_config.create_main_lossy)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_lossy">create_main_lossy</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.main_special" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">main_special</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.main_special" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">main_special</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_main_special (y5gfunc.encode.audio.audio_config.create_main_special)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_main_special">create_main_special</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_2ch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">comment_lossless_2ch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_2ch" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">comment_lossless_2ch</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossless_2ch (y5gfunc.encode.audio.audio_config.create_comment_lossless_2ch)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossless_2ch">create_comment_lossless_2ch</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_multi" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">comment_lossless_multi</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossless_multi" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">comment_lossless_multi</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossless_multi (y5gfunc.encode.audio.audio_config.create_comment_lossless_multi)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossless_multi">create_comment_lossless_multi</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_low" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">comment_lossy_low</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_low" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">comment_lossy_low</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossy_low (y5gfunc.encode.audio.audio_config.create_comment_lossy_low)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossy_low">create_comment_lossy_low</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_2ch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">comment_lossy_2ch</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_2ch" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">comment_lossy_2ch</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossy_2ch (y5gfunc.encode.audio.audio_config.create_comment_lossy_2ch)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossy_2ch">create_comment_lossy_2ch</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_multi" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">comment_lossy_multi</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.comment_lossy_multi" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">comment_lossy_multi</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="dataclasses.field" href="https://docs.python.org/3/library/dataclasses.html#dataclasses.field">field</a></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="            create_comment_lossy_multi (y5gfunc.encode.audio.audio_config.create_comment_lossy_multi)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.create_comment_lossy_multi">create_comment_lossy_multi</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.AudioConfig.lossy_threshold" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">lossy_threshold</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.AudioConfig.lossy_threshold" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">lossy_threshold</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">512</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.AudioConfig.get_track_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">get_track_config</span>


<a href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_track_config</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="is_comment (y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_comment))" href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_comment)">is_comment</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="is_lossless (y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_lossless))" href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_lossless)">is_lossless</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="channels (y5gfunc.expr.test_atan2.AudioConfig.get_track_config(channels))" href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(channels)">channels</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="bitrate (y5gfunc.expr.test_atan2.AudioConfig.get_track_config(bitrate))" href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(bitrate)">bitrate</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="is_special (y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_special))" href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_special)">is_special</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Determines the appropriate TrackConfig based on audio track properties.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_comment)" class="doc doc-heading doc-heading-parameter">                  <code>is_comment</code>
<a href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_comment)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the track is commentary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_lossless)" class="doc doc-heading doc-heading-parameter">                  <code>is_lossless</code>
<a href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_lossless)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the original track is lossless.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.AudioConfig.get_track_config(channels)" class="doc doc-heading doc-heading-parameter">                  <code>channels</code>
<a href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(channels)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of audio channels in the track.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.AudioConfig.get_track_config(bitrate)" class="doc doc-heading doc-heading-parameter">                  <code>bitrate</code>
<a href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(bitrate)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Original bitrate of the track in Kbps (used for lossy threshold).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h4 id="y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_special)" class="doc doc-heading doc-heading-parameter">                  <code>is_special</code>
<a href="#y5gfunc.expr.test_atan2.AudioConfig.get_track_config(is_special)" class="headerlink" title="Permanent link">&para;</a></h4>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the track should use the 'main_special' config.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            TrackConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.TrackConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.TrackConfig">TrackConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The selected TrackConfig instance defining how to process the track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/audio/audio_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_track_config</span><span class="p">(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">is_comment</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">is_lossless</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">channels</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">bitrate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">is_special</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrackConfig</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Determines the appropriate TrackConfig based on audio track properties.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        is_comment: True if the track is commentary.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        is_lossless: True if the original track is lossless.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        channels: Number of audio channels in the track.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        bitrate: Original bitrate of the track in Kbps (used for lossy threshold).</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        is_special: True if the track should use the &#39;main_special&#39; config.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        The selected TrackConfig instance defining how to process the track.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">if</span> <span class="n">is_special</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_special</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">if</span> <span class="n">is_comment</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">if</span> <span class="n">is_lossless</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">comment_lossless_2ch</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="k">if</span> <span class="n">channels</span> <span class="o">&lt;=</span> <span class="mi">2</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_lossless_multi</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># lossy</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="k">if</span> <span class="n">bitrate</span> <span class="ow">and</span> <span class="n">bitrate</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lossy_threshold</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_lossy_low</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">comment_lossy_2ch</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="k">if</span> <span class="n">channels</span> <span class="o">&lt;=</span> <span class="mi">2</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment_lossy_multi</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># main track</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">is_lossless</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">main_lossless_2ch</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="k">if</span> <span class="n">channels</span> <span class="o">&lt;=</span> <span class="mi">2</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_lossless_multi</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_lossy</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.QcMode" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">QcMode</span>


<a href="#y5gfunc.expr.test_atan2.QcMode" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.StrEnum" href="https://docs.python.org/3/library/enum.html#enum.StrEnum">StrEnum</a></code></p>


        <p>Which metrics to use for quality check</p>












<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            SSIM


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.QcMode.SSIM)" href="#y5gfunc.expr.test_atan2.QcMode.SSIM">SSIM</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            CAMBI


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.QcMode.CAMBI)" href="#y5gfunc.expr.test_atan2.QcMode.CAMBI">CAMBI</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BOTH


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.QcMode.BOTH)" href="#y5gfunc.expr.test_atan2.QcMode.BOTH">BOTH</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>




  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.QcMode.SSIM" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">SSIM</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.QcMode.SSIM" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">SSIM</span> <span class="o">=</span> <span class="s1">&#39;SSIM&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.QcMode.CAMBI" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">CAMBI</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.QcMode.CAMBI" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">CAMBI</span> <span class="o">=</span> <span class="s1">&#39;CAMBI&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.QcMode.BOTH" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BOTH</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.QcMode.BOTH" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BOTH</span> <span class="o">=</span> <span class="s1">&#39;BOTH&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.ReturnType" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ReturnType</span>


<a href="#y5gfunc.expr.test_atan2.ReturnType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="enum.StrEnum" href="https://docs.python.org/3/library/enum.html#enum.StrEnum">StrEnum</a></code></p>


        <p>What to return after quality check</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ENCODED


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ReturnType.ENCODED)" href="#y5gfunc.expr.test_atan2.ReturnType.ENCODED">ENCODED</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return the <code>encoded</code> clip with frame properties added (CAMBI, PlaneSSIM, *_err flags)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            ERROR


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ReturnType.ERROR)" href="#y5gfunc.expr.test_atan2.ReturnType.ERROR">ERROR</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return a clip containing only the frames flagged as errors</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            BOTH


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.test_atan2.ReturnType.BOTH)" href="#y5gfunc.expr.test_atan2.ReturnType.BOTH">BOTH</a></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Return a tuple containing both the annotated <code>encoded</code> clip and the <code>error</code> clip.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>














  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ReturnType.ENCODED" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ENCODED</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ReturnType.ENCODED" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ENCODED</span> <span class="o">=</span> <span class="s1">&#39;encoded&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ReturnType.ERROR" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">ERROR</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ReturnType.ERROR" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.ReturnType.BOTH" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">BOTH</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.ReturnType.BOTH" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">BOTH</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="y5gfunc.expr.test_atan2.LazyVariable" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">LazyVariable</span>


<a href="#y5gfunc.expr.test_atan2.LazyVariable" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">LazyVariable</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="url (y5gfunc.expr.test_atan2.LazyVariable(url))" href="#y5gfunc.expr.test_atan2.LazyVariable(url)">url</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="binary (y5gfunc.expr.test_atan2.LazyVariable(binary))" href="#y5gfunc.expr.test_atan2.LazyVariable(binary)">binary</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="timeout (y5gfunc.expr.test_atan2.LazyVariable(timeout))" href="#y5gfunc.expr.test_atan2.LazyVariable(timeout)">timeout</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="max_retries (y5gfunc.expr.test_atan2.LazyVariable(max_retries))" href="#y5gfunc.expr.test_atan2.LazyVariable(max_retries)">max_retries</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="retry_delay (y5gfunc.expr.test_atan2.LazyVariable(retry_delay))" href="#y5gfunc.expr.test_atan2.LazyVariable(retry_delay)">retry_delay</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="cache_ttl (y5gfunc.expr.test_atan2.LazyVariable(cache_ttl))" href="#y5gfunc.expr.test_atan2.LazyVariable(cache_ttl)">cache_ttl</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">3600</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Represents a variable that is lazily loaded from a URL.</p>
<p>The content is downloaded on first access and cached for a specified
time-to-live (TTL). It supports retries with delays on download failure.
The content can be treated as text or binary.</p>

        <p>Initializes the LazyVariable instance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.LazyVariable(url)" class="doc doc-heading doc-heading-parameter">                  <code>url</code>
<a href="#y5gfunc.expr.test_atan2.LazyVariable(url)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL to download the content from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.LazyVariable(binary)" class="doc doc-heading doc-heading-parameter">                  <code>binary</code>
<a href="#y5gfunc.expr.test_atan2.LazyVariable(binary)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the content is binary. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.LazyVariable(timeout)" class="doc doc-heading doc-heading-parameter">                  <code>timeout</code>
<a href="#y5gfunc.expr.test_atan2.LazyVariable(timeout)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The request timeout in seconds. Defaults to 10.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.LazyVariable(max_retries)" class="doc doc-heading doc-heading-parameter">                  <code>max_retries</code>
<a href="#y5gfunc.expr.test_atan2.LazyVariable(max_retries)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of retries. Defaults to 5.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.LazyVariable(retry_delay)" class="doc doc-heading doc-heading-parameter">                  <code>retry_delay</code>
<a href="#y5gfunc.expr.test_atan2.LazyVariable(retry_delay)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The delay between retries in seconds. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.LazyVariable(cache_ttl)" class="doc doc-heading doc-heading-parameter">                  <code>cache_ttl</code>
<a href="#y5gfunc.expr.test_atan2.LazyVariable(cache_ttl)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time-to-live for the cache in seconds. Defaults to 3600.</p>
              </div>
            </td>
            <td>
                  <code>3600</code>
            </td>
          </tr>
      </tbody>
    </table>










<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            __str__ (y5gfunc.expr.test_atan2.LazyVariable.__str__)" href="#y5gfunc.expr.test_atan2.LazyVariable.__str__">__str__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the string representation of the content.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            __bytes__ (y5gfunc.expr.test_atan2.LazyVariable.__bytes__)" href="#y5gfunc.expr.test_atan2.LazyVariable.__bytes__">__bytes__</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Returns the bytes representation of the content.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="            refresh (y5gfunc.expr.test_atan2.LazyVariable.refresh)" href="#y5gfunc.expr.test_atan2.LazyVariable.refresh">refresh</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Forces a refresh of the content by clearing the cache.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>




<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            url


  
      instance-attribute
   (y5gfunc.expr.test_atan2.LazyVariable.url)" href="#y5gfunc.expr.test_atan2.LazyVariable.url">url</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            binary


  
      instance-attribute
   (y5gfunc.expr.test_atan2.LazyVariable.binary)" href="#y5gfunc.expr.test_atan2.LazyVariable.binary">binary</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            timeout


  
      instance-attribute
   (y5gfunc.expr.test_atan2.LazyVariable.timeout)" href="#y5gfunc.expr.test_atan2.LazyVariable.timeout">timeout</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            max_retries


  
      instance-attribute
   (y5gfunc.expr.test_atan2.LazyVariable.max_retries)" href="#y5gfunc.expr.test_atan2.LazyVariable.max_retries">max_retries</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            retry_delay


  
      instance-attribute
   (y5gfunc.expr.test_atan2.LazyVariable.retry_delay)" href="#y5gfunc.expr.test_atan2.LazyVariable.retry_delay">retry_delay</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="            cache_ttl


  
      instance-attribute
   (y5gfunc.expr.test_atan2.LazyVariable.cache_ttl)" href="#y5gfunc.expr.test_atan2.LazyVariable.cache_ttl">cache_ttl</a></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>y5gfunc/shader/lazy_loader/lazy_loader.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">binary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">retry_delay</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">cache_ttl</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Initializes the LazyVariable instance.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        url: The URL to download the content from.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        binary: Whether the content is binary. Defaults to False.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        timeout: The request timeout in seconds. Defaults to 10.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        max_retries: The maximum number of retries. Defaults to 5.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        retry_delay: The delay between retries in seconds. Defaults to 2.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        cache_ttl: The time-to-live for the cache in seconds. Defaults to 3600.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">url</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">binary</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">timeout</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">max_retries</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">retry_delay</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">retry_delay</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cache_ttl</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">cache_ttl</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_cached_content</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_cache_timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.LazyVariable.url" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">url</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.LazyVariable.url" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">url</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="url (y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(url))" href="../shader/lazy_loader/lazy_loader.html#y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(url)">url</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.LazyVariable.binary" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">binary</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.LazyVariable.binary" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">binary</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="binary (y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(binary))" href="../shader/lazy_loader/lazy_loader.html#y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(binary)">binary</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.LazyVariable.timeout" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">timeout</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.LazyVariable.timeout" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">timeout</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="timeout (y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(timeout))" href="../shader/lazy_loader/lazy_loader.html#y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(timeout)">timeout</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.LazyVariable.max_retries" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">max_retries</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.LazyVariable.max_retries" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">max_retries</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="max_retries (y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(max_retries))" href="../shader/lazy_loader/lazy_loader.html#y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(max_retries)">max_retries</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.LazyVariable.retry_delay" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">retry_delay</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.LazyVariable.retry_delay" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">retry_delay</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="retry_delay (y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(retry_delay))" href="../shader/lazy_loader/lazy_loader.html#y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(retry_delay)">retry_delay</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="y5gfunc.expr.test_atan2.LazyVariable.cache_ttl" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">cache_ttl</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.LazyVariable.cache_ttl" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">cache_ttl</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="cache_ttl (y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(cache_ttl))" href="../shader/lazy_loader/lazy_loader.html#y5gfunc.shader.lazy_loader.lazy_loader.LazyVariable(cache_ttl)">cache_ttl</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.LazyVariable.__str__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__str__</span>


<a href="#y5gfunc.expr.test_atan2.LazyVariable.__str__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the string representation of the content.</p>
<p>If the content is binary, it will be decoded.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/shader/lazy_loader/lazy_loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Returns the string representation of the content.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    If the content is binary, it will be decoded.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">()</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.LazyVariable.__bytes__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__bytes__</span>


<a href="#y5gfunc.expr.test_atan2.LazyVariable.__bytes__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">__bytes__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#bytes">bytes</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the bytes representation of the content.</p>
<p>If the content is text, it will be encoded.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/shader/lazy_loader/lazy_loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="k">def</span><span class="w"> </span><span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Returns the bytes representation of the content.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    If the content is text, it will be encoded.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">()</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="y5gfunc.expr.test_atan2.LazyVariable.refresh" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">refresh</span>


<a href="#y5gfunc.expr.test_atan2.LazyVariable.refresh" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">refresh</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Forces a refresh of the content by clearing the cache.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/shader/lazy_loader/lazy_loader.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Forces a refresh of the content by clearing the cache.&quot;&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_cached_content</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_cache_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.to_std_expr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">to_std_expr</span>


<a href="#y5gfunc.expr.test_atan2.to_std_expr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">to_std_expr</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.to_std_expr(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert an akarin.Expr expression to a std.Expr expression.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_std_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    Convert an akarin.Expr expression to a std.Expr expression.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="c1"># FIXME: convert math functions (trunc / round / floor / fmod) (possible?)</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">convert_drop</span><span class="p">(</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">convert_clip_names</span><span class="p">(</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">convert_var</span><span class="p">(</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="n">convert_sort</span><span class="p">(</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>                    <span class="n">convert_pow</span><span class="p">(</span><span class="n">convert_clip_clamp</span><span class="p">(</span><span class="n">convert_pi</span><span class="p">(</span><span class="n">convert_number</span><span class="p">(</span><span class="n">expr</span><span class="p">))))</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>            <span class="p">)</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.optimize_akarin_expr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">optimize_akarin_expr</span>


<a href="#y5gfunc.expr.test_atan2.optimize_akarin_expr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">optimize_akarin_expr</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.optimize_akarin_expr(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.optimize_akarin_expr(optimize_level)">optimize_level</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            OptimizeLevel (y5gfunc.expr.optimize.OptimizeLevel)" href="optimize.html#y5gfunc.expr.optimize.OptimizeLevel">OptimizeLevel</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            OFast


  
      class-attribute
      instance-attribute
   (y5gfunc.expr.optimize.OptimizeLevel.OFast)" href="optimize.html#y5gfunc.expr.optimize.OptimizeLevel.OFast">OFast</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fold constants and convert dynamic pixel access to static when possible.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/optimize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimize_akarin_expr</span><span class="p">(</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">optimize_level</span><span class="p">:</span> <span class="n">OptimizeLevel</span> <span class="o">=</span> <span class="n">OptimizeLevel</span><span class="o">.</span><span class="n">OFast</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fold constants and convert dynamic pixel access to static when possible.&quot;&quot;&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">expr</span><span class="p">:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">return</span> <span class="n">expr</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">if</span> <span class="n">optimize_level</span> <span class="o">==</span> <span class="n">OptimizeLevel</span><span class="o">.</span><span class="n">O0</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">return</span> <span class="n">expr</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">convert_sort</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">if</span> <span class="n">optimize_level</span> <span class="o">==</span> <span class="n">OptimizeLevel</span><span class="o">.</span><span class="n">OFast</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">expr</span> <span class="o">=</span> <span class="n">convert_pi</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">prev_expr</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">current_expr</span> <span class="o">=</span> <span class="n">expr</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">while</span> <span class="n">prev_expr</span> <span class="o">!=</span> <span class="n">current_expr</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">prev_expr</span> <span class="o">=</span> <span class="n">current_expr</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">current_expr</span> <span class="o">=</span> <span class="n">eliminate_immediate_store_load</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="n">fold_constants</span><span class="p">(</span><span class="n">current_expr</span><span class="p">,</span> <span class="n">optimize_level</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">if</span> <span class="n">optimize_level</span> <span class="o">&gt;=</span> <span class="n">OptimizeLevel</span><span class="o">.</span><span class="n">O2</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">current_expr</span> <span class="o">=</span> <span class="n">remove_unused_variables</span><span class="p">(</span><span class="n">current_expr</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">if</span> <span class="n">optimize_level</span> <span class="o">&gt;=</span> <span class="n">OptimizeLevel</span><span class="o">.</span><span class="n">O3</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="n">current_expr</span> <span class="o">=</span> <span class="n">convert_drop</span><span class="p">(</span><span class="n">current_expr</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">optimized_expr</span> <span class="o">=</span> <span class="n">convert_dynamic_to_static</span><span class="p">(</span><span class="n">current_expr</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">fold_constants</span><span class="p">(</span><span class="n">convert_var</span><span class="p">(</span><span class="n">optimized_expr</span><span class="p">),</span> <span class="n">optimize_level</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="k">if</span> <span class="n">optimize_level</span> <span class="o">&gt;=</span> <span class="n">OptimizeLevel</span><span class="o">.</span><span class="n">O3</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">else</span> <span class="n">optimized_expr</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convert_drop" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_drop</span>


<a href="#y5gfunc.expr.test_atan2.convert_drop" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_drop</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convert_drop(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replaces all 'drop' and 'dropN' operations in an expression string with their std.Expr emulated equivalents.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_drop</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    Replaces all &#39;drop&#39; and &#39;dropN&#39; operations in an expression string with their std.Expr emulated equivalents.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">new_tokens</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">stack_size</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">pending_plus_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;drop&quot;</span><span class="p">):</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">n_str</span> <span class="o">=</span> <span class="n">token</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="k">if</span> <span class="n">n_str</span><span class="p">:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_str</span><span class="p">)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                    <span class="c1"># Not a valid dropN, treat as normal token.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                    <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="k">if</span> <span class="n">stack_size</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">])</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                    <span class="n">stack_size</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="k">elif</span> <span class="n">stack_size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">])</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                    <span class="c1"># stack: [v1] -&gt; [v1, 0] -&gt; [0]. size remains 1.</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                    <span class="n">pending_plus_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="k">while</span> <span class="n">pending_plus_count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">stack_size</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">stack_size</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">pending_plus_count</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_tokens</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convert_sort" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_sort</span>


<a href="#y5gfunc.expr.test_atan2.convert_sort" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_sort</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convert_sort(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Expand sortN instructions in an RPN string to their equivalent min/max/swap/dup/varload(@)/varstore(!) sequences.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_sort</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Expand sortN instructions in an RPN string to their equivalent min/max/swap/dup/varload(@)/varstore(!) sequences.</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_unique_temp_prefix</span><span class="p">(</span><span class="n">used_vars</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate a unique temporary variable prefix that doesn&#39;t conflict with existing variables.&quot;&quot;&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="c1"># Use timestamp and random number to create a unique suffix</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000000</span><span class="p">))[</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="o">-</span><span class="mi">6</span><span class="p">:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="p">]</span>  <span class="c1"># Last 6 digits of microsecond timestamp</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">random_part</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">9999</span><span class="p">))</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">base_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;__sort_tmp_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">random_part</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="c1"># Ensure the prefix doesn&#39;t conflict with any existing variable</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">while</span> <span class="nb">any</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_prefix</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">used_vars</span><span class="p">):</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">base_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;__sort_tmp_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">random_part</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">return</span> <span class="n">base_prefix</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_sort_network</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">temp_prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">        Generate Batcher odd-even mergesort network for top n elements.</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">ops</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="c1"># Find the next power of 2 for padding</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">padded_n</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">while</span> <span class="n">padded_n</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">padded_n</span> <span class="o">*=</span> <span class="mi">2</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="n">ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">padded_n</span><span class="p">):</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="n">ops</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;1e30&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">])</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">compare_and_swap</span><span class="p">(</span><span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Generate operations to compare and swap elements at positions i and j&quot;&quot;&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">ops</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="p">[</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">@&quot;</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">@&quot;</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">@&quot;</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">@&quot;</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                    <span class="s2">&quot;max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="p">]</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">odd_even_merge_sort</span><span class="p">(</span><span class="n">lo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Batcher odd-even mergesort for elements from lo to lo+length-1&quot;&quot;&quot;</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="k">return</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">mid</span> <span class="o">=</span> <span class="n">length</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="c1"># Sort first and second half</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">odd_even_merge_sort</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="n">odd_even_merge_sort</span><span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mid</span><span class="p">)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="c1"># Merge the sorted halves</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">odd_even_merge</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">odd_even_merge</span><span class="p">(</span><span class="n">lo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Odd-even merge: merge two sorted sequences into one&quot;&quot;&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">step</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="mi">2</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="n">odd_even_merge</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>  <span class="c1"># even positions</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="n">odd_even_merge</span><span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">r</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>  <span class="c1"># odd positions</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="c1"># Compare and swap elements at distance r</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">i</span> <span class="o">=</span> <span class="n">lo</span> <span class="o">+</span> <span class="n">r</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="k">while</span> <span class="n">i</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">lo</span> <span class="o">+</span> <span class="n">length</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                    <span class="n">compare_and_swap</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                    <span class="n">i</span> <span class="o">+=</span> <span class="n">step</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="c1"># compare adjacent elements</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="k">if</span> <span class="n">lo</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">padded_n</span><span class="p">:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                    <span class="n">compare_and_swap</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">lo</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="n">odd_even_merge_sort</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">padded_n</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># Push back to stack in sorted order, with min at top (only original n elements)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">ops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">@&quot;</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="k">return</span> <span class="n">ops</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tokens</span><span class="p">:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">used_vars</span> <span class="o">=</span> <span class="n">get_used_variable_names</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">temp_prefix</span> <span class="o">=</span> <span class="n">generate_unique_temp_prefix</span><span class="p">(</span><span class="n">used_vars</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">new_tokens</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">token</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">):</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="c1"># parse sortN</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">n_str</span> <span class="o">=</span> <span class="n">token</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">n_str</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_str</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                    <span class="c1"># not a valid sortN, treat as normal token</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="c1"># invalid sort count</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="k">continue</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="c1"># generate sort network operations</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">sort_ops</span> <span class="o">=</span> <span class="n">generate_sort_network</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">temp_prefix</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sort_ops</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_tokens</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convert_var" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_var</span>


<a href="#y5gfunc.expr.test_atan2.convert_var" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_var</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convert_var(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rewrite variable store/load (<code>x!</code>, <code>x@</code>) to stack ops (<code>dup</code>, <code>swap</code>, <code>drop</code>).</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_var</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Rewrite variable store/load (`x!`, `x@`) to stack ops (`dup`, `swap`, `drop`).&quot;&quot;&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">tokens</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="c1"># Find all variable names used</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">var_names</span> <span class="o">=</span> <span class="n">get_used_variable_names</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">var_names</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">var_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">var_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_list</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">var_to_pos</span> <span class="o">=</span> <span class="p">{</span><span class="n">var</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">var_list</span><span class="p">)}</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">new_tokens</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">var_count</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">stack_size</span> <span class="o">=</span> <span class="n">var_count</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;!&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_REL_STATIC_PATTERN_POSTFIX</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>                <span class="n">token</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="p">):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>                <span class="n">var_name</span> <span class="o">=</span> <span class="n">token</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>                <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">var_to_pos</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="n">var_to_pos</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>                    <span class="n">swap_index</span> <span class="o">=</span> <span class="n">stack_size</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">pos</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>                    <span class="k">if</span> <span class="n">swap_index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>                        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;swap&quot;</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>                        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;swap</span><span class="si">{</span><span class="n">swap_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;drop&quot;</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                    <span class="n">stack_size</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                    <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_REL_STATIC_PATTERN_POSTFIX</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                <span class="n">token</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="p">):</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="n">var_name</span> <span class="o">=</span> <span class="n">token</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">var_to_pos</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                    <span class="n">pos</span> <span class="o">=</span> <span class="n">var_to_pos</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                    <span class="n">dup_index</span> <span class="o">=</span> <span class="n">stack_size</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">pos</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                    <span class="k">if</span> <span class="n">dup_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dup&quot;</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dup</span><span class="si">{</span><span class="n">dup_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                    <span class="n">stack_size</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                    <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                    <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>            <span class="n">stack_size</span> <span class="o">+=</span> <span class="n">get_stack_effect</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">var_count</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;swap&quot;</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;drop&quot;</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">stack_size</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_tokens</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convert_clip_names" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_clip_names</span>


<a href="#y5gfunc.expr.test_atan2.convert_clip_names" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_clip_names</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convert_clip_names(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replace clip names with their std.Expr equivalents.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_clip_names</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    Replace clip names with their std.Expr equivalents.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\bsrc(\d+)\b&quot;</span><span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">clip_vars</span> <span class="o">=</span> <span class="s2">&quot;xyzabcdefghijklmnopqrstuvw&quot;</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_replacement</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">clip_vars</span><span class="p">):</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="k">return</span> <span class="n">clip_vars</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="sa">f</span><span class="s2">&quot;Clip index </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> is out of range. std.Expr supports up to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">clip_vars</span><span class="p">)</span><span class="si">}</span><span class="s2"> clips (src0 ~ src</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">clip_vars</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">get_replacement</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convert_pow" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_pow</span>


<a href="#y5gfunc.expr.test_atan2.convert_pow" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_pow</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convert_pow(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replace ** with pow.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_pow</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    Replace ** with pow.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;pow&quot;</span> <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="s2">&quot;**&quot;</span> <span class="k">else</span> <span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convert_clip_clamp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convert_clip_clamp</span>


<a href="#y5gfunc.expr.test_atan2.convert_clip_clamp" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convert_clip_clamp</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convert_clip_clamp(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Replace clip and clamp operators with their std.Expr equivalents.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/transform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="k">def</span><span class="w"> </span><span class="nf">convert_clip_clamp</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Replace clip and clamp operators with their std.Expr equivalents.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="n">new_tokens</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">_CLAMP_OPS</span><span class="p">:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;swap2&quot;</span><span class="p">,</span> <span class="s2">&quot;swap&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">])</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="n">new_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_tokens</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.verify_akarin_expr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">verify_akarin_expr</span>


<a href="#y5gfunc.expr.test_atan2.verify_akarin_expr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">verify_akarin_expr</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.verify_akarin_expr(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Verify if an expression is valid in akarin.Expr.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/verify.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_akarin_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="sd">    Verify if an expression is valid in akarin.Expr.</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>        <span class="n">postfix2infix</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">check_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;postfix2infix&quot;</span><span class="p">,</span> <span class="s2">&quot;verify_akarin_expr&quot;</span><span class="p">))</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.verify_std_expr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">verify_std_expr</span>


<a href="#y5gfunc.expr.test_atan2.verify_std_expr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">verify_std_expr</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.verify_std_expr(expr)">expr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Verify if an expression is valid in std.Expr.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/verify.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_std_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Verify if an expression is valid in std.Expr.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">expr</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="n">stack_size</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">one_arg_ops</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;exp&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="s2">&quot;sqrt&quot;</span><span class="p">,</span> <span class="s2">&quot;sin&quot;</span><span class="p">,</span> <span class="s2">&quot;cos&quot;</span><span class="p">,</span> <span class="s2">&quot;abs&quot;</span><span class="p">,</span> <span class="s2">&quot;not&quot;</span><span class="p">}</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="n">two_arg_ops</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>            <span class="s2">&quot;+&quot;</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>            <span class="s2">&quot;-&quot;</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="s2">&quot;*&quot;</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="s2">&quot;/&quot;</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>            <span class="s2">&quot;max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="s2">&quot;pow&quot;</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="s2">&quot;=&quot;</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="s2">&quot;and&quot;</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="s2">&quot;or&quot;</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="s2">&quot;xor&quot;</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="p">}</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">three_arg_ops</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;?&quot;</span><span class="p">}</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">number_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="sa">r</span><span class="s2">&quot;^[+\-]?(\d+(\.\d+)?([eE][+\-]?\d+)?)$&quot;</span><span class="p">,</span>  <span class="c1"># Decimal and scientific notation only</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="k">if</span> <span class="n">number_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="n">stack_size</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                <span class="k">continue</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">isalpha</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="s2">&quot;a&quot;</span> <span class="o">&lt;=</span> <span class="n">token</span> <span class="o">&lt;=</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                <span class="n">stack_size</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                <span class="k">continue</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">one_arg_ops</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="k">if</span> <span class="n">stack_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">th token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; requires 1 argument, but stack has </span><span class="si">{</span><span class="n">stack_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                    <span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                <span class="k">continue</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">two_arg_ops</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                <span class="k">if</span> <span class="n">stack_size</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">th token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; requires 2 arguments, but stack has </span><span class="si">{</span><span class="n">stack_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                    <span class="p">)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                <span class="n">stack_size</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                <span class="k">continue</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">three_arg_ops</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                <span class="k">if</span> <span class="n">stack_size</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">th token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; requires 3 arguments, but stack has </span><span class="si">{</span><span class="n">stack_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                    <span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                <span class="n">stack_size</span> <span class="o">-=</span> <span class="mi">2</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="k">continue</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">dup_match</span> <span class="o">=</span> <span class="n">_DUP_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="k">if</span> <span class="n">dup_match</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dup_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="n">dup_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="k">if</span> <span class="n">stack_size</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">th token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; needs to duplicate the </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">-th element, but stack size is only </span><span class="si">{</span><span class="n">stack_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                    <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="n">stack_size</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="k">continue</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="n">swap_match</span> <span class="o">=</span> <span class="n">_SWAP_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="k">if</span> <span class="n">swap_match</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">swap_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="n">swap_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="k">if</span> <span class="n">stack_size</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">th token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; needs to swap with the </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">-th element, but stack size is only </span><span class="si">{</span><span class="n">stack_size</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                    <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="k">continue</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">th token &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; is unknown.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="k">if</span> <span class="n">stack_size</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="sa">f</span><span class="s2">&quot;Expression left </span><span class="si">{</span><span class="n">stack_size</span><span class="si">}</span><span class="s2"> items on the stack, but 1 was expected.&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;verify_std_expr: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.emulate_expr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">emulate_expr</span>


<a href="#y5gfunc.expr.test_atan2.emulate_expr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">emulate_expr</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="expr (y5gfunc.expr.test_atan2.emulate_expr(expr))" href="#y5gfunc.expr.test_atan2.emulate_expr(expr)">expr</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="constants (y5gfunc.expr.test_atan2.emulate_expr(constants))" href="#y5gfunc.expr.test_atan2.emulate_expr(constants)">constants</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ConstantValues


  
      dataclass
   (y5gfunc.expr.emulator.ConstantValues)" href="emulator.html#y5gfunc.expr.emulator.ConstantValues">ConstantValues</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            ConstantValues


  
      dataclass
   (y5gfunc.expr.emulator.ConstantValues)" href="emulator.html#y5gfunc.expr.emulator.ConstantValues">ConstantValues</a></span><span class="p">(),</span> <span class="n"><a class="autorefs autorefs-internal" title="clip_value (y5gfunc.expr.test_atan2.emulate_expr(clip_value))" href="#y5gfunc.expr.test_atan2.emulate_expr(clip_value)">clip_value</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="clip_prop (y5gfunc.expr.test_atan2.emulate_expr(clip_prop))" href="#y5gfunc.expr.test_atan2.emulate_expr(clip_prop)">clip_prop</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Emulate Akarin.Expr with the given constants, clip values and properties.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.emulate_expr(expr)" class="doc doc-heading doc-heading-parameter">                  <code>expr</code>
<a href="#y5gfunc.expr.test_atan2.emulate_expr(expr)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expression to emulate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.emulate_expr(constants)" class="doc doc-heading doc-heading-parameter">                  <code>constants</code>
<a href="#y5gfunc.expr.test_atan2.emulate_expr(constants)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ConstantValues


  
      dataclass
   (y5gfunc.expr.emulator.ConstantValues)" href="emulator.html#y5gfunc.expr.emulator.ConstantValues">ConstantValues</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object containing constant values (N, X, Y, width, height, pi).</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ConstantValues


  
      dataclass
   (y5gfunc.expr.emulator.ConstantValues)" href="emulator.html#y5gfunc.expr.emulator.ConstantValues">ConstantValues</a>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.emulate_expr(clip_value)" class="doc doc-heading doc-heading-parameter">                  <code>clip_value</code>
<a href="#y5gfunc.expr.test_atan2.emulate_expr(clip_value)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The values of the clips. (e.g. {"src0": 1.0, "src1": 2.0})</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.emulate_expr(clip_prop)" class="doc doc-heading doc-heading-parameter">                  <code>clip_prop</code>
<a href="#y5gfunc.expr.test_atan2.emulate_expr(clip_prop)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The properties of the clips. (e.g. {"src0": [("prop1", 1234), ("prop2", 4567.8)], "src1": [("yajyuu_senpai", 114514)]})</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the expression is invalid or if a clip or property is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/emulator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span>
<span class="normal"><a href="#__codelineno-0-98">98</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">emulate_expr</span><span class="p">(</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">constants</span><span class="p">:</span> <span class="n">ConstantValues</span> <span class="o">=</span> <span class="n">ConstantValues</span><span class="p">(),</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">clip_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">clip_prop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Emulate Akarin.Expr with the given constants, clip values and properties.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        expr: The expression to emulate.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        constants: An object containing constant values (N, X, Y, width, height, pi).</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        clip_value: The values of the clips. (e.g. {&quot;src0&quot;: 1.0, &quot;src1&quot;: 2.0})</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        clip_prop: The properties of the clips. (e.g. {&quot;src0&quot;: [(&quot;prop1&quot;, 1234), (&quot;prop2&quot;, 4567.8)], &quot;src1&quot;: [(&quot;yajyuu_senpai&quot;, 114514)]})</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        The result of the expression.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        ValueError: If the expression is invalid or if a clip or property is not found.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">clip_value</span> <span class="o">=</span> <span class="n">clip_value</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">clip_prop</span> <span class="o">=</span> <span class="n">clip_prop</span> <span class="ow">or</span> <span class="p">{}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">all_clip_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">clip_value</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">clip_prop</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_clip_names</span><span class="p">:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">is_clip_postfix</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">)):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;emulate_expr: Invalid clip name provided: &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">constant_values_dict</span> <span class="o">=</span> <span class="n">asdict</span><span class="p">(</span><span class="n">constants</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">optimize_akarin_expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">infix_expr</span> <span class="o">=</span> <span class="n">postfix2infix</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">expanded_expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">infix_expr</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize_expr</span><span class="p">(</span><span class="n">expanded_expr</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="k">if</span> <span class="n">is_clip_postfix</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">clip_value</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">clip_value</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                    <span class="sa">f</span><span class="s2">&quot;emulate_expr: Clip &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; not found in provided values or properties.&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">elif</span> <span class="n">_FRAME_PROP_PATTERN</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>            <span class="n">clip_name</span><span class="p">,</span> <span class="n">prop_name</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="n">found_prop_val</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="k">for</span> <span class="n">clip_nm</span><span class="p">,</span> <span class="n">props</span> <span class="ow">in</span> <span class="n">clip_prop</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                <span class="k">if</span> <span class="n">clip_nm</span> <span class="o">==</span> <span class="n">clip_name</span><span class="p">:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                        <span class="k">if</span> <span class="n">prop</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">prop_name</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">found_prop_val</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                                <span class="n">found_prop_val</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                                <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                                    <span class="sa">f</span><span class="s2">&quot;emulate_expr: Duplicate property &#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39; found for clip &#39;</span><span class="si">{</span><span class="n">clip_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                                <span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">found_prop_val</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                    <span class="sa">f</span><span class="s2">&quot;emulate_expr: Property &#39;</span><span class="si">{</span><span class="n">prop_name</span><span class="si">}</span><span class="s2">&#39; not found for clip &#39;</span><span class="si">{</span><span class="n">clip_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                <span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">elif</span> <span class="n">token</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;pi&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">}:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">constant_values_dict</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">constant_values_dict</span><span class="p">[</span><span class="n">token</span><span class="p">])</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                    <span class="sa">f</span><span class="s2">&quot;emulate_expr: Constant &#39;</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s2">&#39; not found in provided constants.&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">ret</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">optimize_akarin_expr</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)))</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="sa">f</span><span class="s2">&quot;emulate_expr: Error occurred while optimizing expression: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.sakiko_deband" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">sakiko_deband</span>


<a href="#y5gfunc.expr.test_atan2.sakiko_deband" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">sakiko_deband</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(r1)">r1</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(y1)">y1</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">72</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(uv1)">uv1</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(r2)">r2</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(y2)">y2</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(uv2)">uv2</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(mstr)">mstr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">6000</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(inflate)">inflate</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(include_mask)">include_mask</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(kill)">kill</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(bmask)">bmask</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(limit)">limit</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(limit_thry)">limit_thry</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(limit_thrc)">limit_thrc</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.sakiko_deband(limit_elast)">limit_elast</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sakiko Togawa is good at de-band</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/deband.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">sakiko_deband</span><span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">r1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">y1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">72</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">uv1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">r2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">y2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">uv2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">mstr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6000</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">inflate</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">include_mask</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">kill</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">bmask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">limit_thry</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">limit_thrc</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">limit_elast</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]]:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sakiko Togawa is good at de-band&quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">vs</span><span class="o">.</span><span class="n">YUV420P16</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="k">if</span> <span class="n">kill</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="n">kill</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">remove_grain</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">elif</span> <span class="ow">not</span> <span class="n">kill</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">kill</span> <span class="o">=</span> <span class="n">clip</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kill</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">grain</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MakeDiff</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">kill</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">f3kdb_params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="s2">&quot;grainy&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="s2">&quot;grainc&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="s2">&quot;sample_mode&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="s2">&quot;blur_first&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="s2">&quot;dither_algo&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="p">}</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">f3k1</span> <span class="o">=</span> <span class="n">kill</span><span class="o">.</span><span class="n">neo_f3kdb</span><span class="o">.</span><span class="n">Deband</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">uv1</span><span class="p">,</span> <span class="n">uv1</span><span class="p">,</span> <span class="o">**</span><span class="n">f3kdb_params</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">f3k2</span> <span class="o">=</span> <span class="n">f3k1</span><span class="o">.</span><span class="n">neo_f3kdb</span><span class="o">.</span><span class="n">Deband</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">uv2</span><span class="p">,</span> <span class="n">uv2</span><span class="p">,</span> <span class="o">**</span><span class="n">f3kdb_params</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="k">if</span> <span class="n">limit</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="n">f3k2</span> <span class="o">=</span> <span class="n">mvf</span><span class="o">.</span><span class="n">LimitFilter</span><span class="p">(</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="n">f3k2</span><span class="p">,</span> <span class="n">kill</span><span class="p">,</span> <span class="n">thr</span><span class="o">=</span><span class="n">limit_thry</span><span class="p">,</span> <span class="n">thrc</span><span class="o">=</span><span class="n">limit_thrc</span><span class="p">,</span> <span class="n">elast</span><span class="o">=</span><span class="n">limit_elast</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="k">if</span> <span class="n">bmask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>        <span class="n">bmask</span> <span class="o">=</span> <span class="n">retinex_edgemask</span><span class="p">(</span><span class="n">kill</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Binarize</span><span class="p">(</span><span class="n">mstr</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="n">bmask</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">bmask</span><span class="p">,</span> <span class="n">_inflate</span><span class="p">,</span> <span class="n">inflate</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">deband</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MaskedMerge</span><span class="p">(</span><span class="n">f3k2</span><span class="p">,</span> <span class="n">kill</span><span class="p">,</span> <span class="n">bmask</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">deband</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MergeDiff</span><span class="p">(</span><span class="n">deband</span><span class="p">,</span> <span class="n">grain</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">include_mask</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">return</span> <span class="n">deband</span><span class="p">,</span> <span class="n">bmask</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">return</span> <span class="n">deband</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">Fast_BM3DWrapper</span>


<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Fast_BM3DWrapper</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(clip))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="bm3d (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(bm3d))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(bm3d)">bm3d</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="chroma (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(chroma))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(chroma)">chroma</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sigma_Y (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_Y))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_Y)">sigma_Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="radius_Y (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_Y))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_Y)">radius_Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="delta_sigma_Y (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_Y))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_Y)">delta_sigma_Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="preset_Y_basic (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_basic))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_basic)">preset_Y_basic</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="preset_Y_final (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_final))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_final)">preset_Y_final</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sigma_chroma (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_chroma))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_chroma)">sigma_chroma</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.4</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="radius_chroma (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_chroma))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_chroma)">radius_chroma</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="delta_sigma_chroma (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_chroma))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_chroma)">delta_sigma_chroma</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="preset_chroma_basic (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_basic))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_basic)">preset_chroma_basic</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="preset_chroma_final (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_final))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_final)">preset_chroma_final</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="ref (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(ref))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(ref)">ref</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="opp_matrix (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(opp_matrix))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(opp_matrix)">opp_matrix</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fast (y5gfunc.expr.test_atan2.Fast_BM3DWrapper(fast))" href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(fast)">fast</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>BM3D/V-BM3D denoising</p>
<p>This function performs a two-step BM3D (or V-BM3D if radius &gt; 0) denoising process. Luma (Y) is processed directly.
Chroma (U/V) is processed by downscaling the denoised luma, joining it with the original chroma, converting to OPP color space
at half resolution, denoising in OPP, converting back to YUV, and finally joining the denoised luma and denoised chroma planes.</p>
<p>The 'delta_sigma' parameters add extra strength specifically to the first (basic) denoising step for both luma and chroma.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input video clip. Must be in YUV420P16 format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(bm3d)" class="doc doc-heading doc-heading-parameter">                  <code>bm3d</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(bm3d)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The BM3D plugin implementation to use. If <code>None</code> (default), it will automatically detect and
select the best available backend (<code>bm3dcuda_rtc</code>, <code>bm3dcuda</code>, <code>bm3dhip</code>, <code>bm3dsycl</code>).
If no compatible GPU hardware is found, it falls back to <code>bm3dcpu</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(chroma)" class="doc doc-heading doc-heading-parameter">                  <code>chroma</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(chroma)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, process chroma planes. If False, only luma is processed and original chroma is retained.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_Y)" class="doc doc-heading doc-heading-parameter">                  <code>sigma_Y</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoising strength for the luma plane's final step.</p>
              </div>
            </td>
            <td>
                  <code>1.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_Y)" class="doc doc-heading doc-heading-parameter">                  <code>radius_Y</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temporal radius for luma processing. If &gt; 0, V-BM3D is used.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_Y)" class="doc doc-heading doc-heading-parameter">                  <code>delta_sigma_Y</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional sigma added to <code>sigma_Y</code> for the luma plane's basic step.</p>
              </div>
            </td>
            <td>
                  <code>0.6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_basic)" class="doc doc-heading doc-heading-parameter">                  <code>preset_Y_basic</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_basic)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BM3D parameter preset for the luma basic step.
If <code>None</code> (default), it's set to <code>BM3DPreset.LC</code> for GPU backends and <code>BM3DPreset.FAST</code> for CPU backends.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_final)" class="doc doc-heading doc-heading-parameter">                  <code>preset_Y_final</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_Y_final)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BM3D parameter preset for the luma final step.
If <code>None</code> (default), it's set to <code>BM3DPreset.LC</code> for GPU backends and <code>BM3DPreset.FAST</code> for CPU backends.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_chroma)" class="doc doc-heading doc-heading-parameter">                  <code>sigma_chroma</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(sigma_chroma)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoising strength for the chroma planes' final step.</p>
              </div>
            </td>
            <td>
                  <code>2.4</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_chroma)" class="doc doc-heading doc-heading-parameter">                  <code>radius_chroma</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(radius_chroma)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temporal radius for chroma processing. If &gt; 0, V-BM3D is used.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_chroma)" class="doc doc-heading doc-heading-parameter">                  <code>delta_sigma_chroma</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(delta_sigma_chroma)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional sigma added to <code>sigma_chroma</code> for the chroma planes' basic step.</p>
              </div>
            </td>
            <td>
                  <code>1.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_basic)" class="doc doc-heading doc-heading-parameter">                  <code>preset_chroma_basic</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_basic)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BM3D parameter preset for the chroma basic step.
If <code>None</code> (default), it's set to <code>BM3DPreset.LC</code> for GPU backends and <code>BM3DPreset.FAST</code> for CPU backends.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_final)" class="doc doc-heading doc-heading-parameter">                  <code>preset_chroma_final</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(preset_chroma_final)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BM3D parameter preset for the chroma final step.
If <code>None</code> (default), it's set to <code>BM3DPreset.LC</code> for GPU backends and <code>BM3DPreset.FAST</code> for CPU backends.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(ref)" class="doc doc-heading doc-heading-parameter">                  <code>ref</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(ref)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="vstools.vs.VideoNode">VideoNode</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ref for final BM3D step. If provided, basic step is bypassed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(opp_matrix)" class="doc doc-heading doc-heading-parameter">                  <code>opp_matrix</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(opp_matrix)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OPP transform type to use.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.Fast_BM3DWrapper(fast)" class="doc doc-heading doc-heading-parameter">                  <code>fast</code>
<a href="#y5gfunc.expr.test_atan2.Fast_BM3DWrapper(fast)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multi-threaded copy between CPU and GPU at the expense of 4x memory consumption.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Denoised video clip in YUV420P16 format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input clip format is not YUV420P16.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any provided preset name is invalid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>fast</code> is set for non-gpu backend.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The <code>delta_sigma_xxx</code> value is added to <code>sigma_xxx</code> only for the 'basic' denoising step. The 'final' step uses <code>sigma_xxx</code> directly.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/denoise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="k">def</span><span class="w"> </span><span class="nf">Fast_BM3DWrapper</span><span class="p">(</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">bm3d</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">chroma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">sigma_Y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">radius_Y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">delta_sigma_Y</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">preset_Y_basic</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BM3DPreset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">preset_Y_final</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BM3DPreset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">sigma_chroma</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.4</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">radius_chroma</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">delta_sigma_chroma</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">preset_chroma_basic</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BM3DPreset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">preset_chroma_final</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BM3DPreset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">ref</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">opp_matrix</span><span class="p">:</span> <span class="n">ColorMatrixManager</span> <span class="o">=</span> <span class="n">default_opp</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">fast</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    BM3D/V-BM3D denoising</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    This function performs a two-step BM3D (or V-BM3D if radius &gt; 0) denoising process. Luma (Y) is processed directly.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Chroma (U/V) is processed by downscaling the denoised luma, joining it with the original chroma, converting to OPP color space</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    at half resolution, denoising in OPP, converting back to YUV, and finally joining the denoised luma and denoised chroma planes.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    The &#39;delta_sigma&#39; parameters add extra strength specifically to the first (basic) denoising step for both luma and chroma.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        clip: Input video clip. Must be in YUV420P16 format.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        bm3d: The BM3D plugin implementation to use. If `None` (default), it will automatically detect and</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            select the best available backend (`bm3dcuda_rtc`, `bm3dcuda`, `bm3dhip`, `bm3dsycl`).</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            If no compatible GPU hardware is found, it falls back to `bm3dcpu`.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        chroma: If True, process chroma planes. If False, only luma is processed and original chroma is retained.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        sigma_Y: Denoising strength for the luma plane&#39;s final step.</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        radius_Y: Temporal radius for luma processing. If &gt; 0, V-BM3D is used.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        delta_sigma_Y: Additional sigma added to `sigma_Y` for the luma plane&#39;s basic step.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        preset_Y_basic: BM3D parameter preset for the luma basic step.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            If `None` (default), it&#39;s set to `BM3DPreset.LC` for GPU backends and `BM3DPreset.FAST` for CPU backends.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        preset_Y_final: BM3D parameter preset for the luma final step.</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            If `None` (default), it&#39;s set to `BM3DPreset.LC` for GPU backends and `BM3DPreset.FAST` for CPU backends.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        sigma_chroma: Denoising strength for the chroma planes&#39; final step.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        radius_chroma: Temporal radius for chroma processing. If &gt; 0, V-BM3D is used.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        delta_sigma_chroma: Additional sigma added to `sigma_chroma` for the chroma planes&#39; basic step.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        preset_chroma_basic: BM3D parameter preset for the chroma basic step.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            If `None` (default), it&#39;s set to `BM3DPreset.LC` for GPU backends and `BM3DPreset.FAST` for CPU backends.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        preset_chroma_final: BM3D parameter preset for the chroma final step.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            If `None` (default), it&#39;s set to `BM3DPreset.LC` for GPU backends and `BM3DPreset.FAST` for CPU backends.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        ref: Ref for final BM3D step. If provided, basic step is bypassed.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        opp_matrix: OPP transform type to use.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        fast: Multi-threaded copy between CPU and GPU at the expense of 4x memory consumption.</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        Denoised video clip in YUV420P16 format.</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        ValueError: If the input clip format is not YUV420P16.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        ValueError: If any provided preset name is invalid.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        ValueError: If `fast` is set for non-gpu backend.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        - The `delta_sigma_xxx` value is added to `sigma_xxx` only for the &#39;basic&#39; denoising step. The &#39;final&#39; step uses `sigma_xxx` directly.</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">vs</span><span class="o">.</span><span class="n">YUV420P16</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Fast_BM3DWrapper: Input clip format must be YUV420P16.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">if</span> <span class="n">ref</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">if</span> <span class="n">ref</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="sa">f</span><span class="s2">&quot;Fast_BM3DWrapper: Input clip and ref must have the same format. Got </span><span class="si">{</span><span class="n">ref</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">matrix</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_video</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="n">bm3d_s</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">_bm3d</span><span class="p">:</span> <span class="n">Callable</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">if</span> <span class="n">bm3d</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">_bm3d</span><span class="p">,</span> <span class="n">bm3d_s</span> <span class="o">=</span> <span class="n">_get_bm3d_backend</span><span class="p">()</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="n">_bm3d</span> <span class="o">=</span> <span class="n">bm3d</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="n">bm3d_s</span> <span class="o">=</span> <span class="n">argname</span><span class="p">(</span><span class="s2">&quot;bm3d&quot;</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">except</span> <span class="n">ImproperUseError</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="n">bm3d_s</span> <span class="o">=</span> <span class="s2">&quot;bm3dcpu&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">is_gpu</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bm3d_s</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">default_preset</span> <span class="o">=</span> <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">LC</span> <span class="k">if</span> <span class="n">is_gpu</span> <span class="k">else</span> <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">FAST</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="n">preset_Y_basic</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">preset_Y_basic</span> <span class="o">=</span> <span class="n">default_preset</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">if</span> <span class="n">preset_Y_final</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">preset_Y_final</span> <span class="o">=</span> <span class="n">default_preset</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="k">if</span> <span class="n">preset_chroma_basic</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">preset_chroma_basic</span> <span class="o">=</span> <span class="n">default_preset</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">if</span> <span class="n">preset_chroma_final</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">preset_chroma_final</span> <span class="o">=</span> <span class="n">default_preset</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">to_opp</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">yuv2opp</span><span class="p">,</span> <span class="n">matrix_in</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span> <span class="n">opp_manager</span><span class="o">=</span><span class="n">opp_matrix</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">to_yuv</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">opp2yuv</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">target_matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">opp_manager</span><span class="o">=</span><span class="n">opp_matrix</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">to_opp</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="k">return</span> <span class="n">rgb2opp</span><span class="p">(</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span class="n">core</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">RGBS</span><span class="p">,</span> <span class="n">matrix_in</span><span class="o">=</span><span class="n">matrix</span><span class="p">),</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                <span class="n">opp_manager</span><span class="o">=</span><span class="n">opp_matrix</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">to_yuv</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="k">return</span> <span class="n">opp2rgb</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">opp_manager</span><span class="o">=</span><span class="n">opp_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Spline36</span><span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                <span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV444PS</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">for</span> <span class="n">preset</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">preset_Y_basic</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">preset_Y_final</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">preset_chroma_basic</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">preset_chroma_final</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="p">]:</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="k">if</span> <span class="n">preset</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">FAST</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">LC</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">NP</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">HIGH</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">MAGIC</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="p">]:</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fast_BM3DWrapper: Unknown preset </span><span class="si">{</span><span class="n">preset</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">if</span> <span class="s2">&quot;cpu&quot;</span> <span class="ow">in</span> <span class="n">bm3d_s</span><span class="p">:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="k">if</span> <span class="n">fast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="s2">&quot;Fast_BM3DWrapper: bm3dcpu does not support argument `fast`&quot;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="s2">&quot;y_basic&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vbasic&quot;</span> <span class="k">if</span> <span class="n">radius_Y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;basic&quot;</span><span class="p">][</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="n">preset_Y_basic</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="p">],</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="s2">&quot;y_final&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vfinal&quot;</span> <span class="k">if</span> <span class="n">radius_Y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;final&quot;</span><span class="p">][</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                <span class="n">preset_Y_final</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="p">],</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="s2">&quot;chroma_basic&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vbasic&quot;</span> <span class="k">if</span> <span class="n">radius_chroma</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;basic&quot;</span><span class="p">][</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                <span class="n">preset_chroma_basic</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="p">],</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="s2">&quot;chroma_final&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vfinal&quot;</span> <span class="k">if</span> <span class="n">radius_chroma</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;final&quot;</span><span class="p">][</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="n">preset_chroma_final</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>            <span class="p">],</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="p">}</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">if</span> <span class="n">fast</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="n">fast</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="s2">&quot;y_basic&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vbasic&quot;</span> <span class="k">if</span> <span class="n">radius_Y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;basic&quot;</span><span class="p">][</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                <span class="n">preset_Y_basic</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="p">]</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;fast&quot;</span><span class="p">:</span> <span class="n">fast</span><span class="p">},</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="s2">&quot;y_final&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vfinal&quot;</span> <span class="k">if</span> <span class="n">radius_Y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;final&quot;</span><span class="p">][</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                <span class="n">preset_Y_final</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="p">]</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;fast&quot;</span><span class="p">:</span> <span class="n">fast</span><span class="p">},</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="s2">&quot;chroma_basic&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vbasic&quot;</span> <span class="k">if</span> <span class="n">radius_chroma</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;basic&quot;</span><span class="p">][</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>                <span class="n">preset_chroma_basic</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="p">]</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>            <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;fast&quot;</span><span class="p">:</span> <span class="n">fast</span><span class="p">},</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>            <span class="s2">&quot;chroma_final&quot;</span><span class="p">:</span> <span class="n">bm3d_presets</span><span class="p">[</span><span class="s2">&quot;vfinal&quot;</span> <span class="k">if</span> <span class="n">radius_chroma</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;final&quot;</span><span class="p">][</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>                <span class="n">preset_chroma_final</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>            <span class="p">]</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>            <span class="o">|</span> <span class="p">{</span><span class="s2">&quot;fast&quot;</span><span class="p">:</span> <span class="n">fast</span><span class="p">},</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="p">}</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">half_width</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">half_height</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">srcY_float</span><span class="p">,</span> <span class="n">srcU_float</span><span class="p">,</span> <span class="n">srcV_float</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">vstools</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="k">if</span> <span class="n">ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">basic_y</span> <span class="o">=</span> <span class="n">_bm3d</span><span class="o">.</span><span class="n">BM3Dv2</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>            <span class="n">clip</span><span class="o">=</span><span class="n">srcY_float</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>            <span class="n">ref</span><span class="o">=</span><span class="n">srcY_float</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_Y</span> <span class="o">+</span> <span class="n">delta_sigma_Y</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>            <span class="n">radius</span><span class="o">=</span><span class="n">radius_Y</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="o">**</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;y_basic&quot;</span><span class="p">],</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">basic_y</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">vstools</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span><span class="n">ref</span><span class="p">),</span> <span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="n">final_y</span> <span class="o">=</span> <span class="n">_bm3d</span><span class="o">.</span><span class="n">BM3Dv2</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="n">clip</span><span class="o">=</span><span class="n">srcY_float</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">ref</span><span class="o">=</span><span class="n">basic_y</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_Y</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">radius</span><span class="o">=</span><span class="n">radius_Y</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="o">**</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;y_final&quot;</span><span class="p">],</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">vyhalf</span> <span class="o">=</span> <span class="n">final_y</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Spline36</span><span class="p">(</span><span class="n">half_width</span><span class="p">,</span> <span class="n">half_height</span><span class="p">,</span> <span class="n">src_left</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="n">srchalf_444</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">vyhalf</span><span class="p">,</span> <span class="n">srcU_float</span><span class="p">,</span> <span class="n">srcV_float</span><span class="p">])</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="n">srchalf_opp</span> <span class="o">=</span> <span class="n">to_opp</span><span class="p">(</span><span class="n">srchalf_444</span><span class="p">)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="k">if</span> <span class="n">ref</span><span class="p">:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="n">refhalf444</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vyhalf</span><span class="p">,</span> <span class="n">vstools</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">refhalf_opp</span> <span class="o">=</span> <span class="n">to_opp</span><span class="p">(</span><span class="n">refhalf444</span><span class="p">)</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">if</span> <span class="n">ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">basic_half</span> <span class="o">=</span> <span class="n">_bm3d</span><span class="o">.</span><span class="n">BM3Dv2</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">clip</span><span class="o">=</span><span class="n">srchalf_opp</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">ref</span><span class="o">=</span><span class="n">srchalf_opp</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_chroma</span> <span class="o">+</span> <span class="n">delta_sigma_chroma</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">chroma</span><span class="o">=</span><span class="n">chroma</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="n">radius</span><span class="o">=</span><span class="n">radius_chroma</span><span class="p">,</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">zero_init</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="o">**</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;chroma_basic&quot;</span><span class="p">],</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="n">basic_half</span> <span class="o">=</span> <span class="n">refhalf_opp</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">final_half</span> <span class="o">=</span> <span class="n">_bm3d</span><span class="o">.</span><span class="n">BM3Dv2</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">clip</span><span class="o">=</span><span class="n">srchalf_opp</span><span class="p">,</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>        <span class="n">ref</span><span class="o">=</span><span class="n">basic_half</span><span class="p">,</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>        <span class="n">sigma</span><span class="o">=</span><span class="n">sigma_chroma</span><span class="p">,</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="n">chroma</span><span class="o">=</span><span class="n">chroma</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="n">radius</span><span class="o">=</span><span class="n">radius_chroma</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="n">zero_init</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="o">**</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;chroma_final&quot;</span><span class="p">],</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">final_half</span> <span class="o">=</span> <span class="n">to_yuv</span><span class="p">(</span><span class="n">final_half</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">_</span><span class="p">,</span> <span class="n">final_u</span><span class="p">,</span> <span class="n">final_v</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">final_half</span><span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="n">vfinal</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">final_y</span><span class="p">,</span> <span class="n">final_u</span><span class="p">,</span> <span class="n">final_v</span><span class="p">])</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="k">return</span> <span class="n">vstools</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">vfinal</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.hybrid_denoise" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">hybrid_denoise</span>


<a href="#y5gfunc.expr.test_atan2.hybrid_denoise" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">hybrid_denoise</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(mc_degrain_prefilter)">mc_degrain_prefilter</span></span><span class="p">:</span> <span class="n"><span title="vsdenoise.prefilters.PrefilterPartial">PrefilterPartial</span></span> <span class="o">=</span> <span class="n"><span title="vsdenoise.Prefilter.DFTTEST">DFTTEST</span></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(mc_degrain_preset)">mc_degrain_preset</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vsdenoise.MVToolsPreset" href="https://sgt0.github.io/jet-docs/api/vsdenoise/mvtools/presets/#vsdenoise.mvtools.presets.MVToolsPreset">MVToolsPreset</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(mc_degrain_refine)">mc_degrain_refine</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(mc_degrain_thsad)">mc_degrain_thsad</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(show_ref)">show_ref</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(bm3d_sigma)">bm3d_sigma</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(bm3d_preset)">bm3d_preset</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            BM3DPreset (y5gfunc.filter.denoise.BM3DPreset)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset">BM3DPreset</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            FAST


  
      class-attribute
      instance-attribute
   (y5gfunc.filter.denoise.BM3DPreset.FAST)" href="../filter/denoise.html#y5gfunc.filter.denoise.BM3DPreset.FAST">FAST</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.hybrid_denoise(bm3d_opp_matrix)">bm3d_opp_matrix</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>mc_degrain + bm3d denoise</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/denoise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="nf">hybrid_denoise</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">mc_degrain_prefilter</span><span class="p">:</span> <span class="n">PrefilterPartial</span> <span class="o">=</span> <span class="n">Prefilter</span><span class="o">.</span><span class="n">DFTTEST</span><span class="p">(),</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">mc_degrain_preset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MVToolsPreset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">mc_degrain_refine</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">mc_degrain_thsad</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">show_ref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="n">bm3d_sigma</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>    <span class="n">bm3d_preset</span><span class="p">:</span> <span class="n">BM3DPreset</span> <span class="o">=</span> <span class="n">BM3DPreset</span><span class="o">.</span><span class="n">FAST</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="n">bm3d_opp_matrix</span><span class="p">:</span> <span class="n">ColorMatrixManager</span> <span class="o">=</span> <span class="n">default_opp</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]]:</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    mc_degrain + bm3d denoise</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">vs</span><span class="o">.</span><span class="n">YUV420P16</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;hybrid_denoise: Input clip format must be YUV420P16.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">1024</span> <span class="ow">and</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span> <span class="o">&lt;=</span> <span class="mi">576</span><span class="p">:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">block_size</span> <span class="o">=</span> <span class="mi">32</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="mi">16</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="k">elif</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">2048</span> <span class="ow">and</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span> <span class="o">&lt;=</span> <span class="mi">1536</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">block_size</span> <span class="o">=</span> <span class="mi">64</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="mi">32</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="n">block_size</span> <span class="o">=</span> <span class="mi">128</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">overlap</span> <span class="o">=</span> <span class="mi">64</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="k">if</span> <span class="n">mc_degrain_preset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">mc_degrain_preset</span> <span class="o">=</span> <span class="n">MVToolsPreset</span><span class="p">(</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="n">search_clip</span><span class="o">=</span><span class="n">prefilter_to_full_range</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="n">pel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="n">super_args</span><span class="o">=</span><span class="n">SuperArgs</span><span class="p">(</span><span class="n">sharp</span><span class="o">=</span><span class="n">SharpMode</span><span class="o">.</span><span class="n">WIENER</span><span class="p">,</span> <span class="n">rfilter</span><span class="o">=</span><span class="n">RFilterMode</span><span class="o">.</span><span class="n">TRIANGLE</span><span class="p">),</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="n">analyze_args</span><span class="o">=</span><span class="n">AnalyzeArgs</span><span class="p">(</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>                <span class="n">blksize</span><span class="o">=</span><span class="n">block_size</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>                <span class="n">overlap</span><span class="o">=</span><span class="n">overlap</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>                <span class="n">search</span><span class="o">=</span><span class="n">SearchMode</span><span class="o">.</span><span class="n">DIAMOND</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>                <span class="n">dct</span><span class="o">=</span><span class="n">SADMode</span><span class="o">.</span><span class="n">ADAPTIVE_SPATIAL_MIXED</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>                <span class="n">truemotion</span><span class="o">=</span><span class="n">MotionMode</span><span class="o">.</span><span class="n">SAD</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="n">pelsearch</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="p">),</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="n">recalculate_args</span><span class="o">=</span><span class="n">RecalculateArgs</span><span class="p">(</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="n">blksize</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">block_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                <span class="n">overlap</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">overlap</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="n">search</span><span class="o">=</span><span class="n">SearchMode</span><span class="o">.</span><span class="n">DIAMOND</span><span class="p">,</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="n">dct</span><span class="o">=</span><span class="n">SADMode</span><span class="o">.</span><span class="n">ADAPTIVE_SPATIAL_MIXED</span><span class="p">,</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="n">truemotion</span><span class="o">=</span><span class="n">MotionMode</span><span class="o">.</span><span class="n">SAD</span><span class="p">,</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                <span class="n">searchparam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="p">),</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="n">ref</span> <span class="o">=</span> <span class="n">mc_degrain</span><span class="p">(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>        <span class="n">clip</span><span class="o">=</span><span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="n">prefilter</span><span class="o">=</span><span class="n">mc_degrain_prefilter</span><span class="p">,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="n">preset</span><span class="o">=</span><span class="n">mc_degrain_preset</span><span class="p">,</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">thsad</span><span class="o">=</span><span class="n">mc_degrain_thsad</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">thsad_recalc</span><span class="o">=</span><span class="n">mc_degrain_thsad</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>        <span class="n">blksize</span><span class="o">=</span><span class="n">block_size</span><span class="p">,</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="n">refine</span><span class="o">=</span><span class="n">mc_degrain_refine</span><span class="p">,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="p">)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">bm3d</span> <span class="o">=</span> <span class="n">Fast_BM3DWrapper</span><span class="p">(</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">sigma_Y</span><span class="o">=</span><span class="n">bm3d_sigma</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>        <span class="n">sigma_chroma</span><span class="o">=</span><span class="n">bm3d_sigma</span><span class="p">,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="n">preset_Y_final</span><span class="o">=</span><span class="n">bm3d_preset</span><span class="p">,</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>        <span class="n">preset_chroma_final</span><span class="o">=</span><span class="n">bm3d_preset</span><span class="p">,</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>        <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="n">opp_matrix</span><span class="o">=</span><span class="n">bm3d_opp_matrix</span><span class="p">,</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">if</span> <span class="n">show_ref</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">return</span> <span class="n">bm3d</span><span class="p">,</span> <span class="n">ref</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">return</span> <span class="n">bm3d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.magic_denoise" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">magic_denoise</span>


<a href="#y5gfunc.expr.test_atan2.magic_denoise" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">magic_denoise</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.magic_denoise(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Uses dark magic to denoise heavy grain from videos.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/denoise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="k">def</span><span class="w"> </span><span class="nf">magic_denoise</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    Uses dark magic to denoise heavy grain from videos.</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="nb">super</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Super</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">hpad</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">vpad</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">rfilter</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="n">backward2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Analyse</span><span class="p">(</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="nb">super</span><span class="p">,</span> <span class="n">isb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="n">backward</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Analyse</span><span class="p">(</span><span class="nb">super</span><span class="p">,</span> <span class="n">isb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">forward</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Analyse</span><span class="p">(</span><span class="nb">super</span><span class="p">,</span> <span class="n">isb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">forward2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Analyse</span><span class="p">(</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="nb">super</span><span class="p">,</span> <span class="n">isb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">backward2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Recalculate</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="nb">super</span><span class="p">,</span> <span class="n">backward2</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">backward</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Recalculate</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="nb">super</span><span class="p">,</span> <span class="n">backward</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">forward</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Recalculate</span><span class="p">(</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="nb">super</span><span class="p">,</span> <span class="n">forward</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">forward2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Recalculate</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="nb">super</span><span class="p">,</span> <span class="n">forward2</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">divide</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dct</span><span class="o">=</span><span class="mi">6</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">backward_re2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Finest</span><span class="p">(</span><span class="n">backward2</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">backward_re</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Finest</span><span class="p">(</span><span class="n">backward</span><span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">forward_re</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Finest</span><span class="p">(</span><span class="n">forward</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">forward_re2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Finest</span><span class="p">(</span><span class="n">forward2</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">clip</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Degrain2</span><span class="p">(</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="nb">super</span><span class="p">,</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">backward_re</span><span class="p">,</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">forward_re</span><span class="p">,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">backward_re2</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">forward_re2</span><span class="p">,</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">thsad</span><span class="o">=</span><span class="mi">220</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">thscd1</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">return</span> <span class="n">DFTTest</span><span class="p">(</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">sloc</span><span class="o">=</span><span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.12</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)],</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="p">)</span><span class="o">.</span><span class="n">denoise</span><span class="p">(</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="n">pmax</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="n">pmin</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="n">ftype</span><span class="o">=</span><span class="n">FilterType</span><span class="o">.</span><span class="n">MULT_RANGE</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="n">tbsize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="n">ssystem</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.adaptive_denoise" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">adaptive_denoise</span>


<a href="#y5gfunc.expr.test_atan2.adaptive_denoise" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">adaptive_denoise</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.adaptive_denoise(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.adaptive_denoise(denoised)">denoised</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/denoise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="k">def</span><span class="w"> </span><span class="nf">adaptive_denoise</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">denoised</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">bilateral</span> <span class="o">=</span> <span class="n">vsrgtools</span><span class="o">.</span><span class="n">bilateral</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">denoised</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="n">amask</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">denoised</span><span class="p">,</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">remove_grain</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">]),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="n">amask</span> <span class="o">=</span> <span class="n">adg_mask</span><span class="p">(</span><span class="n">amask</span><span class="p">,</span> <span class="n">luma_scaling</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">degrain</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MaskedMerge</span><span class="p">(</span><span class="n">denoised</span><span class="p">,</span> <span class="n">bilateral</span><span class="p">,</span> <span class="n">amask</span><span class="p">,</span> <span class="n">first_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="n">clear_edge</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MaskedMerge</span><span class="p">(</span><span class="n">degrain</span><span class="p">,</span> <span class="n">denoised</span><span class="p">,</span> <span class="n">maximum</span><span class="p">(</span><span class="n">GammaMask</span><span class="p">(</span><span class="n">denoised</span><span class="p">)))</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="k">return</span> <span class="n">vstools</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">clear_edge</span><span class="p">,</span> <span class="n">denoised</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.TIVTC_VFR" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">TIVTC_VFR</span>


<a href="#y5gfunc.expr.test_atan2.TIVTC_VFR" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">TIVTC_VFR</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(source)">source</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(clip2)">clip2</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(tfmIn)">tfmIn</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;matches.txt&#39;</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(tdecIn)">tdecIn</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;metrics.txt&#39;</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(mkvOut)">mkvOut</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;timecodes.txt&#39;</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(tfm_args)">tfm_args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(tdecimate_args)">tdecimate_args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">(),</span> <span class="n"><span title="y5gfunc.expr.test_atan2.TIVTC_VFR(overwrite)">overwrite</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convenient wrapper on tivtc to perform automatic vfr decimation with one function.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/ivtc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">TIVTC_VFR</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">source</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">clip2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">tfmIn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;matches.txt&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">tdecIn</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;metrics.txt&quot;</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">mkvOut</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;timecodes.txt&quot;</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">tfm_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(),</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">tdecimate_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(),</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Convenient wrapper on tivtc to perform automatic vfr decimation with one function.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">analyze</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tfmIn</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">))</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tdecIn</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">))</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mkvOut</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">))</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">tfmIn</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">tfmIn</span><span class="p">)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">tdecIn</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">tdecIn</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">mkvOut</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">mkvOut</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">if</span> <span class="n">tfmIn</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">tdecIn</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">analyze</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">if</span> <span class="n">clip2</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">tfm_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">clip2</span><span class="o">=</span><span class="n">clip2</span><span class="p">))</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="k">if</span> <span class="n">analyze</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="n">tfmIn</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">tfmIn</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="n">tdecIn</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">tdecIn</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">mkvOut</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">mkvOut</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="n">tfm_pass1_args</span> <span class="o">=</span> <span class="n">tfm_args</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="n">tdecimate_pass1_args</span> <span class="o">=</span> <span class="n">tdecimate_args</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="n">tfm_pass1_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">tfmIn</span><span class="p">)))</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">tdecimate_pass1_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">tdecIn</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">tmpnode</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tivtc</span><span class="o">.</span><span class="n">TFM</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">tfm_pass1_args</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">tmpnode</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tivtc</span><span class="o">.</span><span class="n">TDecimate</span><span class="p">(</span><span class="n">tmpnode</span><span class="p">,</span> <span class="o">**</span><span class="n">tdecimate_pass1_args</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tmpnode</span><span class="o">.</span><span class="n">frames</span><span class="p">()):</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzing frame #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="k">del</span> <span class="n">tmpnode</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># let it write logs</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">tfm_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">tfmIn</span><span class="p">)))</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">tdecimate_args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="nb">input</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">tdecIn</span><span class="p">),</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">tfmIn</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">tfmIn</span><span class="p">),</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">mkvOut</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">mkvOut</span><span class="p">),</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="n">mode</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">hybrid</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>            <span class="n">vfrDec</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tivtc</span><span class="o">.</span><span class="n">TFM</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="o">**</span><span class="n">tfm_args</span><span class="p">)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tivtc</span><span class="o">.</span><span class="n">TDecimate</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">tdecimate_args</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.DBMask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">DBMask</span>


<a href="#y5gfunc.expr.test_atan2.DBMask" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">DBMask</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.DBMask(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Lolihouse's deband mask</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">DBMask</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lolihouse&#39;s deband mask&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">nrmasks</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">(</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>        <span class="n">clip</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Binarize</span><span class="p">(</span><span class="n">scale_mask</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">clip</span><span class="p">),</span> <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">nrmaskb</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">t_h</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">nrmaskg</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">t_h</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>    <span class="n">nrmask</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="p">[</span><span class="n">nrmaskg</span><span class="p">,</span> <span class="n">nrmaskb</span><span class="p">,</span> <span class="n">nrmasks</span><span class="p">,</span> <span class="n">clip</span><span class="p">],</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>        <span class="p">[</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>            <span class="sa">f</span><span class="s2">&quot;a </span><span class="si">{</span><span class="n">scale_mask</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> &lt; </span><span class="si">{</span><span class="n">get_peak_value_full</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> a </span><span class="si">{</span><span class="n">scale_mask</span><span class="p">(</span><span class="mi">48</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> &lt; x </span><span class="si">{</span><span class="n">scale_mask</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> * a </span><span class="si">{</span><span class="n">scale_mask</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> &lt; y </span><span class="si">{</span><span class="n">scale_mask</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="n">clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> * z ? ? ?&quot;</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>            <span class="s2">&quot;&quot;</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="p">],</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">nrmask</span> <span class="o">=</span> <span class="n">minimum</span><span class="p">(</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">nrmask</span><span class="p">,</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">maximum</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">nrmask</span> <span class="o">=</span> <span class="n">remove_grain</span><span class="p">(</span><span class="n">nrmask</span><span class="p">,</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">nrmask</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">nrmask</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="p">)</span>  <span class="c1"># first_plane=True in [LoliHouse] Anime_WebSource_deband_1080P_10bit_adcance.vpy: L33</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">return</span> <span class="n">nrmask</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.AnimeMask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">AnimeMask</span>


<a href="#y5gfunc.expr.test_atan2.AnimeMask" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">AnimeMask</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.AnimeMask(clip))" href="#y5gfunc.expr.test_atan2.AnimeMask(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="shift (y5gfunc.expr.test_atan2.AnimeMask(shift))" href="#y5gfunc.expr.test_atan2.AnimeMask(shift)">shift</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="mode (y5gfunc.expr.test_atan2.AnimeMask(mode))" href="#y5gfunc.expr.test_atan2.AnimeMask(mode)">mode</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates edge/ringing mask for anime based on gradient operator.</p>
<p>For Anime's ringing mask, it's recommended to set "shift" between 0.5 and 1.0.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.AnimeMask(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.AnimeMask(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source clip. Only the First plane will be processed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.AnimeMask(shift)" class="doc doc-heading doc-heading-parameter">                  <code>shift</code>
<a href="#y5gfunc.expr.test_atan2.AnimeMask(shift)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(float, -1.5 ~ 1.5) The distance of translation. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.AnimeMask(mode)" class="doc doc-heading doc-heading-parameter">                  <code>mode</code>
<a href="#y5gfunc.expr.test_atan2.AnimeMask(mode)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>(-1 or 1) Type of the kernel, which simply inverts the pixel values and "shift".
Typically, -1 is for edge, 1 is for ringing. Default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated mask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If mode(-1 or 1) is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="k">def</span><span class="w"> </span><span class="nf">AnimeMask</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Generates edge/ringing mask for anime based on gradient operator.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    For Anime&#39;s ringing mask, it&#39;s recommended to set &quot;shift&quot; between 0.5 and 1.0.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        clip: Source clip. Only the First plane will be processed.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        shift: (float, -1.5 ~ 1.5) The distance of translation. Default is 0.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        mode: (-1 or 1) Type of the kernel, which simply inverts the pixel values and &quot;shift&quot;.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            Typically, -1 is for edge, 1 is for ringing. Default is 1.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        Generated mask.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        ValueError: If mode(-1 or 1) is invalid.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">color_family</span> <span class="o">!=</span> <span class="n">vs</span><span class="o">.</span><span class="n">GRAY</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">clip</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AnimeMask: &#39;mode&#39; have not a correct value! [-1 or 1]&quot;</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="n">clip</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Invert</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">shift</span> <span class="o">=</span> <span class="o">-</span><span class="n">shift</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">mask1</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">src_left</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span> <span class="n">src_top</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span> <span class="n">range_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">range_in_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">mask2</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">src_left</span><span class="o">=-</span><span class="n">shift</span><span class="p">,</span> <span class="n">src_top</span><span class="o">=-</span><span class="n">shift</span><span class="p">,</span> <span class="n">range_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">range_in_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">mask3</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">src_left</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span> <span class="n">src_top</span><span class="o">=-</span><span class="n">shift</span><span class="p">,</span> <span class="n">range_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">range_in_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">mask4</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">src_left</span><span class="o">=-</span><span class="n">shift</span><span class="p">,</span> <span class="n">src_top</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span> <span class="n">range_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">range_in_s</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">calc_expr</span> <span class="o">=</span> <span class="s2">&quot;src0 2 ** src01 2 ** + src2 2 ** + src3 2 ** + sqrt &quot;</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">mask1</span><span class="p">,</span> <span class="n">mask2</span><span class="p">,</span> <span class="n">mask3</span><span class="p">,</span> <span class="n">mask4</span><span class="p">],</span> <span class="p">[</span><span class="n">calc_expr</span><span class="p">])</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">return</span> <span class="n">mask</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.get_oped_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_oped_mask</span>


<a href="#y5gfunc.expr.test_atan2.get_oped_mask" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_oped_mask</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.get_oped_mask(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.get_oped_mask(ncop)">ncop</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.get_oped_mask(nced)">nced</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.get_oped_mask(op_start)">op_start</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.get_oped_mask(ed_start)">ed_start</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.get_oped_mask(threshold)">threshold</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_oped_mask</span><span class="p">(</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">ncop</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="n">nced</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">op_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="n">ed_start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">ncop</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="n">nced</span><span class="o">.</span><span class="n">format</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">color_family</span> <span class="o">==</span> <span class="n">vs</span><span class="o">.</span><span class="n">YUV</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">op_end</span> <span class="o">=</span> <span class="n">op_start</span> <span class="o">+</span> <span class="n">ncop</span><span class="o">.</span><span class="n">num_frames</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">ed_end</span> <span class="o">=</span> <span class="n">ed_start</span> <span class="o">+</span> <span class="n">nced</span><span class="o">.</span><span class="n">num_frames</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">op_start</span> <span class="o">&lt;=</span> <span class="n">op_end</span> <span class="o">&lt;</span> <span class="n">ed_start</span> <span class="o">&lt;=</span> <span class="n">ed_end</span> <span class="o">&lt;</span> <span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">if</span> <span class="n">op_start</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">ncop</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="n">op_start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="o">+</span> <span class="n">ncop</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="o">+</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="n">op_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">ncop</span> <span class="o">=</span> <span class="n">ncop</span> <span class="o">+</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="n">op_end</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">ed_end</span> <span class="o">!=</span> <span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="n">nced</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="n">ed_start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="o">+</span> <span class="n">nced</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="o">+</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="n">ed_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="p">)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">nced</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="n">ed_start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">nced</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">nc</span> <span class="o">=</span> <span class="n">replace_ranges</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">ncop</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">op_start</span><span class="p">,</span> <span class="n">op_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">nc</span> <span class="o">=</span> <span class="n">replace_ranges</span><span class="p">(</span><span class="n">nc</span><span class="p">,</span> <span class="n">nced</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">ed_start</span><span class="p">,</span> <span class="n">ed_end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">thr</span> <span class="o">=</span> <span class="n">scale_mask</span><span class="p">(</span><span class="n">threshold</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="nb">max</span> <span class="o">=</span> <span class="n">get_peak_value_full</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">diff</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">nc</span><span class="p">,</span> <span class="n">clip</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;x y - abs </span><span class="si">{</span><span class="n">thr</span><span class="si">}</span><span class="s2"> &lt; 0 </span><span class="si">{</span><span class="nb">max</span><span class="si">}</span><span class="s2"> ?&quot;</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>    <span class="n">diff</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">diff</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">maximum</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="n">diff</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">minimum</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">return</span> <span class="n">nc</span><span class="p">,</span> <span class="n">diff</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.kirsch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">kirsch</span>


<a href="#y5gfunc.expr.test_atan2.kirsch" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">kirsch</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.kirsch(src)">src</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="k">def</span><span class="w"> </span><span class="nf">kirsch</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="n">kirsch1</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="n">kirsch2</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="n">kirsch3</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="n">kirsch4</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">kirsch1</span><span class="p">,</span> <span class="n">kirsch2</span><span class="p">,</span> <span class="n">kirsch3</span><span class="p">,</span> <span class="n">kirsch4</span><span class="p">],</span> <span class="s2">&quot;x y max z max a max&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.prewitt" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">prewitt</span>


<a href="#y5gfunc.expr.test_atan2.prewitt" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">prewitt</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.prewitt(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.prewitt(mthr)">mthr</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="k">def</span><span class="w"> </span><span class="nf">prewitt</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">mthr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">24</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">mthr</span> <span class="o">=</span> <span class="n">scale_mask</span><span class="p">(</span><span class="n">mthr</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">prewitt1</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="n">prewitt2</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="p">)</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">prewitt3</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">prewitt4</span> <span class="o">=</span> <span class="n">convolution</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">clip</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">divisor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">saturate</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">prewitt</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="p">[</span><span class="n">prewitt1</span><span class="p">,</span> <span class="n">prewitt2</span><span class="p">,</span> <span class="n">prewitt3</span><span class="p">,</span> <span class="n">prewitt4</span><span class="p">],</span> <span class="s2">&quot;x y max z max a max&quot;</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">prewitt</span> <span class="o">=</span> <span class="n">inflate</span><span class="p">(</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">remove_grain</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">prewitt</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;x </span><span class="si">{</span><span class="n">mthr</span><span class="si">}</span><span class="s2"> &lt;= x 2 / x 1.4 pow ?&quot;</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">return</span> <span class="n">prewitt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.retinex_edgemask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">retinex_edgemask</span>


<a href="#y5gfunc.expr.test_atan2.retinex_edgemask" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">retinex_edgemask</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.retinex_edgemask(src)">src</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="k">def</span><span class="w"> </span><span class="nf">retinex_edgemask</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">luma</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">max_value</span> <span class="o">=</span> <span class="n">get_peak_value_full</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">retinex</span><span class="p">(</span><span class="n">luma</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">350</span><span class="p">],</span> <span class="n">upper_thr</span><span class="o">=</span><span class="mf">0.005</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">tcanny</span> <span class="o">=</span> <span class="n">minimum</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">ret</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">kirsch</span><span class="p">(</span><span class="n">luma</span><span class="p">),</span> <span class="n">tcanny</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;x y + </span><span class="si">{</span><span class="n">max_value</span><span class="si">}</span><span class="s2"> min&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.comb_mask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">comb_mask</span>


<a href="#y5gfunc.expr.test_atan2.comb_mask" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">comb_mask</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.comb_mask(clip))" href="#y5gfunc.expr.test_atan2.comb_mask(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="cthresh (y5gfunc.expr.test_atan2.comb_mask(cthresh))" href="#y5gfunc.expr.test_atan2.comb_mask(cthresh)">cthresh</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="mthresh (y5gfunc.expr.test_atan2.comb_mask(mthresh))" href="#y5gfunc.expr.test_atan2.comb_mask(mthresh)">mthresh</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="expand (y5gfunc.expr.test_atan2.comb_mask(expand))" href="#y5gfunc.expr.test_atan2.comb_mask(expand)">expand</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="metric (y5gfunc.expr.test_atan2.comb_mask(metric))" href="#y5gfunc.expr.test_atan2.comb_mask(metric)">metric</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="planes (y5gfunc.expr.test_atan2.comb_mask(planes))" href="#y5gfunc.expr.test_atan2.comb_mask(planes)">planes</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Comb mask from TIVTC/TFM plugin.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.comb_mask(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.comb_mask(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input clip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.comb_mask(cthresh)" class="doc doc-heading doc-heading-parameter">                  <code>cthresh</code>
<a href="#y5gfunc.expr.test_atan2.comb_mask(cthresh)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spatial combing threshold.</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.comb_mask(mthresh)" class="doc doc-heading doc-heading-parameter">                  <code>mthresh</code>
<a href="#y5gfunc.expr.test_atan2.comb_mask(mthresh)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Motion adaptive threshold.</p>
              </div>
            </td>
            <td>
                  <code>9</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.comb_mask(expand)" class="doc doc-heading doc-heading-parameter">                  <code>expand</code>
<a href="#y5gfunc.expr.test_atan2.comb_mask(expand)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Assume left and right pixels of combed pixel as combed too.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.comb_mask(metric)" class="doc doc-heading doc-heading-parameter">                  <code>metric</code>
<a href="#y5gfunc.expr.test_atan2.comb_mask(metric)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets which spatial combing metric is used to detect combed pixels.
- Metric 0 is what TFM used previous to v0.9.12.0.
- Metric 1 is from Donald Graft's decomb.dll.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.comb_mask(planes)" class="doc doc-heading doc-heading-parameter">                  <code>planes</code>
<a href="#y5gfunc.expr.test_atan2.comb_mask(planes)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Planes to process.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="k">def</span><span class="w"> </span><span class="nf">comb_mask</span><span class="p">(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">cthresh</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">mthresh</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">expand</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">metric</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">planes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">    Comb mask from TIVTC/TFM plugin.</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a><span class="sd">        clip: Input clip.</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        cthresh: Spatial combing threshold.</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        mthresh: Motion adaptive threshold.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        expand: Assume left and right pixels of combed pixel as combed too.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        metric: Sets which spatial combing metric is used to detect combed pixels.</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            - Metric 0 is what TFM used previous to v0.9.12.0.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            - Metric 1 is from Donald Graft&#39;s decomb.dll.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        planes: Planes to process.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">cth_max</span> <span class="o">=</span> <span class="mi">65025</span> <span class="k">if</span> <span class="n">metric</span> <span class="k">else</span> <span class="mi">255</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">cthresh</span> <span class="o">&gt;</span> <span class="n">cth_max</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cthresh</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="sa">f</span><span class="s2">&quot;comb_mask: cthresh must be between 0 and </span><span class="si">{</span><span class="n">cth_max</span><span class="si">}</span><span class="s2"> when metric = </span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">.&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">mthresh</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mthresh</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;comb_mask: mthresh must be between 0 and 255.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">if</span> <span class="n">planes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">))</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="p">[</span><span class="n">planes</span><span class="p">]</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">peak</span> <span class="o">=</span> <span class="n">get_peak_value</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="n">ex_m0</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="sa">f</span><span class="s2">&quot;x[0,-2] a! x[0,-1] b! x c! x[0,1] d! x[0,2] e! &quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="sa">f</span><span class="s2">&quot;c@ b@ - d1! c@ d@ - d2! &quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="sa">f</span><span class="s2">&quot;c@ 4 * a@ + e@ + b@ d@ + 3 * - abs fd! &quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="sa">f</span><span class="s2">&quot;d1@ </span><span class="si">{</span><span class="n">cthresh</span><span class="si">}</span><span class="s2"> &gt; d2@ </span><span class="si">{</span><span class="n">cthresh</span><span class="si">}</span><span class="s2"> &gt; and &quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="sa">f</span><span class="s2">&quot;d1@ -</span><span class="si">{</span><span class="n">cthresh</span><span class="si">}</span><span class="s2"> &lt; d2@ -</span><span class="si">{</span><span class="n">cthresh</span><span class="si">}</span><span class="s2"> &lt; and or &quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="sa">f</span><span class="s2">&quot;fd@ </span><span class="si">{</span><span class="n">cthresh</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">6</span><span class="si">}</span><span class="s2"> &gt; and </span><span class="si">{</span><span class="n">peak</span><span class="si">}</span><span class="s2"> 0 ?&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="p">]</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">ex_m1</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x[0,-1] x - x[0,1] x - * </span><span class="si">{</span><span class="n">cthresh</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">peak</span><span class="si">}</span><span class="s2"> 0 ?&quot;</span><span class="p">]</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">ex_motion</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;x y - abs </span><span class="si">{</span><span class="n">mthresh</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">peak</span><span class="si">}</span><span class="s2"> 0 ?&quot;</span><span class="p">]</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">ex_spatial</span> <span class="o">=</span> <span class="n">ex_m1</span> <span class="k">if</span> <span class="n">metric</span> <span class="k">else</span> <span class="n">ex_m0</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="n">plane_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="n">spatial_expr</span> <span class="o">=</span> <span class="p">[</span><span class="n">ex_spatial</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">planes</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plane_range</span><span class="p">]</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">spatial_mask</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">spatial_expr</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="k">if</span> <span class="n">mthresh</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">spatial_mask</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">expand</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="k">else</span> <span class="n">maximum</span><span class="p">(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                <span class="n">spatial_mask</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="n">planes</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">motion_expr</span> <span class="o">=</span> <span class="p">[</span><span class="n">ex_motion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">planes</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plane_range</span><span class="p">]</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="n">motion_mask</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">clip</span><span class="p">,</span> <span class="n">clip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">clip</span><span class="p">],</span> <span class="n">motion_expr</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>    <span class="n">motion_mask</span> <span class="o">=</span> <span class="n">maximum</span><span class="p">(</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">motion_mask</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="n">planes</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">comb_mask</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">spatial_mask</span><span class="p">,</span> <span class="n">motion_mask</span><span class="p">],</span> <span class="s2">&quot;x y min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">comb_mask</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">expand</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">else</span> <span class="n">maximum</span><span class="p">(</span><span class="n">comb_mask</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="n">planes</span><span class="p">,</span> <span class="n">coordinates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.Gammarize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">Gammarize</span>


<a href="#y5gfunc.expr.test_atan2.Gammarize" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Gammarize</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.Gammarize(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Gammarize(gamma)">gamma</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Gammarize(tvrange)">tvrange</span></span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="k">def</span><span class="w"> </span><span class="nf">Gammarize</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">tvrange</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;YUV&quot;</span><span class="p">):</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="n">is_yuv</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">get_y</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="k">elif</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Gray&quot;</span><span class="p">):</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">is_yuv</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">clip</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Gammarize: Input clip must be either YUV or GRAY.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="nb">range</span> <span class="o">=</span> <span class="n">ColorRange</span><span class="o">.</span><span class="n">LIMITED</span> <span class="k">if</span> <span class="n">tvrange</span> <span class="k">else</span> <span class="n">ColorRange</span><span class="o">.</span><span class="n">FULL</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="n">thrl</span> <span class="o">=</span> <span class="n">get_lowest_value</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">range_in</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="n">thrh</span> <span class="o">=</span> <span class="n">get_peak_value</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">range_in</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="n">rng</span> <span class="o">=</span> <span class="n">scale_mask</span><span class="p">(</span><span class="mi">219</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span> <span class="k">if</span> <span class="n">tvrange</span> <span class="k">else</span> <span class="n">scale_mask</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="n">corrected</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="sa">f</span><span class="s2">&quot;x </span><span class="si">{</span><span class="n">rng</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">gamma</span><span class="si">}</span><span class="s2"> pow </span><span class="si">{</span><span class="n">rng</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">thrl</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">thrl</span><span class="si">}</span><span class="s2"> max </span><span class="si">{</span><span class="n">thrh</span><span class="si">}</span><span class="s2"> min&quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="k">return</span> <span class="n">join</span><span class="p">(</span><span class="n">corrected</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_yuv</span> <span class="k">else</span> <span class="n">corrected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.GammaMask" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">GammaMask</span>


<a href="#y5gfunc.expr.test_atan2.GammaMask" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">GammaMask</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.GammaMask(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.GammaMask(gamma)">gamma</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/mask.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="k">def</span><span class="w"> </span><span class="nf">GammaMask</span><span class="p">(</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">gammarized</span> <span class="o">=</span> <span class="n">Gammarize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">_d_mask</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">(</span><span class="n">gammarized</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sigma_v</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">t_h</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">_b_mask</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sigma_v</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">t_h</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">op</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">return</span> <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">minimum</span><span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">vstools</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">_b_mask</span><span class="p">,</span> <span class="n">_d_mask</span><span class="p">],</span> <span class="s2">&quot;x y max&quot;</span><span class="p">),</span> <span class="n">maximum</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="p">),</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">inflate</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.descale_cropping_args" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">descale_cropping_args</span>


<a href="#y5gfunc.expr.test_atan2.descale_cropping_args" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">descale_cropping_args</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(src_height)">src_height</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(base_height)">base_height</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(base_width)">base_width</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(crop_top)">crop_top</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(crop_bottom)">crop_bottom</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(crop_left)">crop_left</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(crop_right)">crop_right</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.descale_cropping_args(mode)">mode</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            DescaleMode (y5gfunc.filter.rescale.DescaleMode)" href="../filter/rescale.html#y5gfunc.filter.rescale.DescaleMode">DescaleMode</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            WH


  
      class-attribute
      instance-attribute
   (y5gfunc.filter.rescale.DescaleMode.WH)" href="../filter/rescale.html#y5gfunc.filter.rescale.DescaleMode.WH">WH</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/rescale.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">descale_cropping_args</span><span class="p">(</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">src_height</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">base_height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="n">base_width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">crop_top</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">crop_bottom</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">crop_left</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">crop_right</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">mode</span><span class="p">:</span> <span class="n">DescaleMode</span> <span class="o">=</span> <span class="n">DescaleMode</span><span class="o">.</span><span class="n">WH</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">effective_src_h</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">crop_top</span> <span class="o">+</span> <span class="n">crop_bottom</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">if</span> <span class="n">effective_src_h</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="s2">&quot;descale_cropping_args: Effective source height (clip.height + crop_top + crop_bottom) must be positive.&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">ratio</span> <span class="o">=</span> <span class="n">src_height</span> <span class="o">/</span> <span class="n">effective_src_h</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">effective_src_w</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">crop_left</span> <span class="o">+</span> <span class="n">crop_right</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">if</span> <span class="n">effective_src_w</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>            <span class="s2">&quot;descale_cropping_args: Effective source width (clip.width + crop_left + crop_right) must be positive.&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">src_width</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">effective_src_w</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">cropped_src_width</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">clip</span><span class="o">.</span><span class="n">width</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">cropped_src_height</span> <span class="o">=</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">clip</span><span class="o">.</span><span class="n">height</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">margin_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_width</span> <span class="o">-</span> <span class="n">src_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">crop_left</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">margin_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_width</span> <span class="o">-</span> <span class="n">src_width</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">crop_right</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">margin_top</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_height</span> <span class="o">-</span> <span class="n">src_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">crop_top</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">margin_bottom</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_height</span> <span class="o">-</span> <span class="n">src_height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">ratio</span> <span class="o">*</span> <span class="n">crop_bottom</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">cropped_width</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">base_width</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">margin_left</span><span class="p">)</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">margin_right</span><span class="p">))</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">cropped_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">base_height</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">margin_top</span><span class="p">)</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">margin_bottom</span><span class="p">))</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">cropped_src_left</span> <span class="o">=</span> <span class="n">margin_left</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">margin_left</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">cropped_src_top</span> <span class="o">=</span> <span class="n">margin_top</span> <span class="o">-</span> <span class="n">floor</span><span class="p">(</span><span class="n">margin_top</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">args_w</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">width</span><span class="o">=</span><span class="n">cropped_width</span><span class="p">,</span> <span class="n">src_width</span><span class="o">=</span><span class="n">cropped_src_width</span><span class="p">,</span> <span class="n">src_left</span><span class="o">=</span><span class="n">cropped_src_left</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">args_h</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">height</span><span class="o">=</span><span class="n">cropped_height</span><span class="p">,</span> <span class="n">src_height</span><span class="o">=</span><span class="n">cropped_src_height</span><span class="p">,</span> <span class="n">src_top</span><span class="o">=</span><span class="n">cropped_src_top</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">DescaleMode</span><span class="o">.</span><span class="n">WH</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args_w</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args_h</span><span class="p">)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">DescaleMode</span><span class="o">.</span><span class="n">HW</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args_h</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args_w</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">DescaleMode</span><span class="o">.</span><span class="n">W</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args_w</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">DescaleMode</span><span class="o">.</span><span class="n">H</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">args</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args_h</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="k">return</span> <span class="n">args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.Descale" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">Descale</span>


<a href="#y5gfunc.expr.test_atan2.Descale" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">Descale</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.Descale(src)">src</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(width)">width</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(height)">height</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(kernel)">kernel</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(custom_kernel)">custom_kernel</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(taps)">taps</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(b)">b</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(c)">c</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(blur)">blur</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(post_conv)">post_conv</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(src_left)">src_left</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(src_top)">src_top</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(src_width)">src_width</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(src_height)">src_height</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(border_handling)">border_handling</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(ignore_mask)">ignore_mask</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(force)">force</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(force_h)">force_h</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(force_v)">force_v</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.Descale(opt)">opt</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="k">def</span><span class="w"> </span><span class="nf">Descale</span><span class="p">(</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="n">src</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="n">kernel</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="n">custom_kernel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="n">taps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="n">c</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">blur</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="n">post_conv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="n">src_left</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">src_top</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="n">src_width</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="n">src_height</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">border_handling</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">ignore_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="n">force_h</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="n">force_v</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>    <span class="n">opt</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_resize_name</span><span class="p">(</span><span class="n">kernel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="k">if</span> <span class="n">kernel_name</span> <span class="o">==</span> <span class="s2">&quot;Decustom&quot;</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="k">return</span> <span class="s2">&quot;ScaleCustom&quot;</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="k">if</span> <span class="n">kernel_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;De&quot;</span><span class="p">):</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>            <span class="k">return</span> <span class="n">kernel_name</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>        <span class="k">return</span> <span class="n">kernel_name</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_get_descaler_name</span><span class="p">(</span><span class="n">kernel_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>        <span class="k">if</span> <span class="n">kernel_name</span> <span class="o">==</span> <span class="s2">&quot;ScaleCustom&quot;</span><span class="p">:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>            <span class="k">return</span> <span class="s2">&quot;Decustom&quot;</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="k">if</span> <span class="n">kernel_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;De&quot;</span><span class="p">):</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="k">return</span> <span class="n">kernel_name</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="k">return</span> <span class="s2">&quot;De&quot;</span> <span class="o">+</span> <span class="n">kernel_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">kernel_name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>    <span class="k">assert</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>    <span class="k">assert</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="ow">and</span> <span class="n">src</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">vs</span><span class="o">.</span><span class="n">GRAYS</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>    <span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>    <span class="k">if</span> <span class="n">src_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>        <span class="n">src_width</span> <span class="o">=</span> <span class="n">width</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">if</span> <span class="n">src_height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">src_height</span> <span class="o">=</span> <span class="n">height</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>    <span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">width</span> <span class="ow">or</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="n">src</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">kernel</span> <span class="o">=</span> <span class="n">_get_resize_name</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">kernel</span> <span class="o">=</span> <span class="n">_get_descaler_name</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>    <span class="n">descaler</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">descale</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>    <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">descaler</span><span class="p">)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>    <span class="n">extra_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>    <span class="k">if</span> <span class="n">_get_descaler_name</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Debicubic&quot;</span><span class="p">:</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">extra_params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="s2">&quot;dparams&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="n">c</span><span class="p">},</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="p">}</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="k">elif</span> <span class="n">_get_descaler_name</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Delanczos&quot;</span><span class="p">:</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="n">extra_params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="s2">&quot;dparams&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;taps&quot;</span><span class="p">:</span> <span class="n">taps</span><span class="p">},</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="p">}</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>    <span class="k">elif</span> <span class="n">_get_descaler_name</span><span class="p">(</span><span class="n">kernel</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Decustom&quot;</span><span class="p">:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="k">assert</span> <span class="nb">callable</span><span class="p">(</span><span class="n">custom_kernel</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">extra_params</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="s2">&quot;dparams&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;custom_kernel&quot;</span><span class="p">:</span> <span class="n">custom_kernel</span><span class="p">},</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="p">}</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">descaled</span> <span class="o">=</span> <span class="n">descaler</span><span class="p">(</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="n">src</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="n">blur</span><span class="o">=</span><span class="n">blur</span><span class="p">,</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">post_conv</span><span class="o">=</span><span class="n">post_conv</span><span class="p">,</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="n">src_left</span><span class="o">=</span><span class="n">src_left</span><span class="p">,</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">src_top</span><span class="o">=</span><span class="n">src_top</span><span class="p">,</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="n">src_width</span><span class="o">=</span><span class="n">src_width</span><span class="p">,</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="n">src_height</span><span class="o">=</span><span class="n">src_height</span><span class="p">,</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="n">border_handling</span><span class="o">=</span><span class="n">border_handling</span><span class="p">,</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="n">ignore_mask</span><span class="o">=</span><span class="n">ignore_mask</span><span class="p">,</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="n">force_h</span><span class="o">=</span><span class="n">force_h</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">force_v</span><span class="o">=</span><span class="n">force_v</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="o">**</span><span class="n">extra_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dparams&quot;</span><span class="p">,</span> <span class="p">{}),</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="p">)</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">descaled</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="k">return</span> <span class="n">descaled</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.register_opp_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">register_opp_matrix</span>


<a href="#y5gfunc.expr.test_atan2.register_opp_matrix" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">register_opp_matrix</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="name (y5gfunc.expr.test_atan2.register_opp_matrix(name))" href="#y5gfunc.expr.test_atan2.register_opp_matrix(name)">name</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rgb_opp_matrix (y5gfunc.expr.test_atan2.register_opp_matrix(rgb_opp_matrix))" href="#y5gfunc.expr.test_atan2.register_opp_matrix(rgb_opp_matrix)">rgb_opp_matrix</a></span><span class="p">:</span> <span class="n"><span title="sympy.Matrix">Matrix</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Register a new OPP matrix variant and create its manager.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.register_opp_matrix(name)" class="doc doc-heading doc-heading-parameter">                  <code>name</code>
<a href="#y5gfunc.expr.test_atan2.register_opp_matrix(name)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name identifier for this OPP variant</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.register_opp_matrix(rgb_opp_matrix)" class="doc doc-heading doc-heading-parameter">                  <code>rgb_opp_matrix</code>
<a href="#y5gfunc.expr.test_atan2.register_opp_matrix(rgb_opp_matrix)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="sympy.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 3x3 RGB to OPP conversion matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The created ColorMatrixManager instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_opp_matrix</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rgb_opp_matrix</span><span class="p">:</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ColorMatrixManager</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    Register a new OPP matrix variant and create its manager.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        name: Name identifier for this OPP variant</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        rgb_opp_matrix: The 3x3 RGB to OPP conversion matrix</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        The created ColorMatrixManager instance</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">_opp_managers</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OPP matrix variant &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; already registered&quot;</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">manager</span> <span class="o">=</span> <span class="n">ColorMatrixManager</span><span class="p">(</span><span class="n">rgb_opp_matrix</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">_register_standard_matrices</span><span class="p">(</span><span class="n">manager</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">_opp_managers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">manager</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">return</span> <span class="n">manager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.yuv2opp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">yuv2opp</span>


<a href="#y5gfunc.expr.test_atan2.yuv2opp" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">yuv2opp</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.yuv2opp(clip))" href="#y5gfunc.expr.test_atan2.yuv2opp(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="matrix_in (y5gfunc.expr.test_atan2.yuv2opp(matrix_in))" href="#y5gfunc.expr.test_atan2.yuv2opp(matrix_in)">matrix_in</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="range_in (y5gfunc.expr.test_atan2.yuv2opp(range_in))" href="#y5gfunc.expr.test_atan2.yuv2opp(range_in)">range_in</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.ColorRange" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.ColorRange">ColorRange</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="opp_manager (y5gfunc.expr.test_atan2.yuv2opp(opp_manager))" href="#y5gfunc.expr.test_atan2.yuv2opp(opp_manager)">opp_manager</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert YUV to OPP color space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.yuv2opp(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.yuv2opp(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input YUV clip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.yuv2opp(matrix_in)" class="doc doc-heading doc-heading-parameter">                  <code>matrix_in</code>
<a href="#y5gfunc.expr.test_atan2.yuv2opp(matrix_in)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source matrix override, if None, read from clip properties</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.yuv2opp(range_in)" class="doc doc-heading doc-heading-parameter">                  <code>range_in</code>
<a href="#y5gfunc.expr.test_atan2.yuv2opp(range_in)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="vstools.ColorRange" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.ColorRange">ColorRange</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source range override, if None, read from clip properties</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.yuv2opp(opp_manager)" class="doc doc-heading doc-heading-parameter">                  <code>opp_manager</code>
<a href="#y5gfunc.expr.test_atan2.yuv2opp(opp_manager)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ColorMatrixManager for the specific OPP variant to use</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clip in OPP color space with appropriate frame properties</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="k">def</span><span class="w"> </span><span class="nf">yuv2opp</span><span class="p">(</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">matrix_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">range_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ColorRange</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">opp_manager</span><span class="p">:</span> <span class="n">ColorMatrixManager</span> <span class="o">=</span> <span class="n">default_opp</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Convert YUV to OPP color space.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        clip: Input YUV clip</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        matrix_in: Source matrix override, if None, read from clip properties</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        range_in: Source range override, if None, read from clip properties</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        opp_manager: ColorMatrixManager for the specific OPP variant to use</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        Clip in OPP color space with appropriate frame properties</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>    <span class="k">if</span> <span class="n">matrix_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">matrix_in</span> <span class="o">=</span> <span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">from_video</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="k">if</span> <span class="n">range_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">range_in</span> <span class="o">=</span> <span class="n">ColorRange</span><span class="o">.</span><span class="n">from_video</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">opp_manager</span><span class="o">.</span><span class="n">get_yuv_to_opp_coefs</span><span class="p">(</span><span class="n">matrix_in</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">opp</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fmtc</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">clip</span><span class="p">,</span> <span class="n">fulls</span><span class="o">=</span><span class="ow">not</span> <span class="n">range_in</span><span class="p">,</span> <span class="n">fulld</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">col_fam</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="n">coef</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">return</span> <span class="n">opp</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">SetFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="n">_Matrix</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">MATRIX_UNSPECIFIED</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="n">BM3D_OPP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">BM3D_OPP_VARIANT</span><span class="o">=</span><span class="n">opp_manager</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">BM3D_OPP_SRC_RANGE</span><span class="o">=</span><span class="n">range_in</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">BM3D_OPP_SRC_MATRIX</span><span class="o">=</span><span class="n">matrix_in</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.opp2yuv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">opp2yuv</span>


<a href="#y5gfunc.expr.test_atan2.opp2yuv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">opp2yuv</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.opp2yuv(clip))" href="#y5gfunc.expr.test_atan2.opp2yuv(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="target_matrix (y5gfunc.expr.test_atan2.opp2yuv(target_matrix))" href="#y5gfunc.expr.test_atan2.opp2yuv(target_matrix)">target_matrix</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="target_range (y5gfunc.expr.test_atan2.opp2yuv(target_range))" href="#y5gfunc.expr.test_atan2.opp2yuv(target_range)">target_range</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.ColorRange" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.ColorRange">ColorRange</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="opp_manager (y5gfunc.expr.test_atan2.opp2yuv(opp_manager))" href="#y5gfunc.expr.test_atan2.opp2yuv(opp_manager)">opp_manager</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert OPP to YUV color space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.opp2yuv(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.opp2yuv(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input OPP clip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.opp2yuv(target_matrix)" class="doc doc-heading doc-heading-parameter">                  <code>target_matrix</code>
<a href="#y5gfunc.expr.test_atan2.opp2yuv(target_matrix)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target YUV color space, if None, read from clip properties</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.opp2yuv(target_range)" class="doc doc-heading doc-heading-parameter">                  <code>target_range</code>
<a href="#y5gfunc.expr.test_atan2.opp2yuv(target_range)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="vstools.ColorRange" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.ColorRange">ColorRange</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target range, if None, read from clip properties</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.opp2yuv(opp_manager)" class="doc doc-heading doc-heading-parameter">                  <code>opp_manager</code>
<a href="#y5gfunc.expr.test_atan2.opp2yuv(opp_manager)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ColorMatrixManager for the specific OPP variant, if None, read from clip properties</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clip in YUV color space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="k">def</span><span class="w"> </span><span class="nf">opp2yuv</span><span class="p">(</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="n">target_matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">target_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ColorRange</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">opp_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ColorMatrixManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Convert OPP to YUV color space.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        clip: Input OPP clip</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        target_matrix: Target YUV color space, if None, read from clip properties</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        target_range: Target range, if None, read from clip properties</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        opp_manager: ColorMatrixManager for the specific OPP variant, if None, read from clip properties</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        Clip in YUV color space</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">get_prop</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="p">),</span> <span class="s2">&quot;Input must be an OPP clip (BM3D_OPP=1)&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="k">if</span> <span class="n">opp_manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">variant_name</span> <span class="o">=</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_VARIANT&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">if</span> <span class="n">variant_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_opp_managers</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown OPP variant: </span><span class="si">{</span><span class="n">variant_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">opp_manager</span> <span class="o">=</span> <span class="n">_opp_managers</span><span class="p">[</span><span class="n">variant_name</span><span class="p">]</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">if</span> <span class="n">target_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">target_matrix</span> <span class="o">=</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_SRC_MATRIX&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">primaries</span> <span class="o">=</span> <span class="n">Primaries</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">target_matrix</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">transfer</span> <span class="o">=</span> <span class="n">Transfer</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">target_matrix</span><span class="p">)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="k">if</span> <span class="n">target_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">target_range</span> <span class="o">=</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_SRC_RANGE&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ColorRange</span><span class="p">)</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">opp_manager</span><span class="o">.</span><span class="n">get_opp_to_yuv_coefs</span><span class="p">(</span><span class="n">target_matrix</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">yuv</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fmtc</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">clip</span><span class="p">,</span> <span class="n">fulls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fulld</span><span class="o">=</span><span class="ow">not</span> <span class="n">target_range</span><span class="p">,</span> <span class="n">col_fam</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="n">coef</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="k">return</span> <span class="n">yuv</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">SetFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="n">_Matrix</span><span class="o">=</span><span class="n">target_matrix</span><span class="p">,</span> <span class="n">_Primaries</span><span class="o">=</span><span class="n">primaries</span><span class="p">,</span> <span class="n">_Transfer</span><span class="o">=</span><span class="n">transfer</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">RemoveFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="p">[</span><span class="s2">&quot;BM3D_OPP&quot;</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_VARIANT&quot;</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_SRC_MATRIX&quot;</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_SRC_RANGE&quot;</span><span class="p">]</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.rgb2opp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">rgb2opp</span>


<a href="#y5gfunc.expr.test_atan2.rgb2opp" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rgb2opp</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.rgb2opp(clip))" href="#y5gfunc.expr.test_atan2.rgb2opp(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="opp_manager (y5gfunc.expr.test_atan2.rgb2opp(opp_manager))" href="#y5gfunc.expr.test_atan2.rgb2opp(opp_manager)">opp_manager</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert RGB to OPP color space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rgb2opp(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.rgb2opp(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input RGB clip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rgb2opp(opp_manager)" class="doc doc-heading doc-heading-parameter">                  <code>opp_manager</code>
<a href="#y5gfunc.expr.test_atan2.rgb2opp(opp_manager)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ColorMatrixManager for the specific OPP variant to use</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            default_opp


  
      module-attribute
   (y5gfunc.filter.resample.default_opp)" href="../filter/resample.html#y5gfunc.filter.resample.default_opp">default_opp</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clip in OPP color space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="k">def</span><span class="w"> </span><span class="nf">rgb2opp</span><span class="p">(</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="n">opp_manager</span><span class="p">:</span> <span class="n">ColorMatrixManager</span> <span class="o">=</span> <span class="n">default_opp</span><span class="p">,</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Convert RGB to OPP color space.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        clip: Input RGB clip</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        opp_manager: ColorMatrixManager for the specific OPP variant to use</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        Clip in OPP color space</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">color_family</span> <span class="o">==</span> <span class="n">vs</span><span class="o">.</span><span class="n">RGB</span><span class="p">,</span> <span class="s2">&quot;Input must be in RGB format&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">opp_manager</span><span class="o">.</span><span class="n">get_rgb_to_opp_coefs</span><span class="p">()</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>    <span class="n">opp</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fmtc</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">fulls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fulld</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">col_fam</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="n">coef</span><span class="p">)</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="k">return</span> <span class="n">opp</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">SetFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">_Matrix</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">MATRIX_UNSPECIFIED</span><span class="p">,</span> <span class="n">BM3D_OPP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">BM3D_OPP_VARIANT</span><span class="o">=</span><span class="n">opp_manager</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.opp2rgb" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">opp2rgb</span>


<a href="#y5gfunc.expr.test_atan2.opp2rgb" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">opp2rgb</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.opp2rgb(clip))" href="#y5gfunc.expr.test_atan2.opp2rgb(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="opp_manager (y5gfunc.expr.test_atan2.opp2rgb(opp_manager))" href="#y5gfunc.expr.test_atan2.opp2rgb(opp_manager)">opp_manager</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Convert OPP to RGB color space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.opp2rgb(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.opp2rgb(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input OPP clip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.opp2rgb(opp_manager)" class="doc doc-heading doc-heading-parameter">                  <code>opp_manager</code>
<a href="#y5gfunc.expr.test_atan2.opp2rgb(opp_manager)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-internal" title="            ColorMatrixManager (y5gfunc.filter.resample.ColorMatrixManager)" href="../filter/resample.html#y5gfunc.filter.resample.ColorMatrixManager">ColorMatrixManager</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ColorMatrixManager for the specific OPP variant, if None, read from clip properties</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clip in RGB color space</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="k">def</span><span class="w"> </span><span class="nf">opp2rgb</span><span class="p">(</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">opp_manager</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ColorMatrixManager</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">    Convert OPP to RGB color space.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        clip: Input OPP clip</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        opp_manager: ColorMatrixManager for the specific OPP variant, if None, read from clip properties</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        Clip in RGB color space</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="n">get_prop</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="p">),</span> <span class="s2">&quot;Input must be an OPP clip (BM3D_OPP=1)&quot;</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="k">if</span> <span class="n">opp_manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="n">variant_name</span> <span class="o">=</span> <span class="n">get_prop</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_VARIANT&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;standard&quot;</span><span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="k">if</span> <span class="n">variant_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_opp_managers</span><span class="p">:</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown OPP variant: </span><span class="si">{</span><span class="n">variant_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">opp_manager</span> <span class="o">=</span> <span class="n">_opp_managers</span><span class="p">[</span><span class="n">variant_name</span><span class="p">]</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">coef</span> <span class="o">=</span> <span class="n">opp_manager</span><span class="o">.</span><span class="n">get_opp_to_rgb_coefs</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">rgb</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fmtc</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">fulls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fulld</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">col_fam</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">RGB</span><span class="p">,</span> <span class="n">coef</span><span class="o">=</span><span class="n">coef</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="k">return</span> <span class="n">rgb</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">SetFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">_Matrix</span><span class="o">=</span><span class="n">vstools</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">RGB</span><span class="p">,</span> <span class="n">_Transfer</span><span class="o">=</span><span class="n">Transfer</span><span class="o">.</span><span class="n">SRGB</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">RemoveFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="p">[</span><span class="s2">&quot;BM3D_OPP&quot;</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_VARIANT&quot;</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_SRC_MATRIX&quot;</span><span class="p">,</span> <span class="s2">&quot;BM3D_OPP_SRC_RANGE&quot;</span><span class="p">]</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.SSIM_downsample" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">SSIM_downsample</span>


<a href="#y5gfunc.expr.test_atan2.SSIM_downsample" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">SSIM_downsample</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.SSIM_downsample(clip))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="width (y5gfunc.expr.test_atan2.SSIM_downsample(width))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(width)">width</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="height (y5gfunc.expr.test_atan2.SSIM_downsample(height))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(height)">height</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="smooth (y5gfunc.expr.test_atan2.SSIM_downsample(smooth))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(smooth)">smooth</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="gamma (y5gfunc.expr.test_atan2.SSIM_downsample(gamma))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(gamma)">gamma</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fulls (y5gfunc.expr.test_atan2.SSIM_downsample(fulls))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(fulls)">fulls</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fulld (y5gfunc.expr.test_atan2.SSIM_downsample(fulld))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(fulld)">fulld</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="curve (y5gfunc.expr.test_atan2.SSIM_downsample(curve))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(curve)">curve</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;709&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sigmoid (y5gfunc.expr.test_atan2.SSIM_downsample(sigmoid))" href="#y5gfunc.expr.test_atan2.SSIM_downsample(sigmoid)">sigmoid</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.SSIM_downsample(epsilon)">epsilon</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">1e-06</span><span class="p">,</span> <span class="o">**</span><span class="n"><span title="y5gfunc.expr.test_atan2.SSIM_downsample(**resample_args)">resample_args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>SSIM downsampler</p>
<p>SSIM downsampler is an image downscaling technique that aims to optimize for the perceptual quality of the downscaled results.
Image downscaling is considered as an optimization problem
where the difference between the input and output images is measured using famous Structural SIMilarity (SSIM) index.
The solution is derived in closed-form, which leads to the simple, efficient implementation.
The downscaled images retain perceptually important features and details,
resulting in an accurate and spatio-temporally consistent representation of the high resolution input.</p>
<p>All the internal calculations are done at 32-bit float, except gamma correction is done at integer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input clip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(width)" class="doc doc-heading doc-heading-parameter">                  <code>width</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(width)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The width of the output clip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(height)" class="doc doc-heading doc-heading-parameter">                  <code>height</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(height)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The height of the output clip</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(smooth)" class="doc doc-heading doc-heading-parameter">                  <code>smooth</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(smooth)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method to smooth the image.
If it's an int, it specifies the "radius" of the internal used boxfilter, i.e. the window has a size of (2<em>smooth+1)x(2</em>smooth+1).
If it's a float, it specifies the "sigma" of core.tcanny.TCanny, i.e. the standard deviation of gaussian blur.
If it's a function, it acs as a general smoother.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(gamma)" class="doc doc-heading doc-heading-parameter">                  <code>gamma</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(gamma)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set to true to turn on gamma correction for the y channel.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(fulls)" class="doc doc-heading doc-heading-parameter">                  <code>fulls</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(fulls)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies if the luma is limited range (False) or full range (True)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(fulld)" class="doc doc-heading doc-heading-parameter">                  <code>fulld</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(fulld)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Same as fulls, but for output.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(curve)" class="doc doc-heading doc-heading-parameter">                  <code>curve</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(curve)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of gamma mapping.</p>
              </div>
            </td>
            <td>
                  <code>&#39;709&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(sigmoid)" class="doc doc-heading doc-heading-parameter">                  <code>sigmoid</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(sigmoid)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When True, applies a sigmoidal curve after the power-like curve (or before when converting from linear to gamma-corrected).
This helps reducing the dark halo artifacts around sharp edges caused by resizing in linear luminance.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.SSIM_downsample(resample_args)" class="doc doc-heading doc-heading-parameter">                  <code>resample_args</code>
<a href="#y5gfunc.expr.test_atan2.SSIM_downsample(resample_args)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to <code>core.resize2</code> in the form of keyword arguments.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Downsampled clip in 32-bit format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#TypeError">TypeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>smooth</code> is neither a int, float nor a function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="ref" open>
  <summary>Ref</summary>
  <p>[1] Oeztireli, A. C., &amp; Gross, M. (2015). Perceptually based downscaling of images. ACM Transactions on Graphics (TOG), 34(4), 77.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="k">def</span><span class="w"> </span><span class="nf">SSIM_downsample</span><span class="p">(</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="n">smooth</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">gamma</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="n">fulls</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="n">fulld</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="n">curve</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;709&quot;</span><span class="p">,</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>    <span class="n">sigmoid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="n">epsilon</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="o">**</span><span class="n">resample_args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    SSIM downsampler</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">    SSIM downsampler is an image downscaling technique that aims to optimize for the perceptual quality of the downscaled results.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">    Image downscaling is considered as an optimization problem</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">    where the difference between the input and output images is measured using famous Structural SIMilarity (SSIM) index.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">    The solution is derived in closed-form, which leads to the simple, efficient implementation.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">    The downscaled images retain perceptually important features and details,</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">    resulting in an accurate and spatio-temporally consistent representation of the high resolution input.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">    All the internal calculations are done at 32-bit float, except gamma correction is done at integer.</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        clip: The input clip.</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">        width: The width of the output clip.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        height: The height of the output clip</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="sd">        smooth: The method to smooth the image.</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">            If it&#39;s an int, it specifies the &quot;radius&quot; of the internal used boxfilter, i.e. the window has a size of (2*smooth+1)x(2*smooth+1).</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">            If it&#39;s a float, it specifies the &quot;sigma&quot; of core.tcanny.TCanny, i.e. the standard deviation of gaussian blur.</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">            If it&#39;s a function, it acs as a general smoother.</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">        gamma: Set to true to turn on gamma correction for the y channel.</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">        fulls: Specifies if the luma is limited range (False) or full range (True)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">        fulld: Same as fulls, but for output.</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">        curve: Type of gamma mapping.</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">        sigmoid: When True, applies a sigmoidal curve after the power-like curve (or before when converting from linear to gamma-corrected).</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">            This helps reducing the dark halo artifacts around sharp edges caused by resizing in linear luminance.</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="sd">        resample_args: Additional arguments passed to `core.resize2` in the form of keyword arguments.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">        Downsampled clip in 32-bit format.</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">        TypeError: If `smooth` is neither a int, float nor a function.</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    Ref:</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        [1] Oeztireli, A. C., &amp; Gross, M. (2015). Perceptually based downscaling of images. ACM Transactions on Graphics (TOG), 34(4), 77.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">smooth</span><span class="p">):</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="n">Filter</span> <span class="o">=</span> <span class="n">smooth</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">Filter</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">box_blur</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">smooth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">Filter</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">tcanny</span><span class="o">.</span><span class="n">TCanny</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span> <span class="n">mode</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;SSIM_downsample: &quot;smooth&quot; must be a int, float or a function!&#39;</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="k">if</span> <span class="n">gamma</span><span class="p">:</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">nnedi3_resample</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nnrs</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">clip</span> <span class="o">=</span> <span class="n">nnrs</span><span class="o">.</span><span class="n">GammaToLinear</span><span class="p">(</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">depth</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="n">fulls</span><span class="o">=</span><span class="n">fulls</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">fulld</span><span class="o">=</span><span class="n">fulld</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>            <span class="n">curve</span><span class="o">=</span><span class="n">curve</span><span class="p">,</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">sigmoid</span><span class="o">=</span><span class="n">sigmoid</span><span class="p">,</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="n">clip</span> <span class="o">=</span> <span class="n">depth</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">l1</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">**</span><span class="n">resample_args</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="n">l2</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">clip</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;x 2 **&quot;</span><span class="p">]),</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="n">width</span><span class="p">,</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="n">height</span><span class="p">,</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="o">**</span><span class="n">resample_args</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>    <span class="n">sl_plus_m_square</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">l1</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;x 2 **&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>    <span class="n">sh_plus_m_square</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>    <span class="n">m_square</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;x 2 **&quot;</span><span class="p">])</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="p">[</span><span class="n">sl_plus_m_square</span><span class="p">,</span> <span class="n">sh_plus_m_square</span><span class="p">,</span> <span class="n">m_square</span><span class="p">],</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="p">[</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="sa">f</span><span class="s2">&quot;x z - </span><span class="si">{</span><span class="n">epsilon</span><span class="si">}</span><span class="s2"> &lt; 0 y z - x z - / sqrt ?&quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="p">],</span>  <span class="c1"># akarin.Expr adds &quot;0 max&quot; to sqrt by default</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="n">t</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;x y *&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="n">r</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">d</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;x y z * + a -&quot;</span><span class="p">])</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>    <span class="k">if</span> <span class="n">gamma</span><span class="p">:</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="n">d</span> <span class="o">=</span> <span class="n">nnrs</span><span class="o">.</span><span class="n">LinearToGamma</span><span class="p">(</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="n">depth</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>            <span class="n">fulls</span><span class="o">=</span><span class="n">fulls</span><span class="p">,</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="n">fulld</span><span class="o">=</span><span class="n">fulld</span><span class="p">,</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="n">curve</span><span class="o">=</span><span class="n">curve</span><span class="p">,</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="n">sigmoid</span><span class="o">=</span><span class="n">sigmoid</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>            <span class="n">planes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>    <span class="k">return</span> <span class="n">depth</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.is_stripe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">is_stripe</span>


<a href="#y5gfunc.expr.test_atan2.is_stripe" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">is_stripe</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.is_stripe(clip))" href="#y5gfunc.expr.test_atan2.is_stripe(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="threshold (y5gfunc.expr.test_atan2.is_stripe(threshold))" href="#y5gfunc.expr.test_atan2.is_stripe(threshold)">threshold</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="freq_range (y5gfunc.expr.test_atan2.is_stripe(freq_range))" href="#y5gfunc.expr.test_atan2.is_stripe(freq_range)">freq_range</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="scenecut_threshold (y5gfunc.expr.test_atan2.is_stripe(scenecut_threshold))" href="#y5gfunc.expr.test_atan2.is_stripe(scenecut_threshold)">scenecut_threshold</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Detects scenes potentially containing strong vertical stripes using FFT analysis.</p>
<p>This function analyzes the frequency spectrum of each frame to identify scenes where the energy in high vertical frequencies
significantly outweighs the energy in high horizontal frequencies. This pattern is often indicative of vertical stripes.</p>
<p>The analysis is performed per scene, meaning the ratio of vertical to horizontal frequency energy is averaged over all frames
within a detected scene. All frames in that scene are then marked based on this average ratio.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.is_stripe(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.is_stripe(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input video clip. Must be 32-bit per sample.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.is_stripe(threshold)" class="doc doc-heading doc-heading-parameter">                  <code>threshold</code>
<a href="#y5gfunc.expr.test_atan2.is_stripe(threshold)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold for the ratio of average vertical high-frequency energy to average horizontal
high-frequency energy within a scene. If a scene's ratio exceeds this value, it's marked as potentially containing stripes.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.is_stripe(freq_range)" class="doc doc-heading doc-heading-parameter">                  <code>freq_range</code>
<a href="#y5gfunc.expr.test_atan2.is_stripe(freq_range)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Defines the proportion of the spectrum (from each edge towards the center) considered as "high frequency".
For example, 0.25 means the outer 25% of frequencies horizontally and vertically are analyzed.
Must be between 0 and 0.5 (exclusive of 0, inclusive of 0.5 isn't practically useful).</p>
              </div>
            </td>
            <td>
                  <code>0.25</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.is_stripe(scenecut_threshold)" class="doc doc-heading doc-heading-parameter">                  <code>scenecut_threshold</code>
<a href="#y5gfunc.expr.test_atan2.is_stripe(scenecut_threshold)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Threshold used for scene change detection via <code>core.misc.SCDetect</code>.
Controls how sensitive the scene detection is. Lower values detect more scene changes.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input clip with a frame property <code>_Stripe</code> added. <code>_Stripe</code> is 1 (True) if the frame belongs to a scene detected as
potentially containing stripes (ratio &gt; threshold), and 0 (False) otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input clip is not 32-bit per sample.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if freq_range is not between 0 and 0.5.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/stripe.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_stripe</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">freq_range</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">scenecut_threshold</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Detects scenes potentially containing strong vertical stripes using FFT analysis.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    This function analyzes the frequency spectrum of each frame to identify scenes where the energy in high vertical frequencies</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    significantly outweighs the energy in high horizontal frequencies. This pattern is often indicative of vertical stripes.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    The analysis is performed per scene, meaning the ratio of vertical to horizontal frequency energy is averaged over all frames</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    within a detected scene. All frames in that scene are then marked based on this average ratio.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        clip: Input video clip. Must be 32-bit per sample.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        threshold: The threshold for the ratio of average vertical high-frequency energy to average horizontal</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">            high-frequency energy within a scene. If a scene&#39;s ratio exceeds this value, it&#39;s marked as potentially containing stripes.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        freq_range: Defines the proportion of the spectrum (from each edge towards the center) considered as &quot;high frequency&quot;.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">            For example, 0.25 means the outer 25% of frequencies horizontally and vertically are analyzed.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">            Must be between 0 and 0.5 (exclusive of 0, inclusive of 0.5 isn&#39;t practically useful).</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        scenecut_threshold: Threshold used for scene change detection via `core.misc.SCDetect`.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            Controls how sensitive the scene detection is. Lower values detect more scene changes.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        The input clip with a frame property `_Stripe` added. `_Stripe` is 1 (True) if the frame belongs to a scene detected as</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">            potentially containing stripes (ratio &gt; threshold), and 0 (False) otherwise.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        ValueError: If input clip is not 32-bit per sample.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        ValueError: if freq_range is not between 0 and 0.5.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scene_fft</span><span class="p">(</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">],</span> <span class="n">cache</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">prefetch</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="n">fout</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="n">prefetch</span><span class="o">.</span><span class="n">num_frames</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;_SceneChangePrev&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">if</span> <span class="n">cache</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">:</span>  <span class="c1"># not cached</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="n">scene_start</span> <span class="o">=</span> <span class="n">n</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>            <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                <span class="n">frame</span> <span class="o">=</span> <span class="n">prefetch</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;_SceneChangePrev&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># scene start</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                    <span class="n">scene_start</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                    <span class="k">break</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">scene_start</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>            <span class="n">scene_length</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>            <span class="n">hor_accum</span> <span class="o">=</span> <span class="mf">1e-9</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>            <span class="n">ver_accum</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">prefetch</span><span class="o">.</span><span class="n">num_frames</span><span class="p">:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>                <span class="n">frame</span> <span class="o">=</span> <span class="n">prefetch</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="n">hor_accum</span> <span class="o">+=</span> <span class="n">frame</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;hor&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="n">ver_accum</span> <span class="o">+=</span> <span class="n">frame</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ver&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                <span class="n">scene_length</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;_SceneChangeNext&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># scene end</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                    <span class="k">break</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="n">ratio</span> <span class="o">=</span> <span class="n">ver_accum</span> <span class="o">/</span> <span class="n">hor_accum</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">cache</span><span class="p">[</span><span class="n">scene_start</span> <span class="p">:</span> <span class="n">scene_start</span> <span class="o">+</span> <span class="n">scene_length</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ratio</span><span class="p">]</span> <span class="o">*</span> <span class="n">scene_length</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ratio&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">return</span> <span class="n">fout</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">if</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">bits_per_sample</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;is_stripe: input clip must be 32-bit per sample.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">freq_range</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;is_stripe: freq_range must be between 0 and 0.5.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">freq_drop_range</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">freq_range</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">freq_drop_lr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="n">freq_drop_range</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">freq_drop_bt</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">height</span> <span class="o">*</span> <span class="n">freq_drop_range</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">fft</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">fftspectrum_rs</span><span class="o">.</span><span class="n">FFTSpectrum</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">left</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">fft</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">freq_drop_lr</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">right</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">fft</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">freq_drop_lr</span><span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">hor</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">StackHorizontal</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">PlaneStats</span><span class="p">()</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">top</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">fft</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">freq_drop_bt</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">bottom</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Crop</span><span class="p">(</span><span class="n">fft</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">freq_drop_bt</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">ver</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">StackHorizontal</span><span class="p">([</span><span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">])</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">PlaneStats</span><span class="p">()</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">scene</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">SCDetect</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">scenecut_threshold</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">prefetch</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">BlankClip</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">prefetch</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">PropExpr</span><span class="p">(</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="p">[</span><span class="n">hor</span><span class="p">,</span> <span class="n">ver</span><span class="p">,</span> <span class="n">scene</span><span class="p">],</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="s2">&quot;hor&quot;</span><span class="p">:</span> <span class="s2">&quot;x.PlaneStatsAverage&quot;</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="s2">&quot;ver&quot;</span><span class="p">:</span> <span class="s2">&quot;y.PlaneStatsAverage&quot;</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="s2">&quot;_SceneChangeNext&quot;</span><span class="p">:</span> <span class="s2">&quot;z._SceneChangeNext&quot;</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s2">&quot;_SceneChangePrev&quot;</span><span class="p">:</span> <span class="s2">&quot;z._SceneChangePrev&quot;</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="p">},</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">cache</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">scene</span><span class="o">.</span><span class="n">num_frames</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ModifyFrame</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">scene</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="p">[</span><span class="n">scene</span><span class="p">,</span> <span class="n">scene</span><span class="p">],</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">scene_fft</span><span class="p">,</span> <span class="n">prefetch</span><span class="o">=</span><span class="n">prefetch</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">),</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">ret</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">PropExpr</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="p">[</span><span class="n">ret</span><span class="p">],</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;_Stripe&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;x.ratio </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2"> &gt;&quot;</span><span class="p">}</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="p">)</span>  <span class="c1"># x.ratio &gt; threshold: Stripe</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.convolution" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">convolution</span>


<a href="#y5gfunc.expr.test_atan2.convolution" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">convolution</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.convolution(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(matrix)">matrix</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">],</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(bias)">bias</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(divisor)">divisor</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(planes)">planes</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(saturate)">saturate</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(mode)">mode</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.convolution(use_std)">use_std</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            is_optimized_cpu (y5gfunc.filter.utils.is_optimized_cpu)" href="../filter/utils.html#y5gfunc.filter.utils.is_optimized_cpu">is_optimized_cpu</a></span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/morpho.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="k">def</span><span class="w"> </span><span class="nf">convolution</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="n">matrix</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">divisor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="n">planes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="n">saturate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">use_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_optimized_cpu</span><span class="p">(),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="k">if</span> <span class="n">planes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">))</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="p">[</span><span class="n">planes</span><span class="p">]</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;s&quot;</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">9</span> <span class="ow">or</span> <span class="n">use_std</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Convolution</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">bias</span><span class="p">,</span> <span class="n">divisor</span><span class="p">,</span> <span class="n">planes</span><span class="p">,</span> <span class="n">saturate</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">divisor</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-9</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="n">actual_divisor</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">matrix</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1e-9</span> <span class="k">else</span> <span class="mf">1.0</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">actual_divisor</span> <span class="o">=</span> <span class="n">divisor</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">]</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">expr_parts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">offsets</span><span class="p">):</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x[</span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">dy</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> *&quot;</span><span class="p">)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">actual_divisor</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">bias</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> + &quot;</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">peak</span> <span class="o">=</span> <span class="n">get_peak_value</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">if</span> <span class="n">saturate</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;0 </span><span class="si">{</span><span class="n">peak</span><span class="si">}</span><span class="s2"> clip&quot;</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;abs&quot;</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>            <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">peak</span><span class="si">}</span><span class="s2"> min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">expr</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_parts</span><span class="p">)</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="n">expr</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">planes</span> <span class="k">else</span> <span class="s2">&quot;x&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="p">]</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">expressions</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>    <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Convolution</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">bias</span><span class="p">,</span> <span class="n">divisor</span><span class="p">,</span> <span class="n">planes</span><span class="p">,</span> <span class="n">saturate</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.maximum" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">maximum</span>


<a href="#y5gfunc.expr.test_atan2.maximum" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">maximum</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.maximum(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.maximum(planes)">planes</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.maximum(threshold)">threshold</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.maximum(coordinates)">coordinates</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n"><span title="y5gfunc.expr.test_atan2.maximum(boundary)">boundary</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.maximum(use_std)">use_std</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            is_optimized_cpu (y5gfunc.filter.utils.is_optimized_cpu)" href="../filter/utils.html#y5gfunc.filter.utils.is_optimized_cpu">is_optimized_cpu</a></span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/morpho.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span>
<span class="normal"><a href="#__codelineno-0-83">83</a></span>
<span class="normal"><a href="#__codelineno-0-84">84</a></span>
<span class="normal"><a href="#__codelineno-0-85">85</a></span>
<span class="normal"><a href="#__codelineno-0-86">86</a></span>
<span class="normal"><a href="#__codelineno-0-87">87</a></span>
<span class="normal"><a href="#__codelineno-0-88">88</a></span>
<span class="normal"><a href="#__codelineno-0-89">89</a></span>
<span class="normal"><a href="#__codelineno-0-90">90</a></span>
<span class="normal"><a href="#__codelineno-0-91">91</a></span>
<span class="normal"><a href="#__codelineno-0-92">92</a></span>
<span class="normal"><a href="#__codelineno-0-93">93</a></span>
<span class="normal"><a href="#__codelineno-0-94">94</a></span>
<span class="normal"><a href="#__codelineno-0-95">95</a></span>
<span class="normal"><a href="#__codelineno-0-96">96</a></span>
<span class="normal"><a href="#__codelineno-0-97">97</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="k">def</span><span class="w"> </span><span class="nf">maximum</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">planes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">boundary</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">use_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_optimized_cpu</span><span class="p">(),</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="k">if</span> <span class="n">use_std</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Maximum</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">planes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">return</span> <span class="n">_create_minmax_expr</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="s2">&quot;drop</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)),</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="s2">&quot; x[0,0] </span><span class="si">{}</span><span class="s2"> + swap min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="n">planes</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">threshold</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">coordinates</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">boundary</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.minimum" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">minimum</span>


<a href="#y5gfunc.expr.test_atan2.minimum" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">minimum</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.minimum(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.minimum(planes)">planes</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.minimum(threshold)">threshold</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.minimum(coordinates)">coordinates</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n"><span title="y5gfunc.expr.test_atan2.minimum(boundary)">boundary</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.minimum(use_std)">use_std</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            is_optimized_cpu (y5gfunc.filter.utils.is_optimized_cpu)" href="../filter/utils.html#y5gfunc.filter.utils.is_optimized_cpu">is_optimized_cpu</a></span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/morpho.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span><span class="w"> </span><span class="nf">minimum</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">planes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">boundary</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">use_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_optimized_cpu</span><span class="p">(),</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">if</span> <span class="n">use_std</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Minimum</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">planes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">return</span> <span class="n">_create_minmax_expr</span><span class="p">(</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>            <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>            <span class="s2">&quot;min! drop</span><span class="si">{}</span><span class="s2"> min@&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)),</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="s2">&quot; x[0,0] </span><span class="si">{}</span><span class="s2"> - swap max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="n">planes</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="n">threshold</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">coordinates</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>            <span class="n">boundary</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.inflate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">inflate</span>


<a href="#y5gfunc.expr.test_atan2.inflate" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">inflate</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.inflate(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.inflate(planes)">planes</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.inflate(threshold)">threshold</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.inflate(boundary)">boundary</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.inflate(use_std)">use_std</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            is_optimized_cpu (y5gfunc.filter.utils.is_optimized_cpu)" href="../filter/utils.html#y5gfunc.filter.utils.is_optimized_cpu">is_optimized_cpu</a></span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/morpho.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="k">def</span><span class="w"> </span><span class="nf">inflate</span><span class="p">(</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">planes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">boundary</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">use_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_optimized_cpu</span><span class="p">(),</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">if</span> <span class="n">planes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">))</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="p">[</span><span class="n">planes</span><span class="p">]</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">if</span> <span class="n">use_std</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Inflate</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">planes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">expr_parts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">NEIGHBOR_OFFSETS</span><span class="p">):</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x[</span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">dy</span><span class="si">}</span><span class="s2">] 8 / &quot;</span><span class="p">)</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;+ &quot;</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;x max&quot;</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="k">if</span> <span class="n">threshold</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; x </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2"> + min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_parts</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">expr</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">planes</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;x&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="p">]</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">clips</span><span class="o">=</span><span class="p">[</span><span class="n">clip</span><span class="p">],</span> <span class="n">expr</span><span class="o">=</span><span class="n">expressions</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="n">boundary</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.deflate" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">deflate</span>


<a href="#y5gfunc.expr.test_atan2.deflate" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">deflate</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.deflate(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.deflate(planes)">planes</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.deflate(threshold)">threshold</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.deflate(boundary)">boundary</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.deflate(use_std)">use_std</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            is_optimized_cpu (y5gfunc.filter.utils.is_optimized_cpu)" href="../filter/utils.html#y5gfunc.filter.utils.is_optimized_cpu">is_optimized_cpu</a></span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/morpho.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="k">def</span><span class="w"> </span><span class="nf">deflate</span><span class="p">(</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="n">planes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="n">boundary</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">use_std</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">is_optimized_cpu</span><span class="p">(),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="k">if</span> <span class="n">planes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">))</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">planes</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">planes</span> <span class="o">=</span> <span class="p">[</span><span class="n">planes</span><span class="p">]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">if</span> <span class="n">use_std</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Deflate</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">planes</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">expr_parts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">NEIGHBOR_OFFSETS</span><span class="p">):</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x[</span><span class="si">{</span><span class="n">dx</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">dy</span><span class="si">}</span><span class="s2">] 8 / &quot;</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;x min&quot;</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">if</span> <span class="n">threshold</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; x </span><span class="si">{</span><span class="n">threshold</span><span class="si">}</span><span class="s2"> - max&quot;</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_parts</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">expressions</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">expr</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="n">planes</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;x&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="p">]</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">clips</span><span class="o">=</span><span class="p">[</span><span class="n">clip</span><span class="p">],</span> <span class="n">expr</span><span class="o">=</span><span class="n">expressions</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="n">boundary</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.scd_koala" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">scd_koala</span>


<a href="#y5gfunc.expr.test_atan2.scd_koala" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">scd_koala</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.scd_koala(clip))" href="#y5gfunc.expr.test_atan2.scd_koala(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="min_scene_len (y5gfunc.expr.test_atan2.scd_koala(min_scene_len))" href="#y5gfunc.expr.test_atan2.scd_koala(min_scene_len)">min_scene_len</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="filter_size (y5gfunc.expr.test_atan2.scd_koala(filter_size))" href="#y5gfunc.expr.test_atan2.scd_koala(filter_size)">filter_size</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="window_size (y5gfunc.expr.test_atan2.scd_koala(window_size))" href="#y5gfunc.expr.test_atan2.scd_koala(window_size)">window_size</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="deviation (y5gfunc.expr.test_atan2.scd_koala(deviation))" href="#y5gfunc.expr.test_atan2.scd_koala(deviation)">deviation</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="edge_func (y5gfunc.expr.test_atan2.scd_koala(edge_func))" href="#y5gfunc.expr.test_atan2.scd_koala(edge_func)">edge_func</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">[[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">],</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-external" title="functools.partial" href="https://docs.python.org/3/library/functools.html#functools.partial">partial</a></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="            AnimeMask (y5gfunc.filter.AnimeMask)" href="#y5gfunc.expr.test_atan2.AnimeMask">AnimeMask</a></span><span class="p">,</span> <span class="n"><span title="functools.partial(mode)">mode</span></span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Koala-36M Based Scenecut Detector</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.scd_koala(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.scd_koala(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input video clip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.scd_koala(min_scene_len)" class="doc doc-heading doc-heading-parameter">                  <code>min_scene_len</code>
<a href="#y5gfunc.expr.test_atan2.scd_koala(min_scene_len)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum scene length.</p>
              </div>
            </td>
            <td>
                  <code>12</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.scd_koala(filter_size)" class="doc doc-heading doc-heading-parameter">                  <code>filter_size</code>
<a href="#y5gfunc.expr.test_atan2.scd_koala(filter_size)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boxcar filter size.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.scd_koala(window_size)" class="doc doc-heading doc-heading-parameter">                  <code>window_size</code>
<a href="#y5gfunc.expr.test_atan2.scd_koala(window_size)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window to use for calculating threshold.</p>
              </div>
            </td>
            <td>
                  <code>8</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.scd_koala(deviation)" class="doc doc-heading doc-heading-parameter">                  <code>deviation</code>
<a href="#y5gfunc.expr.test_atan2.scd_koala(deviation)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplier for standard deviations when calculating threshold.</p>
              </div>
            </td>
            <td>
                  <code>3.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.scd_koala(edge_func)" class="doc doc-heading doc-heading-parameter">                  <code>edge_func</code>
<a href="#y5gfunc.expr.test_atan2.scd_koala(edge_func)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="vstools.vs.VideoNode">VideoNode</span>], <span title="vstools.vs.VideoNode">VideoNode</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to detect edges in the input clip.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="functools.partial" href="https://docs.python.org/3/library/functools.html#functools.partial">partial</a>(<a class="autorefs autorefs-internal" title="            AnimeMask (y5gfunc.filter.AnimeMask)" href="#y5gfunc.expr.test_atan2.AnimeMask">AnimeMask</a>, <span title="functools.partial(mode)">mode</span>=-1)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input video clip with frame prop "_Scenecut" set to 1 at scenecuts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/scenecut.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="k">def</span><span class="w"> </span><span class="nf">scd_koala</span><span class="p">(</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">min_scene_len</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="n">filter_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="n">window_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">deviation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">edge_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">],</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">AnimeMask</span><span class="p">,</span> <span class="n">mode</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Koala-36M Based Scenecut Detector</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        clip: Input video clip.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        min_scene_len: Minimum scene length.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        filter_size: Boxcar filter size.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        window_size: Window to use for calculating threshold.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        deviation: Multiplier for standard deviations when calculating threshold.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        edge_func: Function to detect edges in the input clip.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        Input video clip with frame prop &quot;_Scenecut&quot; set to 1 at scenecuts.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">if</span> <span class="n">filter_size</span> <span class="o">&gt;</span> <span class="n">window_size</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;scd_koala: filter_size should be &lt;= window_size.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">num_frames</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">resized_clip</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">RGB24</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="n">gray_clip</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ShufflePlanes</span><span class="p">(</span><span class="n">resized_clip</span><span class="p">,</span> <span class="n">planes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">colorfamily</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">GRAY</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">small_gray</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Bicubic</span><span class="p">(</span><span class="n">gray_clip</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="n">edges</span> <span class="o">=</span> <span class="n">edge_func</span><span class="p">(</span><span class="n">small_gray</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">combined_edges</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">([</span><span class="n">small_gray</span><span class="p">,</span> <span class="n">edges</span><span class="p">],</span> <span class="n">expr</span><span class="o">=</span><span class="s2">&quot;x y max&quot;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">prev_edge_clip</span> <span class="o">=</span> <span class="n">combined_edges</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">DuplicateFrames</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Trim</span><span class="p">(</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">first</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">num_frames</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">ssim_result</span> <span class="o">=</span> <span class="n">muvsfunc</span><span class="o">.</span><span class="n">SSIM</span><span class="p">(</span><span class="n">prev_edge_clip</span><span class="p">,</span> <span class="n">combined_edges</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">curr_frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">resized_clip</span><span class="o">.</span><span class="n">frames</span><span class="p">()):</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>            <span class="n">prev_frame</span> <span class="o">=</span> <span class="n">curr_frame</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>            <span class="k">continue</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">prev_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prev_frame</span><span class="p">[</span><span class="n">p</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">prev_frame</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">)]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">curr_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">curr_frame</span><span class="p">[</span><span class="n">p</span><span class="p">])</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">curr_frame</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span><span class="p">)]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">prev_hist</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">curr_hist</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="n">channel_data</span> <span class="o">=</span> <span class="n">prev_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">c</span><span class="p">]</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">channel_data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">channel_data</span> <span class="o">&lt;</span> <span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">channel_data</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">254</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>            <span class="n">prev_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">channel_data</span> <span class="o">=</span> <span class="n">curr_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">c</span><span class="p">]</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">channel_data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">channel_data</span> <span class="o">&lt;</span> <span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">channel_data</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">254</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="n">curr_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">delta_histogram</span> <span class="o">=</span> <span class="n">histogram_correlation</span><span class="p">(</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prev_hist</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">curr_hist</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">ssim_frame</span> <span class="o">=</span> <span class="n">ssim_result</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">delta_edges</span> <span class="o">=</span> <span class="n">ssim_frame</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PlaneSSIM&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">score</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="mf">4.61480465</span> <span class="o">*</span> <span class="n">delta_histogram</span> <span class="o">+</span> <span class="mf">3.75211168</span> <span class="o">*</span> <span class="n">delta_edges</span> <span class="o">-</span> <span class="mf">5.485968377115124</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">prev_frame</span> <span class="o">=</span> <span class="n">curr_frame</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="n">cut_found</span> <span class="o">=</span> <span class="p">[</span><span class="n">score</span> <span class="o">&lt;</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">]</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="n">cut_found</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="n">filter_kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">filter_size</span><span class="p">)</span> <span class="o">/</span> <span class="n">filter_size</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="n">filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">filter_kernel</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)):</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">window_size</span> <span class="ow">and</span> <span class="n">filtered</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">filter_size</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">filter_size</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="p">):</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="n">window</span> <span class="o">=</span> <span class="n">filtered</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">window_size</span> <span class="p">:</span> <span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">window</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">deviation</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">window</span><span class="p">))</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="k">if</span> <span class="n">filtered</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="n">cut_found</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">scene_cuts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">last_cut</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cut_found</span><span class="p">)):</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">if</span> <span class="n">cut_found</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="n">current_frame</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">scene_length</span> <span class="o">=</span> <span class="n">current_frame</span> <span class="o">-</span> <span class="n">last_cut</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="k">if</span> <span class="n">scene_length</span> <span class="o">&gt;=</span> <span class="n">min_scene_len</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="n">scene_cuts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_frame</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="n">last_cut</span> <span class="o">=</span> <span class="n">current_frame</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_scenecut_prop</span><span class="p">(</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">,</span> <span class="n">scene_cuts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">fout</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">scene_cuts</span><span class="p">:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">_Scenecut</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">_Scenecut</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">return</span> <span class="n">fout</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">marked_clip</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ModifyFrame</span><span class="p">(</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">clip</span><span class="p">,</span> <span class="n">clip</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="n">set_scenecut_prop</span><span class="p">,</span> <span class="n">scene_cuts</span><span class="o">=</span><span class="n">scene_cuts</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="k">return</span> <span class="n">marked_clip</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.temporal_stabilize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">temporal_stabilize</span>


<a href="#y5gfunc.expr.test_atan2.temporal_stabilize" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">temporal_stabilize</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="processed_clip (y5gfunc.expr.test_atan2.temporal_stabilize(processed_clip))" href="#y5gfunc.expr.test_atan2.temporal_stabilize(processed_clip)">processed_clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="ref_clip (y5gfunc.expr.test_atan2.temporal_stabilize(ref_clip))" href="#y5gfunc.expr.test_atan2.temporal_stabilize(ref_clip)">ref_clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="delta (y5gfunc.expr.test_atan2.temporal_stabilize(delta))" href="#y5gfunc.expr.test_atan2.temporal_stabilize(delta)">delta</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="pel (y5gfunc.expr.test_atan2.temporal_stabilize(pel))" href="#y5gfunc.expr.test_atan2.temporal_stabilize(pel)">pel</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="retain (y5gfunc.expr.test_atan2.temporal_stabilize(retain))" href="#y5gfunc.expr.test_atan2.temporal_stabilize(retain)">retain</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Temporally stabilizes a processed video clip using motion compensation based on a reference clip.</p>
<p>This function aims to reduce temporal inconsistencies (like flickering or unsteadiness) in the <code>processed_clip</code> by referencing a <code>reference_clip</code>.
It calculates the difference between <code>reference_clip</code> and <code>processed_clip</code>, stabilizes this difference using motion vectors derived from <code>processed_clip</code>,
and then applies the stabilized difference back onto <code>reference_clip</code>.</p>
<p>A common use case is when <code>processed_clip</code> is the result of filtering applied to <code>reference_clip</code>, and that filtering
introduced temporal instability. This function attempts to apply a temporally consistent version of the filter's effect.</p>
<p>The core stabilization logic uses motion vector analysis on <code>processed_clip</code> and motion compensation on the difference clip.
A limiting step ensures the stabilized difference doesn't deviate too drastically from the original difference, controlled by the <code>retain</code> parameter.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.temporal_stabilize(processed_clip)" class="doc doc-heading doc-heading-parameter">                  <code>processed_clip</code>
<a href="#y5gfunc.expr.test_atan2.temporal_stabilize(processed_clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input video clip that likely contains temporal instabilities.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.temporal_stabilize(ref_clip)" class="doc doc-heading doc-heading-parameter">                  <code>ref_clip</code>
<a href="#y5gfunc.expr.test_atan2.temporal_stabilize(ref_clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reference video clip,  the original source before the processing that introduced instability.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.temporal_stabilize(delta)" class="doc doc-heading doc-heading-parameter">                  <code>delta</code>
<a href="#y5gfunc.expr.test_atan2.temporal_stabilize(delta)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temporal radius for temporal stabilize (1-6). This value corresponds to the <code>mv.DegrainN</code> function used.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.temporal_stabilize(pel)" class="doc doc-heading doc-heading-parameter">                  <code>pel</code>
<a href="#y5gfunc.expr.test_atan2.temporal_stabilize(pel)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Subpixel accuracy for motion estimation passed to <code>mv.Super</code>. Higher values increase accuracy but also computational cost.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.temporal_stabilize(retain)" class="doc doc-heading doc-heading-parameter">                  <code>retain</code>
<a href="#y5gfunc.expr.test_atan2.temporal_stabilize(retain)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight for merging the limited stabilized difference with the full stabilized difference. A value of 1.0 means only the full
stabilized difference is used, while 0.0 means only the limited difference (closer to the original difference) is used. It controls
the strength of the stabilization effect versus preserving the original difference characteristics. Range [0.0, 1.0].</p>
              </div>
            </td>
            <td>
                  <code>0.6</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new video clip, ideally resembling <code>processed_clip</code> but with reduced temporal instability.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>processed_clip</code> and <code>reference_clip</code> have different video formats.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>pel</code> is not an ingeter in [1, 2, 4].</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>delta</code> is not an integer between 1 and 6 (inclusive).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/temporal.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span>
<span class="normal"><a href="#__codelineno-0-82">82</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">temporal_stabilize</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">processed_clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">ref_clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">delta</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">pel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">retain</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Temporally stabilizes a processed video clip using motion compensation based on a reference clip.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    This function aims to reduce temporal inconsistencies (like flickering or unsteadiness) in the `processed_clip` by referencing a `reference_clip`.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    It calculates the difference between `reference_clip` and `processed_clip`, stabilizes this difference using motion vectors derived from `processed_clip`,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    and then applies the stabilized difference back onto `reference_clip`.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    A common use case is when `processed_clip` is the result of filtering applied to `reference_clip`, and that filtering</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    introduced temporal instability. This function attempts to apply a temporally consistent version of the filter&#39;s effect.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    The core stabilization logic uses motion vector analysis on `processed_clip` and motion compensation on the difference clip.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    A limiting step ensures the stabilized difference doesn&#39;t deviate too drastically from the original difference, controlled by the `retain` parameter.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        processed_clip: The input video clip that likely contains temporal instabilities.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        ref_clip: The reference video clip,  the original source before the processing that introduced instability.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        delta: Temporal radius for temporal stabilize (1-6). This value corresponds to the `mv.DegrainN` function used.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        pel: Subpixel accuracy for motion estimation passed to `mv.Super`. Higher values increase accuracy but also computational cost.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        retain: Weight for merging the limited stabilized difference with the full stabilized difference. A value of 1.0 means only the full</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            stabilized difference is used, while 0.0 means only the limited difference (closer to the original difference) is used. It controls</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">            the strength of the stabilization effect versus preserving the original difference characteristics. Range [0.0, 1.0].</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        A new video clip, ideally resembling `processed_clip` but with reduced temporal instability.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        ValueError: If `processed_clip` and `reference_clip` have different video formats.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        ValueError: if `pel` is not an ingeter in [1, 2, 4].</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        ValueError: If `delta` is not an integer between 1 and 6 (inclusive).</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">if</span> <span class="n">processed_clip</span><span class="o">.</span><span class="n">format</span> <span class="o">!=</span> <span class="n">ref_clip</span><span class="o">.</span><span class="n">format</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>            <span class="s2">&quot;temporal_stabilize: format of processed_clip and ref_clip mismatch.&quot;</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">if</span> <span class="n">pel</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;temporal_stabilize: pel (1, 2, 4) invalid.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">if</span> <span class="n">delta</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;temporal_stabilize: delta (1~6) invalid.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">diff</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MakeDiff</span><span class="p">(</span><span class="n">ref_clip</span><span class="p">,</span> <span class="n">processed_clip</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">clip_super</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Super</span><span class="p">(</span><span class="n">processed_clip</span><span class="p">,</span> <span class="n">pel</span><span class="o">=</span><span class="n">pel</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">diff_super</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Super</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">pel</span><span class="o">=</span><span class="n">pel</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">backward_vectors</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Analyse</span><span class="p">(</span><span class="n">clip_super</span><span class="p">,</span> <span class="n">isb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="p">]</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">forward_vectors</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="o">.</span><span class="n">Analyse</span><span class="p">(</span><span class="n">clip_super</span><span class="p">,</span> <span class="n">isb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">blksize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="p">]</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">vectors</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">vector</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>        <span class="k">for</span> <span class="n">vector_group</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">backward_vectors</span><span class="p">,</span> <span class="n">forward_vectors</span><span class="p">)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">vector_group</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="p">]</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">stabilize_func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">mv</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Degrain</span><span class="si">{</span><span class="n">delta</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">diff_stabilized</span> <span class="o">=</span> <span class="n">stabilize_func</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">diff_super</span><span class="p">,</span> <span class="o">*</span><span class="n">vectors</span><span class="p">)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">diff_stabilized_limited</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="p">[</span><span class="n">diff</span><span class="p">,</span> <span class="n">diff_stabilized</span><span class="p">],</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="sa">f</span><span class="s2">&quot;x </span><span class="si">{</span><span class="n">get_neutral_value</span><span class="p">(</span><span class="n">processed_clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> - abs y </span><span class="si">{</span><span class="n">get_neutral_value</span><span class="p">(</span><span class="n">processed_clip</span><span class="p">)</span><span class="si">}</span><span class="s2"> - abs &lt; x y ?&quot;</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">diff_stabilized</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Merge</span><span class="p">(</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">diff_stabilized_limited</span><span class="p">,</span> <span class="n">diff_stabilized</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">retain</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">clip_stabilized</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MakeDiff</span><span class="p">(</span><span class="n">ref_clip</span><span class="p">,</span> <span class="n">diff_stabilized</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">return</span> <span class="n">clip_stabilized</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.nn2x" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">nn2x</span>


<a href="#y5gfunc.expr.test_atan2.nn2x" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">nn2x</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.nn2x(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.nn2x(opencl)">opencl</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.nn2x(nnedi3_args)">nnedi3_args</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;field&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nsize&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;nns&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;qual&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Doubles the resolution of input clip with nnedi3.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/resample.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="k">def</span><span class="w"> </span><span class="nf">nn2x</span><span class="p">(</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">opencl</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="n">nnedi3_args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nsize&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;nns&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;qual&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Doubles the resolution of input clip with nnedi3.&quot;&quot;&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="s2">&quot;sneedif&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">opencl</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">nnedi3</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">sneedif</span><span class="o">.</span><span class="n">NNEDI3</span><span class="p">,</span> <span class="o">**</span><span class="n">nnedi3_args</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">return</span> <span class="n">nnedi3</span><span class="p">(</span><span class="n">nnedi3</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">dh</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">dw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">core</span><span class="p">,</span> <span class="s2">&quot;nnedi3cl&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">opencl</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">nnedi3</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">nnedi3cl</span><span class="o">.</span><span class="n">NNEDI3CL</span><span class="p">,</span> <span class="o">**</span><span class="n">nnedi3_args</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>        <span class="k">return</span> <span class="n">nnedi3</span><span class="p">(</span><span class="n">nnedi3</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">dh</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">dw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="n">nnedi3</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">nnedi3</span><span class="o">.</span><span class="n">nnedi3</span><span class="p">,</span> <span class="o">**</span><span class="n">nnedi3_args</span><span class="p">)</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">return</span> <span class="n">nnedi3</span><span class="p">(</span><span class="n">nnedi3</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">dh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Transpose</span><span class="p">(),</span> <span class="n">dh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Transpose</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.double_aa" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">double_aa</span>


<a href="#y5gfunc.expr.test_atan2.double_aa" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">double_aa</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.double_aa(clip))" href="#y5gfunc.expr.test_atan2.double_aa(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="mask (y5gfunc.expr.test_atan2.double_aa(mask))" href="#y5gfunc.expr.test_atan2.double_aa(mask)">mask</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="doubler (y5gfunc.expr.test_atan2.double_aa(doubler))" href="#y5gfunc.expr.test_atan2.double_aa(doubler)">doubler</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a></span><span class="p">[[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">],</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            nn2x (y5gfunc.filter.resample.nn2x)" href="../filter/resample.html#y5gfunc.filter.resample.nn2x">nn2x</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply light anti-aliasing to input video clip. Suitable for recent non-descalable anime.</p>
<p>The function first doubles the resolution of the input clip with <code>doubler</code>, then downscales back with SSIM_downsample.
Chroma planes are not touched.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.double_aa(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.double_aa(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input video clip.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.double_aa(mask)" class="doc doc-heading doc-heading-parameter">                  <code>mask</code>
<a href="#y5gfunc.expr.test_atan2.double_aa(mask)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="vstools.vs.VideoNode">VideoNode</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, will be used as mask to merge anti-aliased clip and source clip. Otherwise, Prewitt mask is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.double_aa(doubler)" class="doc doc-heading doc-heading-parameter">                  <code>doubler</code>
<a href="#y5gfunc.expr.test_atan2.double_aa(doubler)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>[[<span title="vstools.vs.VideoNode">VideoNode</span>], <span title="vstools.vs.VideoNode">VideoNode</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to double the clip.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            nn2x (y5gfunc.filter.resample.nn2x)" href="../filter/resample.html#y5gfunc.filter.resample.nn2x">nn2x</a></code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    Anti-aliased input video clip.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/aa.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="k">def</span><span class="w"> </span><span class="nf">double_aa</span><span class="p">(</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">doubler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">],</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="n">nn2x</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Apply light anti-aliasing to input video clip. Suitable for recent non-descalable anime.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    The function first doubles the resolution of the input clip with `doubler`, then downscales back with SSIM_downsample.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Chroma planes are not touched.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        clip: Input video clip.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        mask: If provided, will be used as mask to merge anti-aliased clip and source clip. Otherwise, Prewitt mask is used.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        doubler: Function to double the clip.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        Anti-aliased input video clip.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">MaskedMerge</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>            <span class="n">depth</span><span class="p">(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>                <span class="n">SSIM_downsample</span><span class="p">(</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>                    <span class="n">doubler</span><span class="p">(</span><span class="n">get_y</span><span class="p">(</span><span class="n">clip</span><span class="p">)),</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>                    <span class="n">width</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>                    <span class="n">height</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                    <span class="n">src_left</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                    <span class="n">src_top</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>                <span class="p">),</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="p">),</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>            <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="p">),</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="n">mask</span> <span class="ow">or</span> <span class="n">maximum</span><span class="p">(</span><span class="n">prewitt</span><span class="p">(</span><span class="n">clip</span><span class="p">)),</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="n">first_plane</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.is_optimized_cpu" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">is_optimized_cpu</span>


<a href="#y5gfunc.expr.test_atan2.is_optimized_cpu" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">is_optimized_cpu</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/filter/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_optimized_cpu</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">machine</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">machine</span><span class="p">()</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">if</span> <span class="s2">&quot;arm64&quot;</span> <span class="ow">or</span> <span class="s2">&quot;x86_64&quot;</span> <span class="ow">in</span> <span class="n">machine</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_line" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_line</span>


<a href="#y5gfunc.expr.test_atan2.draw_line" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_line</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_line(clip))" href="#y5gfunc.expr.test_atan2.draw_line(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sx (y5gfunc.expr.test_atan2.draw_line(sx))" href="#y5gfunc.expr.test_atan2.draw_line(sx)">sx</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sy (y5gfunc.expr.test_atan2.draw_line(sy))" href="#y5gfunc.expr.test_atan2.draw_line(sy)">sy</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="ex (y5gfunc.expr.test_atan2.draw_line(ex))" href="#y5gfunc.expr.test_atan2.draw_line(ex)">ex</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="ey (y5gfunc.expr.test_atan2.draw_line(ey))" href="#y5gfunc.expr.test_atan2.draw_line(ey)">ey</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="thickness (y5gfunc.expr.test_atan2.draw_line(thickness))" href="#y5gfunc.expr.test_atan2.draw_line(thickness)">thickness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_line(color))" href="#y5gfunc.expr.test_atan2.draw_line(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="factor (y5gfunc.expr.test_atan2.draw_line(factor))" href="#y5gfunc.expr.test_atan2.draw_line(factor)">factor</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a line on a video clip.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw the line on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(sx)" class="doc doc-heading doc-heading-parameter">                  <code>sx</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(sx)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the start point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(sy)" class="doc doc-heading doc-heading-parameter">                  <code>sy</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(sy)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the start point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(ex)" class="doc doc-heading doc-heading-parameter">                  <code>ex</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(ex)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the end point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(ey)" class="doc doc-heading doc-heading-parameter">                  <code>ey</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(ey)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the end point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(thickness)" class="doc doc-heading doc-heading-parameter">                  <code>thickness</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(thickness)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thickness of the line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The color of the line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_line(factor)" class="doc doc-heading doc-heading-parameter">                  <code>factor</code>
<a href="#y5gfunc.expr.test_atan2.draw_line(factor)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The factor of the line.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the line drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the format of the video clip has more than 1 plane.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_line</span><span class="p">(</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">sx</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">sy</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">ex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">ey</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">thickness</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Draw a line on a video clip.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        clip: The video clip to draw the line on.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        sx: The x-coordinate of the start point.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        sy: The y-coordinate of the start point.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        ex: The x-coordinate of the end point.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        ey: The y-coordinate of the end point.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        thickness: The thickness of the line.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        color: The color of the line.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        factor: The factor of the line.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        The video clip with the line drawn on it.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        AssertionError: If the format of the video clip has more than 1 plane.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="s2">            sx = </span><span class="si">{</span><span class="n">sx</span><span class="si">}</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="s2">            sy = </span><span class="si">{</span><span class="n">sy</span><span class="si">}</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="s2">            ex = </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="s2">            ey = </span><span class="si">{</span><span class="n">ey</span><span class="si">}</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="s2">            thickness = </span><span class="si">{</span><span class="n">thickness</span><span class="si">}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="s2">            color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="s2">            factor = </span><span class="si">{</span><span class="n">factor</span><span class="si">}</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="s2">            dx = ex - sx</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="s2">            dy = ey - sy</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="s2">            L2 = (ex - sx) * dx + dy ** 2</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="s2">            half_thickness = thickness / 2</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="s2">            half_thickness_sq = half_thickness ** 2</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="s2">            tt = (($X - sx) * dx + ($Y - sy) * dy) / L2</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="s2">            tt = clamp(tt, 0, 1)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="s2">            proj_x = sx + tt * dx</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="s2">            proj_y = sy + tt * dy</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="s2">            d2 = ($X - proj_x) * ($X - proj_x) + ($Y - proj_y) * ($Y - proj_y)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="s2">            do = d2 &lt;= half_thickness_sq</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="s2">            RESULT = do ? ((1 - factor) * $src0 + factor * color) : $src0</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="s2">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_circle" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_circle</span>


<a href="#y5gfunc.expr.test_atan2.draw_circle" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_circle</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_circle(clip))" href="#y5gfunc.expr.test_atan2.draw_circle(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="cx (y5gfunc.expr.test_atan2.draw_circle(cx))" href="#y5gfunc.expr.test_atan2.draw_circle(cx)">cx</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="cy (y5gfunc.expr.test_atan2.draw_circle(cy))" href="#y5gfunc.expr.test_atan2.draw_circle(cy)">cy</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="radius (y5gfunc.expr.test_atan2.draw_circle(radius))" href="#y5gfunc.expr.test_atan2.draw_circle(radius)">radius</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="thickness (y5gfunc.expr.test_atan2.draw_circle(thickness))" href="#y5gfunc.expr.test_atan2.draw_circle(thickness)">thickness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_circle(color))" href="#y5gfunc.expr.test_atan2.draw_circle(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="factor (y5gfunc.expr.test_atan2.draw_circle(factor))" href="#y5gfunc.expr.test_atan2.draw_circle(factor)">factor</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a circle on a video clip.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw the circle on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(cx)" class="doc doc-heading doc-heading-parameter">                  <code>cx</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(cx)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the circle's center.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(cy)" class="doc doc-heading doc-heading-parameter">                  <code>cy</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(cy)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the circle's center.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(radius)" class="doc doc-heading doc-heading-parameter">                  <code>radius</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(radius)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The radius of the circle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(thickness)" class="doc doc-heading doc-heading-parameter">                  <code>thickness</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(thickness)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thickness of the circle's line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The color of the circle.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_circle(factor)" class="doc doc-heading doc-heading-parameter">                  <code>factor</code>
<a href="#y5gfunc.expr.test_atan2.draw_circle(factor)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The blending factor for the color.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the circle drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the format of the video clip has more than 1 plane.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_circle</span><span class="p">(</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="n">cx</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="n">cy</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">radius</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">thickness</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    Draw a circle on a video clip.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        clip: The video clip to draw the circle on.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        cx: The x-coordinate of the circle&#39;s center.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        cy: The y-coordinate of the circle&#39;s center.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        radius: The radius of the circle.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        thickness: The thickness of the circle&#39;s line.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        color: The color of the circle.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        factor: The blending factor for the color.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        The video clip with the circle drawn on it.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        AssertionError: If the format of the video clip has more than 1 plane.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="s2">            cx = </span><span class="si">{</span><span class="n">cx</span><span class="si">}</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="s2">            cy = </span><span class="si">{</span><span class="n">cy</span><span class="si">}</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="s2">            radius = </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="s2">            thickness = </span><span class="si">{</span><span class="n">thickness</span><span class="si">}</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="s2">            color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="s2">            factor = </span><span class="si">{</span><span class="n">factor</span><span class="si">}</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="s2">            half_thickness = thickness / 2</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="s2">            dx = $X - cx</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="s2">            dy = $Y - cy</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="s2">            distance_sq = dx ** 2 + dy ** 2</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="s2">            radius_minus_half = radius - half_thickness</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="s2">            lower_sq = radius_minus_half ** 2</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="s2">            lower_sq = max(lower_sq, 0)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="s2">            upper_sq = (radius + half_thickness) ** 2</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="s2">            do = distance_sq &gt;= lower_sq &amp;&amp; distance_sq &lt;= upper_sq</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="s2">            RESULT = do ? ((1 - factor) * $src0 + factor * color) : $src0</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="s2">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>    <span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_ellipse" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_ellipse</span>


<a href="#y5gfunc.expr.test_atan2.draw_ellipse" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_ellipse</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_ellipse(clip))" href="#y5gfunc.expr.test_atan2.draw_ellipse(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="f1x (y5gfunc.expr.test_atan2.draw_ellipse(f1x))" href="#y5gfunc.expr.test_atan2.draw_ellipse(f1x)">f1x</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="f1y (y5gfunc.expr.test_atan2.draw_ellipse(f1y))" href="#y5gfunc.expr.test_atan2.draw_ellipse(f1y)">f1y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="f2x (y5gfunc.expr.test_atan2.draw_ellipse(f2x))" href="#y5gfunc.expr.test_atan2.draw_ellipse(f2x)">f2x</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="f2y (y5gfunc.expr.test_atan2.draw_ellipse(f2y))" href="#y5gfunc.expr.test_atan2.draw_ellipse(f2y)">f2y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="ellipse_sum (y5gfunc.expr.test_atan2.draw_ellipse(ellipse_sum))" href="#y5gfunc.expr.test_atan2.draw_ellipse(ellipse_sum)">ellipse_sum</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="thickness (y5gfunc.expr.test_atan2.draw_ellipse(thickness))" href="#y5gfunc.expr.test_atan2.draw_ellipse(thickness)">thickness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_ellipse(color))" href="#y5gfunc.expr.test_atan2.draw_ellipse(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="factor (y5gfunc.expr.test_atan2.draw_ellipse(factor))" href="#y5gfunc.expr.test_atan2.draw_ellipse(factor)">factor</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw an ellipse on a video clip, defined by its two focal points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw the ellipse on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(f1x)" class="doc doc-heading doc-heading-parameter">                  <code>f1x</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(f1x)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the first focal point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(f1y)" class="doc doc-heading doc-heading-parameter">                  <code>f1y</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(f1y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the first focal point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(f2x)" class="doc doc-heading doc-heading-parameter">                  <code>f2x</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(f2x)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the second focal point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(f2y)" class="doc doc-heading doc-heading-parameter">                  <code>f2y</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(f2y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the second focal point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(ellipse_sum)" class="doc doc-heading doc-heading-parameter">                  <code>ellipse_sum</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(ellipse_sum)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sum of the distances from any point on the ellipse to the two focal points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(thickness)" class="doc doc-heading doc-heading-parameter">                  <code>thickness</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(thickness)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thickness of the ellipse's line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The color of the ellipse.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_ellipse(factor)" class="doc doc-heading doc-heading-parameter">                  <code>factor</code>
<a href="#y5gfunc.expr.test_atan2.draw_ellipse(factor)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The blending factor for the color.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the ellipse drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the format of the video clip has more than 1 plane.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_ellipse</span><span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">f1x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">f1y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">f2x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">f2y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">ellipse_sum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">thickness</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">    Draw an ellipse on a video clip, defined by its two focal points.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        clip: The video clip to draw the ellipse on.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        f1x: The x-coordinate of the first focal point.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        f1y: The y-coordinate of the first focal point.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        f2x: The x-coordinate of the second focal point.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        f2y: The y-coordinate of the second focal point.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        ellipse_sum: The sum of the distances from any point on the ellipse to the two focal points.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        thickness: The thickness of the ellipse&#39;s line.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        color: The color of the ellipse.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        factor: The blending factor for the color.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        The video clip with the ellipse drawn on it.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        AssertionError: If the format of the video clip has more than 1 plane.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="s2">            f1x = </span><span class="si">{</span><span class="n">f1x</span><span class="si">}</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="s2">            f1y = </span><span class="si">{</span><span class="n">f1y</span><span class="si">}</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="s2">            f2x = </span><span class="si">{</span><span class="n">f2x</span><span class="si">}</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="s2">            f2y = </span><span class="si">{</span><span class="n">f2y</span><span class="si">}</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="s2">            ellipse_sum = </span><span class="si">{</span><span class="n">ellipse_sum</span><span class="si">}</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="s2">            thickness = </span><span class="si">{</span><span class="n">thickness</span><span class="si">}</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="s2">            color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="s2">            factor = </span><span class="si">{</span><span class="n">factor</span><span class="si">}</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="s2">            cx = (f1x + f2x) / 2</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="s2">            cy = (f1y + f2y) / 2</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="s2">            aa = ellipse_sum / 2</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="s2">            a2 = aa ** 2</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="s2">            dx = f2x - f1x</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="s2">            dy = f2y - f1y</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="s2">            c2 = (dx ** 2 + dy ** 2) / 4</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="s2">            b2 = a2 - c2</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="s2">            value = (($X - cx) ** 2) / a2 + (($Y - cy) ** 2) / b2</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="s2">            norm_thresh = thickness / ellipse_sum</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="s2">            do = abs(value - 1) &lt;= norm_thresh</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="s2">            RESULT = do ? ((1 - factor) * $src0 + factor * color) : $src0</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="s2">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="p">)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_bezier_curve" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_bezier_curve</span>


<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_bezier_curve</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_bezier_curve(clip))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint0X (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0X))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0X)">controlPoint0X</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint0Y (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0Y))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0Y)">controlPoint0Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint1X (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1X))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1X)">controlPoint1X</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint1Y (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1Y))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1Y)">controlPoint1Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint2X (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2X))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2X)">controlPoint2X</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint2Y (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2Y))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2Y)">controlPoint2Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint3X (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3X))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3X)">controlPoint3X</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="controlPoint3Y (y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3Y))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3Y)">controlPoint3Y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="thickness (y5gfunc.expr.test_atan2.draw_bezier_curve(thickness))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(thickness)">thickness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_bezier_curve(color))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sample_count (y5gfunc.expr.test_atan2.draw_bezier_curve(sample_count))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(sample_count)">sample_count</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="factor (y5gfunc.expr.test_atan2.draw_bezier_curve(factor))" href="#y5gfunc.expr.test_atan2.draw_bezier_curve(factor)">factor</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a cubic Bezier curve on a video clip.</p>
<p>The curve is defined by four control points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw the curve on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0X)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint0X</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0X)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the first control point (start).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0Y)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint0Y</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint0Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the first control point (start).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1X)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint1X</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1X)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the second control point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1Y)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint1Y</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint1Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the second control point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2X)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint2X</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2X)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the third control point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2Y)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint2Y</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint2Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the third control point.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3X)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint3X</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3X)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the fourth control point (end).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3Y)" class="doc doc-heading doc-heading-parameter">                  <code>controlPoint3Y</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(controlPoint3Y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the fourth control point (end).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(thickness)" class="doc doc-heading doc-heading-parameter">                  <code>thickness</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(thickness)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thickness of the curve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The color of the curve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(sample_count)" class="doc doc-heading doc-heading-parameter">                  <code>sample_count</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(sample_count)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of line segments to approximate the curve.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_bezier_curve(factor)" class="doc doc-heading doc-heading-parameter">                  <code>factor</code>
<a href="#y5gfunc.expr.test_atan2.draw_bezier_curve(factor)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The blending factor for the color.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the Bezier curve drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>sample_count</code> is less than 2 or if the clip has more than one plane.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_bezier_curve</span><span class="p">(</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">controlPoint0X</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">controlPoint0Y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">controlPoint1X</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">controlPoint1Y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="n">controlPoint2X</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>    <span class="n">controlPoint2Y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="n">controlPoint3X</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="n">controlPoint3Y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">thickness</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="n">sample_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    Draw a cubic Bezier curve on a video clip.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    The curve is defined by four control points.</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        clip: The video clip to draw the curve on.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        controlPoint0X: The x-coordinate of the first control point (start).</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        controlPoint0Y: The y-coordinate of the first control point (start).</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        controlPoint1X: The x-coordinate of the second control point.</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        controlPoint1Y: The y-coordinate of the second control point.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        controlPoint2X: The x-coordinate of the third control point.</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        controlPoint2Y: The y-coordinate of the third control point.</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        controlPoint3X: The x-coordinate of the fourth control point (end).</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        controlPoint3Y: The y-coordinate of the fourth control point (end).</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        thickness: The thickness of the curve.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        color: The color of the curve.</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        sample_count: The number of line segments to approximate the curve.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        factor: The blending factor for the color.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        The video clip with the Bezier curve drawn on it.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        AssertionError: If `sample_count` is less than 2 or if the clip has more than one plane.</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">assert</span> <span class="n">sample_count</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">expr_lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint0X = </span><span class="si">{</span><span class="n">controlPoint0X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint0Y = </span><span class="si">{</span><span class="n">controlPoint0Y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint1X = </span><span class="si">{</span><span class="n">controlPoint1X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint1Y = </span><span class="si">{</span><span class="n">controlPoint1Y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint2X = </span><span class="si">{</span><span class="n">controlPoint2X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint2Y = </span><span class="si">{</span><span class="n">controlPoint2Y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint3X = </span><span class="si">{</span><span class="n">controlPoint3X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;controlPoint3Y = </span><span class="si">{</span><span class="n">controlPoint3Y</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;thickness = </span><span class="si">{</span><span class="n">thickness</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;factor = </span><span class="si">{</span><span class="n">factor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;halfThickness = thickness / 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;halfThicknessSquared = halfThickness ** 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">total_samples</span> <span class="o">=</span> <span class="n">sample_count</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">for</span> <span class="n">sample_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_samples</span><span class="p">):</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">t_value</span> <span class="o">=</span> <span class="n">sample_index</span> <span class="o">/</span> <span class="p">(</span><span class="n">total_samples</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parameterT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">t_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;oneMinusT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = 1 - parameterT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>            <span class="sa">f</span><span class="s2">&quot;oneMinusT_squared_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = oneMinusT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> ** 2&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="p">)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="sa">f</span><span class="s2">&quot;oneMinusT_cubed_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = oneMinusT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> ** 3&quot;</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="p">)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="sa">f</span><span class="s2">&quot;parameterT_squared_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = parameterT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> ** 2&quot;</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="sa">f</span><span class="s2">&quot;parameterT_cubed_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = parameterT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> ** 3&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="sa">f</span><span class="s2">&quot;bezierX_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = oneMinusT_cubed_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint0X + &quot;</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="sa">f</span><span class="s2">&quot;3 * oneMinusT_squared_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * parameterT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint1X + &quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="sa">f</span><span class="s2">&quot;3 * oneMinusT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * parameterT_squared_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint2X + &quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="sa">f</span><span class="s2">&quot;parameterT_cubed_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint3X&quot;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="sa">f</span><span class="s2">&quot;bezierY_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> = oneMinusT_cubed_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint0Y + &quot;</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="sa">f</span><span class="s2">&quot;3 * oneMinusT_squared_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * parameterT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint1Y + &quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="sa">f</span><span class="s2">&quot;3 * oneMinusT_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * parameterT_squared_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint2Y + &quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="sa">f</span><span class="s2">&quot;parameterT_cubed_</span><span class="si">{</span><span class="n">sample_index</span><span class="si">}</span><span class="s2"> * controlPoint3Y&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="n">segment_distance_squared_expressions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">for</span> <span class="n">seg_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_samples</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="sa">f</span><span class="s2">&quot;deltaX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = bezierX_</span><span class="si">{</span><span class="n">seg_index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - bezierX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="sa">f</span><span class="s2">&quot;deltaY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = bezierY_</span><span class="si">{</span><span class="n">seg_index</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - bezierY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="sa">f</span><span class="s2">&quot;segmentLengthSquared_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = deltaX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> * deltaX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> + deltaY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> * deltaY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="sa">f</span><span class="s2">&quot;tSegment_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = (($X - bezierX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">) * deltaX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> + ($Y - bezierY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">) * deltaY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">) / segmentLengthSquared_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="p">)</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tClamped_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = clamp(tSegment_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">, 0, 1)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="sa">f</span><span class="s2">&quot;projectionX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = bezierX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> + tClamped_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> * deltaX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="sa">f</span><span class="s2">&quot;projectionY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = bezierY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> + tClamped_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> * deltaY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="sa">f</span><span class="s2">&quot;distanceSquared_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2"> = ($X - projectionX_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">) ** 2 + ($Y - projectionY_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">) ** 2)&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">segment_distance_squared_expressions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;distanceSquared_</span><span class="si">{</span><span class="n">seg_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">distance_arguments</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">segment_distance_squared_expressions</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;finalMinDistanceSquared = nth_1(</span><span class="si">{</span><span class="n">distance_arguments</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;doDraw = finalMinDistanceSquared &lt;= halfThicknessSquared&quot;</span><span class="p">)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="s2">&quot;RESULT = doDraw ? ((1 - factor) * $src0 + factor * color) : $src0&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="n">full_expression</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_lines</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="n">converted_expression</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">full_expression</span><span class="p">)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">converted_expression</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_mandelbrot_zoomer</span>


<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_mandelbrot_zoomer</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(clip))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="centerX (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerX))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerX)">centerX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="centerY (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerY))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerY)">centerY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(color))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="initialZoom (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(initialZoom))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(initialZoom)">initialZoom</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0.005&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="zoomSpeed (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(zoomSpeed))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(zoomSpeed)">zoomSpeed</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0.01&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="centerMoveSpeed (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerMoveSpeed))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerMoveSpeed)">centerMoveSpeed</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0.01&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fractalC0_re (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_re))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_re)">fractalC0_re</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;-0.75&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fractalC0_im (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_im))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_im)">fractalC0_im</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fractalC1_re (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_re))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_re)">fractalC1_re</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;-0.743643887037158704&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fractalC1_im (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_im))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_im)">fractalC1_im</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0.131825904205311130&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="maxIter (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(maxIter))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(maxIter)">maxIter</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="escapeRadius (y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(escapeRadius))" href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(escapeRadius)">escapeRadius</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a zooming animation into the Mandelbrot set.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerX)" class="doc doc-heading doc-heading-parameter">                  <code>centerX</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate for the center of the fractal on screen.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerY)" class="doc doc-heading doc-heading-parameter">                  <code>centerY</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate for the center of the fractal on screen.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The base color for the fractal rendering.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(initialZoom)" class="doc doc-heading doc-heading-parameter">                  <code>initialZoom</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(initialZoom)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The initial zoom level.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0.005&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(zoomSpeed)" class="doc doc-heading doc-heading-parameter">                  <code>zoomSpeed</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(zoomSpeed)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The speed of zooming in.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0.01&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerMoveSpeed)" class="doc doc-heading doc-heading-parameter">                  <code>centerMoveSpeed</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(centerMoveSpeed)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The speed at which the center of the view moves from C0 to C1.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0.01&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_re)" class="doc doc-heading doc-heading-parameter">                  <code>fractalC0_re</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_re)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The real part of the starting complex number for the center.</p>
              </div>
            </td>
            <td>
                  <code>&#39;-0.75&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_im)" class="doc doc-heading doc-heading-parameter">                  <code>fractalC0_im</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC0_im)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The imaginary part of the starting complex number for the center.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0.1&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_re)" class="doc doc-heading doc-heading-parameter">                  <code>fractalC1_re</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_re)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The real part of the ending complex number for the center.</p>
              </div>
            </td>
            <td>
                  <code>&#39;-0.743643887037158704&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_im)" class="doc doc-heading doc-heading-parameter">                  <code>fractalC1_im</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(fractalC1_im)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The imaginary part of the ending complex number for the center.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0.131825904205311130&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(maxIter)" class="doc doc-heading doc-heading-parameter">                  <code>maxIter</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(maxIter)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of iterations for the Mandelbrot calculation.</p>
              </div>
            </td>
            <td>
                  <code>350</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(escapeRadius)" class="doc doc-heading doc-heading-parameter">                  <code>escapeRadius</code>
<a href="#y5gfunc.expr.test_atan2.draw_mandelbrot_zoomer(escapeRadius)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The escape radius for the Mandelbrot calculation.</p>
              </div>
            </td>
            <td>
                  <code>&#39;2&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the Mandelbrot animation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>maxIter</code> is less than 1.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_mandelbrot_zoomer</span><span class="p">(</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">centerX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">centerY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="n">initialZoom</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.005&quot;</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>    <span class="n">zoomSpeed</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>    <span class="n">centerMoveSpeed</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.01&quot;</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">fractalC0_re</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-0.75&quot;</span><span class="p">,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">fractalC0_im</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">fractalC1_re</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-0.743643887037158704&quot;</span><span class="p">,</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">fractalC1_im</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0.131825904205311130&quot;</span><span class="p">,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">maxIter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">escapeRadius</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    Draw a zooming animation into the Mandelbrot set.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        clip: The video clip to draw on.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        centerX: The x-coordinate for the center of the fractal on screen.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        centerY: The y-coordinate for the center of the fractal on screen.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        color: The base color for the fractal rendering.</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        initialZoom: The initial zoom level.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        zoomSpeed: The speed of zooming in.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        centerMoveSpeed: The speed at which the center of the view moves from C0 to C1.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        fractalC0_re: The real part of the starting complex number for the center.</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        fractalC0_im: The imaginary part of the starting complex number for the center.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        fractalC1_re: The real part of the ending complex number for the center.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        fractalC1_im: The imaginary part of the ending complex number for the center.</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        maxIter: The maximum number of iterations for the Mandelbrot calculation.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        escapeRadius: The escape radius for the Mandelbrot calculation.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        The video clip with the Mandelbrot animation.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        AssertionError: If `maxIter` is less than 1.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="k">assert</span> <span class="n">maxIter</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">expr_lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;centerX = </span><span class="si">{</span><span class="n">centerX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;centerY = </span><span class="si">{</span><span class="n">centerY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;initialZoom = </span><span class="si">{</span><span class="n">initialZoom</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;zoomSpeed = </span><span class="si">{</span><span class="n">zoomSpeed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;centerMoveSpeed = </span><span class="si">{</span><span class="n">centerMoveSpeed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;maxIter = </span><span class="si">{</span><span class="n">maxIter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;escapeRadius = </span><span class="si">{</span><span class="n">escapeRadius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;escapeSq = escapeRadius ** 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;scale = initialZoom * exp(-zoomSpeed * $N)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ff = 1 - exp(-centerMoveSpeed * $N)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C0_re = </span><span class="si">{</span><span class="n">fractalC0_re</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C0_im = </span><span class="si">{</span><span class="n">fractalC0_im</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C1_re = </span><span class="si">{</span><span class="n">fractalC1_re</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C1_im = </span><span class="si">{</span><span class="n">fractalC1_im</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dC_re = C0_re + (C1_re - C0_re) * ff&quot;</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;dC_im = C0_im + (C1_im - C0_im) * ff&quot;</span><span class="p">)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;c_re = ($X - centerX) * scale + dC_re&quot;</span><span class="p">)</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;c_im = ($Y - centerY) * scale + dC_im&quot;</span><span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;z_re_0 = 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;z_im_0 = 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxIter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">prev</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="sa">f</span><span class="s2">&quot;z_re_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = (z_re_</span><span class="si">{</span><span class="n">prev</span><span class="si">}</span><span class="s2"> * z_re_</span><span class="si">{</span><span class="n">prev</span><span class="si">}</span><span class="s2"> - z_im_</span><span class="si">{</span><span class="n">prev</span><span class="si">}</span><span class="s2"> * z_im_</span><span class="si">{</span><span class="n">prev</span><span class="si">}</span><span class="s2"> + c_re)&quot;</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>        <span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;z_im_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = (2 * z_re_</span><span class="si">{</span><span class="n">prev</span><span class="si">}</span><span class="s2"> * z_im_</span><span class="si">{</span><span class="n">prev</span><span class="si">}</span><span class="s2"> + c_im)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;r2_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = (z_re_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> * z_re_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> + z_im_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> * z_im_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="n">iter_expr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">maxIter</span><span class="p">)</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxIter</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">iter_expr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(r2_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> &gt; escapeSq ? </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">iter_expr</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;iterResult = &quot;</span> <span class="o">+</span> <span class="n">iter_expr</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;RESULT = (iterResult / maxIter) * color&quot;</span><span class="p">)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="n">full_expr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_lines</span><span class="p">)</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="n">converted_expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">full_expr</span><span class="p">)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">converted_expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_spiral" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_spiral</span>


<a href="#y5gfunc.expr.test_atan2.draw_spiral" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_spiral</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_spiral(clip))" href="#y5gfunc.expr.test_atan2.draw_spiral(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="centerX (y5gfunc.expr.test_atan2.draw_spiral(centerX))" href="#y5gfunc.expr.test_atan2.draw_spiral(centerX)">centerX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="centerY (y5gfunc.expr.test_atan2.draw_spiral(centerY))" href="#y5gfunc.expr.test_atan2.draw_spiral(centerY)">centerY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="a (y5gfunc.expr.test_atan2.draw_spiral(a))" href="#y5gfunc.expr.test_atan2.draw_spiral(a)">a</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="b (y5gfunc.expr.test_atan2.draw_spiral(b))" href="#y5gfunc.expr.test_atan2.draw_spiral(b)">b</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="startAngle (y5gfunc.expr.test_atan2.draw_spiral(startAngle))" href="#y5gfunc.expr.test_atan2.draw_spiral(startAngle)">startAngle</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="endAngle (y5gfunc.expr.test_atan2.draw_spiral(endAngle))" href="#y5gfunc.expr.test_atan2.draw_spiral(endAngle)">endAngle</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="thickness (y5gfunc.expr.test_atan2.draw_spiral(thickness))" href="#y5gfunc.expr.test_atan2.draw_spiral(thickness)">thickness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_spiral(color))" href="#y5gfunc.expr.test_atan2.draw_spiral(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="factor (y5gfunc.expr.test_atan2.draw_spiral(factor))" href="#y5gfunc.expr.test_atan2.draw_spiral(factor)">factor</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="sample_count (y5gfunc.expr.test_atan2.draw_spiral(sample_count))" href="#y5gfunc.expr.test_atan2.draw_spiral(sample_count)">sample_count</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a spiral on a video clip.</p>
<p>The spiral is defined by the equation r = a + b * theta.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw the spiral on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(centerX)" class="doc doc-heading doc-heading-parameter">                  <code>centerX</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(centerX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the spiral's center.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(centerY)" class="doc doc-heading doc-heading-parameter">                  <code>centerY</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(centerY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the spiral's center.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(a)" class="doc doc-heading doc-heading-parameter">                  <code>a</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(a)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 'a' parameter in the spiral equation, affecting the starting radius.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(b)" class="doc doc-heading doc-heading-parameter">                  <code>b</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(b)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 'b' parameter in the spiral equation, affecting the distance between arms.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(startAngle)" class="doc doc-heading doc-heading-parameter">                  <code>startAngle</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(startAngle)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The starting angle of the spiral in radians.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(endAngle)" class="doc doc-heading doc-heading-parameter">                  <code>endAngle</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(endAngle)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ending angle of the spiral in radians.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(thickness)" class="doc doc-heading doc-heading-parameter">                  <code>thickness</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(thickness)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thickness of the spiral line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The color of the spiral.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(factor)" class="doc doc-heading doc-heading-parameter">                  <code>factor</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(factor)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The blending factor for the color.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_spiral(sample_count)" class="doc doc-heading doc-heading-parameter">                  <code>sample_count</code>
<a href="#y5gfunc.expr.test_atan2.draw_spiral(sample_count)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of line segments to approximate the spiral.</p>
              </div>
            </td>
            <td>
                  <code>500</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the spiral drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the format of the video clip has more than 1 plane.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_spiral</span><span class="p">(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="n">centerX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="n">centerY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>    <span class="n">b</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="n">startAngle</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="n">endAngle</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">thickness</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">sample_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">    Draw a spiral on a video clip.</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    The spiral is defined by the equation r = a + b * theta.</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">        clip: The video clip to draw the spiral on.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">        centerX: The x-coordinate of the spiral&#39;s center.</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">        centerY: The y-coordinate of the spiral&#39;s center.</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        a: The &#39;a&#39; parameter in the spiral equation, affecting the starting radius.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">        b: The &#39;b&#39; parameter in the spiral equation, affecting the distance between arms.</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        startAngle: The starting angle of the spiral in radians.</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        endAngle: The ending angle of the spiral in radians.</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        thickness: The thickness of the spiral line.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        color: The color of the spiral.</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        factor: The blending factor for the color.</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        sample_count: The number of line segments to approximate the spiral.</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        The video clip with the spiral drawn on it.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        AssertionError: If the format of the video clip has more than 1 plane.</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>    <span class="n">expr_lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;centerX = </span><span class="si">{</span><span class="n">centerX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;centerY = </span><span class="si">{</span><span class="n">centerY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;aa = </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;bb = </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;startAngle = </span><span class="si">{</span><span class="n">startAngle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;endAngle = </span><span class="si">{</span><span class="n">endAngle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;thickness = </span><span class="si">{</span><span class="n">thickness</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;factor = </span><span class="si">{</span><span class="n">factor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;halfThickness = thickness / 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;halfThicknessSquared = halfThickness ** 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sample_count</span><span class="p">):</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tt = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> / (</span><span class="si">{</span><span class="n">sample_count</span><span class="si">}</span><span class="s2"> - 1)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;theta = startAngle + tt * (endAngle - startAngle)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;rr = aa + bb * theta&quot;</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;spiralX = centerX + rr * cos(theta)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;spiralY = centerY + rr * sin(theta)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;spiralX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = spiralX&quot;</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;spiralY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = spiralY&quot;</span><span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">segment_distance_exprs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sample_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;deltaX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = spiralX_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - spiralX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;deltaY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = spiralY_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - spiralY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="sa">f</span><span class="s2">&quot;segmentLengthSquared_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = deltaX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> * deltaX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> + deltaY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> * deltaY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>        <span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="sa">f</span><span class="s2">&quot;t_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = (($X - spiralX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">) * deltaX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> + ($Y - spiralY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">) * deltaY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">) / segmentLengthSquared_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>        <span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tClamped_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = clamp(t_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, 0, 1)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;projectionX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = spiralX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> + tClamped_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> * deltaX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;projectionY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = spiralY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> + tClamped_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> * deltaY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="sa">f</span><span class="s2">&quot;distanceSquared_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = ($X - projectionX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">) ** 2 + ($Y - projectionY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">) ** 2&quot;</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">segment_distance_exprs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;distanceSquared_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="s2">&quot;finalMinDistanceSquared = nth_1(&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">segment_distance_exprs</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;doDraw = finalMinDistanceSquared &lt;= halfThicknessSquared&quot;</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="s2">&quot;RESULT = doDraw ? ((1 - factor) * $src0 + factor * color) : $src0&quot;</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="n">full_expr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_lines</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="n">converted_expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">full_expr</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">converted_expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">draw_3d_polyhedron</span>


<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">draw_3d_polyhedron</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.draw_3d_polyhedron(clip))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="shape (y5gfunc.expr.test_atan2.draw_3d_polyhedron(shape))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(shape)">shape</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a></span><span class="p">[</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span> <span class="s1">&#39;icosahedron&#39;</span><span class="p">,</span> <span class="s1">&#39;tetrahedron&#39;</span><span class="p">,</span> <span class="s1">&#39;octahedron&#39;</span><span class="p">,</span> <span class="s1">&#39;dodecahedron&#39;</span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="centerX (y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerX))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerX)">centerX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="centerY (y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerY))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerY)">centerY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="size (y5gfunc.expr.test_atan2.draw_3d_polyhedron(size))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(size)">size</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="color (y5gfunc.expr.test_atan2.draw_3d_polyhedron(color))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(color)">color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotationX (y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationX))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationX)">rotationX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotationY (y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationY))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationY)">rotationY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="thickness (y5gfunc.expr.test_atan2.draw_3d_polyhedron(thickness))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(thickness)">thickness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="translateZ (y5gfunc.expr.test_atan2.draw_3d_polyhedron(translateZ))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(translateZ)">translateZ</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;500&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="focal (y5gfunc.expr.test_atan2.draw_3d_polyhedron(focal))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(focal)">focal</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;500&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="factor (y5gfunc.expr.test_atan2.draw_3d_polyhedron(factor))" href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(factor)">factor</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Draw a 3D regular polyhedron on a video clip.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to draw the polyhedron on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(shape)" class="doc doc-heading doc-heading-parameter">                  <code>shape</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(shape)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;cube&#39;, &#39;icosahedron&#39;, &#39;tetrahedron&#39;, &#39;octahedron&#39;, &#39;dodecahedron&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The shape of the polyhedron.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerX)" class="doc doc-heading doc-heading-parameter">                  <code>centerX</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the center of the projection screen.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerY)" class="doc doc-heading doc-heading-parameter">                  <code>centerY</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(centerY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the center of the projection screen.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(size)" class="doc doc-heading doc-heading-parameter">                  <code>size</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(size)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the polyhedron.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(color)" class="doc doc-heading doc-heading-parameter">                  <code>color</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The color of the polyhedron's edges.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationX)" class="doc doc-heading doc-heading-parameter">                  <code>rotationX</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rotation angle around the X-axis (in radians).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationY)" class="doc doc-heading doc-heading-parameter">                  <code>rotationY</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(rotationY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rotation angle around the Y-axis (in radians).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(thickness)" class="doc doc-heading doc-heading-parameter">                  <code>thickness</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(thickness)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The thickness of the polyhedron's edges.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(translateZ)" class="doc doc-heading doc-heading-parameter">                  <code>translateZ</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(translateZ)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The translation along the Z-axis, affecting perspective.</p>
              </div>
            </td>
            <td>
                  <code>&#39;500&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(focal)" class="doc doc-heading doc-heading-parameter">                  <code>focal</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(focal)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The focal length for the projection.</p>
              </div>
            </td>
            <td>
                  <code>&#39;500&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.draw_3d_polyhedron(factor)" class="doc doc-heading doc-heading-parameter">                  <code>factor</code>
<a href="#y5gfunc.expr.test_atan2.draw_3d_polyhedron(factor)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The blending factor for the color.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the 3D polyhedron drawn on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the format of the video clip has more than 1 plane.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_3d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">draw_3d_polyhedron</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;cube&quot;</span><span class="p">,</span> <span class="s2">&quot;icosahedron&quot;</span><span class="p">,</span> <span class="s2">&quot;tetrahedron&quot;</span><span class="p">,</span> <span class="s2">&quot;octahedron&quot;</span><span class="p">,</span> <span class="s2">&quot;dodecahedron&quot;</span><span class="p">],</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">centerX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">centerY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">size</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">rotationX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">rotationY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">thickness</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">translateZ</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;500&quot;</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">focal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;500&quot;</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">factor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Draw a 3D regular polyhedron on a video clip.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        clip: The video clip to draw the polyhedron on.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        shape: The shape of the polyhedron.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        centerX: The x-coordinate of the center of the projection screen.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        centerY: The y-coordinate of the center of the projection screen.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        size: The size of the polyhedron.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        color: The color of the polyhedron&#39;s edges.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        rotationX: The rotation angle around the X-axis (in radians).</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        rotationY: The rotation angle around the Y-axis (in radians).</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        thickness: The thickness of the polyhedron&#39;s edges.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        translateZ: The translation along the Z-axis, affecting perspective.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        focal: The focal length for the projection.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        factor: The blending factor for the color.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        The video clip with the 3D polyhedron drawn on it.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        AssertionError: If the format of the video clip has more than 1 plane.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">assert</span> <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">num_planes</span> <span class="o">==</span> <span class="mi">1</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">PHI</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">PSI</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">PHI</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">_POLYHEDRA_DATA</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="s2">&quot;cube&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="p">],</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>                <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>            <span class="p">],</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="p">},</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="s2">&quot;icosahedron&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>            <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                <span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                <span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                <span class="p">(</span><span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                <span class="p">(</span><span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="p">],</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="p">],</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="p">},</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="s2">&quot;tetrahedron&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="p">],</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>            <span class="p">],</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="p">},</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="s2">&quot;octahedron&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="p">],</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="p">],</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="p">},</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="s2">&quot;dodecahedron&quot;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;psi&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;psi&quot;</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-psi&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-psi&quot;</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;psi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="p">(</span><span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-psi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="p">(</span><span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;psi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="p">(</span><span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-psi&quot;</span><span class="p">),</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                <span class="p">(</span><span class="s2">&quot;psi&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="p">(</span><span class="s2">&quot;psi&quot;</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="p">(</span><span class="s2">&quot;-psi&quot;</span><span class="p">,</span> <span class="s2">&quot;phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="p">(</span><span class="s2">&quot;-psi&quot;</span><span class="p">,</span> <span class="s2">&quot;-phi&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="s2">&quot;edges&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>                <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">),</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="p">],</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="p">},</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="p">}</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">_POLYHEDRA_DATA</span><span class="p">[</span><span class="n">shape</span><span class="p">]</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">vertices_coords</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;vertices&quot;</span><span class="p">]</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">edges</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;edges&quot;</span><span class="p">]</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">expr_parts</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="s2">        centerX = </span><span class="si">{</span><span class="n">centerX</span><span class="si">}</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="s2">        centerY = </span><span class="si">{</span><span class="n">centerY</span><span class="si">}</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="s2">        size = </span><span class="si">{</span><span class="n">size</span><span class="si">}</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="s2">        rotationX = </span><span class="si">{</span><span class="n">rotationX</span><span class="si">}</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="s2">        rotationY = </span><span class="si">{</span><span class="n">rotationY</span><span class="si">}</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="s2">        translateZ = </span><span class="si">{</span><span class="n">translateZ</span><span class="si">}</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="s2">        focal = </span><span class="si">{</span><span class="n">focal</span><span class="si">}</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="s2">        thickness = </span><span class="si">{</span><span class="n">thickness</span><span class="si">}</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="s2">        color = </span><span class="si">{</span><span class="n">color</span><span class="si">}</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="s2">        factor = </span><span class="si">{</span><span class="n">factor</span><span class="si">}</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="s2">        halfSize = size / 2</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="s2">        phi = </span><span class="si">{</span><span class="n">PHI</span><span class="si">}</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="s2">        psi = </span><span class="si">{</span><span class="n">PSI</span><span class="si">}</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="s2">        cos_rotationX = cos(rotationX)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="s2">        sin_rotationX = sin(rotationX)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="s2">        cos_rotationY = cos(rotationY)</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="s2">        sin_rotationY = sin(rotationY)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="s2">        &lt;global&lt;cos_rotationX&gt;&lt;sin_rotationX&gt;&lt;cos_rotationY&gt;&lt;sin_rotationY&gt;&lt;translateZ&gt;&lt;centerX&gt;&lt;focal&gt;&gt;</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="s2">        function project3d_x(vx, vy, vz) </span><span class="se">{{</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="s2">            vy1 = vy * cos_rotationX - vz * sin_rotationX</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="s2">            vz1 = vy * sin_rotationX + vz * cos_rotationX</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="s2">            vx1 = vx</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="s2">            vx2 = vx1 * cos_rotationY + vz1 * sin_rotationY</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="s2">            vz2 = -vx1 * sin_rotationY + vz1 * cos_rotationY</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="s2">            vy2 = vy1</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="s2">            vz_final = vz2 + translateZ</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="s2">            return centerX + (vx2 * focal) / vz_final</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="s2">        </span><span class="se">}}</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="s2">        &lt;global&lt;cos_rotationX&gt;&lt;sin_rotationX&gt;&lt;cos_rotationY&gt;&lt;sin_rotationY&gt;&lt;translateZ&gt;&lt;centerY&gt;&lt;focal&gt;&gt;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="s2">        function project3d_y(vx, vy, vz) </span><span class="se">{{</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="s2">            vy1 = vy * cos_rotationX - vz * sin_rotationX</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="s2">            vz1 = vy * sin_rotationX + vz * cos_rotationX</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="s2">            vx1 = vx</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="s2">            vx2 = vx1 * cos_rotationY + vz1 * sin_rotationY</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="s2">            vz2 = -vx1 * sin_rotationY + vz1 * cos_rotationY</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="s2">            vy2 = vy1</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="s2">            vz_final = vz2 + translateZ</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a><span class="s2">            return centerY + (vy2 * focal) / vz_final</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="s2">        </span><span class="se">}}</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="s2">        function distSqToSegment(x0, y0, x1, y1) </span><span class="se">{{</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="s2">            dx = x1 - x0</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="s2">            dy = y1 - y0</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="s2">            segLenSq = dx ** 2 + dy ** 2</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="s2">            tt = (($X - x0) * dx + ($Y - y0) * dy) / segLenSq</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="s2">            t_clamped = clamp(tt, 0, 1)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="s2">            projX = x0 + t_clamped * dx</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="s2">            projY = y0 + t_clamped * dy</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="s2">            return ($X - projX) ** 2 + ($Y - projY) ** 2</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="s2">        </span><span class="se">}}</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="p">]</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vertices_coords</span><span class="p">):</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">x = (</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">) * halfSize&quot;</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">y = (</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">) * halfSize&quot;</span><span class="p">)</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">z = (</span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">) * halfSize&quot;</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices_coords</span><span class="p">)):</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">projX = project3d_x(v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">x, v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">y, v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">projY = project3d_y(v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">x, v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">y, v</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="n">dist_vars</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">edges</span><span class="p">):</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="n">dist_var</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;d</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">dist_vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist_var</span><span class="p">)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dist_var</span><span class="si">}</span><span class="s2"> = distSqToSegment(v</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">projX, v</span><span class="si">{</span><span class="n">v1</span><span class="si">}</span><span class="s2">projY, v</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">projX, v</span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s2">projY)&quot;</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="p">)</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">min_expr</span> <span class="o">=</span> <span class="n">dist_vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist_vars</span><span class="p">)):</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">min_expr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;min(</span><span class="si">{</span><span class="n">min_expr</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">dist_vars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;finalMinDistanceSquared = </span><span class="si">{</span><span class="n">min_expr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">expr_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        halfThickness = thickness / 2</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        halfThicknessSq = halfThickness ** 2</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        doDraw = finalMinDistanceSquared &lt;= halfThicknessSq</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        RESULT = doDraw ? ((1 - factor) * $src0 + factor * color) : $src0</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="n">full_expr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_parts</span><span class="p">)</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">full_expr</span><span class="p">)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.render_triangle_scene" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">render_triangle_scene</span>


<a href="#y5gfunc.expr.test_atan2.render_triangle_scene" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">render_triangle_scene</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.render_triangle_scene(clip))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="points (y5gfunc.expr.test_atan2.render_triangle_scene(points))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(points)">points</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="faces (y5gfunc.expr.test_atan2.render_triangle_scene(faces))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(faces)">faces</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="lights (y5gfunc.expr.test_atan2.render_triangle_scene(lights))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(lights)">lights</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="camX (y5gfunc.expr.test_atan2.render_triangle_scene(camX))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(camX)">camX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="camY (y5gfunc.expr.test_atan2.render_triangle_scene(camY))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(camY)">camY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="camZ (y5gfunc.expr.test_atan2.render_triangle_scene(camZ))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(camZ)">camZ</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotationX (y5gfunc.expr.test_atan2.render_triangle_scene(rotationX))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(rotationX)">rotationX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotationY (y5gfunc.expr.test_atan2.render_triangle_scene(rotationY))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(rotationY)">rotationY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="focal (y5gfunc.expr.test_atan2.render_triangle_scene(focal))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(focal)">focal</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="background (y5gfunc.expr.test_atan2.render_triangle_scene(background))" href="#y5gfunc.expr.test_atan2.render_triangle_scene(background)">background</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Renders a scene composed of triangles on a video clip.</p>
<p>This function performs 3D rendering of a mesh of triangles with lighting and camera transformations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to render on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(points)" class="doc doc-heading doc-heading-parameter">                  <code>points</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(points)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, each representing a vertex in the scene.
    Each dictionary should have "x", "y", and "z" keys.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(faces)" class="doc doc-heading doc-heading-parameter">                  <code>faces</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(faces)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, each representing a triangle. Each should
   have "a", "b", "c" keys (indices to the points list) and an
   optional "color" key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(lights)" class="doc doc-heading doc-heading-parameter">                  <code>lights</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(lights)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, each representing a directional (parallel) light.
    This type of light has a direction but no position, and its
    intensity does not decay with distance. Each dictionary should have
    "lx", "ly", "lz" for direction and "intensity".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(camX)" class="doc doc-heading doc-heading-parameter">                  <code>camX</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(camX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera's X position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(camY)" class="doc doc-heading doc-heading-parameter">                  <code>camY</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(camY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera's Y position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(camZ)" class="doc doc-heading doc-heading-parameter">                  <code>camZ</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(camZ)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera's Z position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(rotationX)" class="doc doc-heading doc-heading-parameter">                  <code>rotationX</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(rotationX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera's rotation around the X-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(rotationY)" class="doc doc-heading doc-heading-parameter">                  <code>rotationY</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(rotationY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera's rotation around the Y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(focal)" class="doc doc-heading doc-heading-parameter">                  <code>focal</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(focal)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera's focal length.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_triangle_scene(background)" class="doc doc-heading doc-heading-parameter">                  <code>background</code>
<a href="#y5gfunc.expr.test_atan2.render_triangle_scene(background)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The background color value.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A video clip with the 3D scene rendered on it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">clip</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">BlankClip</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">640</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">GRAYS</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">orig_points</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span>  <span class="p">},</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span>  <span class="p">},</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span>  <span class="p">},</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span>  <span class="p">},</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="p">{</span> <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span>  <span class="s2">&quot;z&quot;</span> <span class="p">:</span> <span class="s2">&quot;-100&quot;</span> <span class="p">}</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">transformed_points</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">orig_points</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">new_pt</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;((</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) * cos($N * 0.02) - (</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) * sin($N * 0.02) + 20 * sin($N * 0.015))&quot;</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;((</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) + 20 * cos($N * 0.015))&quot;</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;((</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) * sin($N * 0.02) + (</span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) * cos($N * 0.02))&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="p">}</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">transformed_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_pt</span><span class="p">)</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">faces</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span>   <span class="p">},</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span>   <span class="p">},</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.8&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.8&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.9&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.9&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;1.0&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;1.0&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;1.1&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;1.1&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.7&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="p">{</span> <span class="s2">&quot;a&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.7&quot;</span> <span class="p">}</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="p">]</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="n">lights</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>    <span class="p">{</span> <span class="s2">&quot;lx&quot;</span> <span class="p">:</span> <span class="s2">&quot;cos($N * 0.02)&quot;</span><span class="p">,</span> <span class="s2">&quot;ly&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;lz&quot;</span> <span class="p">:</span> <span class="s2">&quot;sin($N * 0.02)&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.8&quot;</span> <span class="p">},</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="p">{</span> <span class="s2">&quot;lx&quot;</span> <span class="p">:</span> <span class="s2">&quot;-0.5&quot;</span><span class="p">,</span>          <span class="s2">&quot;ly&quot;</span> <span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>   <span class="s2">&quot;lz&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>           <span class="s2">&quot;intensity&quot;</span> <span class="p">:</span> <span class="s2">&quot;0.6&quot;</span> <span class="p">}</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="p">]</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="n">camX</span> <span class="o">=</span> <span class="s2">&quot;20 * sin(241 * 0.015) + 500 * cos(241 * 0.01)&quot;</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="n">camY</span> <span class="o">=</span> <span class="s2">&quot;20 * cos(241 * 0.015) + 200 + 4 - 2 * abs($N % 8 - 4)&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="n">camZ</span> <span class="o">=</span> <span class="s2">&quot;500 * sin(241 * 0.01) - 4 - 2 * abs($N % 8 - 4)&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="n">rotationX</span> <span class="o">=</span> <span class="s2">&quot;0.38 + (40 - 2 * abs($N % 80 - 40)) / 500&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="n">rotationY</span> <span class="o">=</span> <span class="s2">&quot;-2.41&quot;</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="n">focal</span> <span class="o">=</span> <span class="s2">&quot;500&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="n">clip_result</span> <span class="o">=</span> <span class="n">render_triangle_scene</span><span class="p">(</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>    <span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>    <span class="n">points</span><span class="o">=</span><span class="n">transformed_points</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>    <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">,</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    <span class="n">lights</span><span class="o">=</span><span class="n">lights</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a>    <span class="n">camX</span><span class="o">=</span><span class="n">camX</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>    <span class="n">camY</span><span class="o">=</span><span class="n">camY</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a>    <span class="n">camZ</span><span class="o">=</span><span class="n">camZ</span><span class="p">,</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a>    <span class="n">rotationX</span><span class="o">=</span><span class="n">rotationX</span><span class="p">,</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>    <span class="n">rotationY</span><span class="o">=</span><span class="n">rotationY</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>    <span class="n">focal</span><span class="o">=</span><span class="n">focal</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>    <span class="n">background</span><span class="o">=</span><span class="s2">&quot;0&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="p">)</span>
</code></pre></div>
<p>Renders a rotating and vibrating cubic.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_3d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="k">def</span><span class="w"> </span><span class="nf">render_triangle_scene</span><span class="p">(</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">faces</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">lights</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">camX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="n">camY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">camZ</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="n">rotationX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="n">rotationY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="n">focal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="n">background</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    Renders a scene composed of triangles on a video clip.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">    This function performs 3D rendering of a mesh of triangles with lighting and camera transformations.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        clip: The video clip to render on.</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        points: A list of dictionaries, each representing a vertex in the scene.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">                Each dictionary should have &quot;x&quot;, &quot;y&quot;, and &quot;z&quot; keys.</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        faces: A list of dictionaries, each representing a triangle. Each should</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">               have &quot;a&quot;, &quot;b&quot;, &quot;c&quot; keys (indices to the points list) and an</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">               optional &quot;color&quot; key.</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        lights: A list of dictionaries, each representing a directional (parallel) light.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">                This type of light has a direction but no position, and its</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">                intensity does not decay with distance. Each dictionary should have</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">                &quot;lx&quot;, &quot;ly&quot;, &quot;lz&quot; for direction and &quot;intensity&quot;.</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        camX: The camera&#39;s X position.</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        camY: The camera&#39;s Y position.</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        camZ: The camera&#39;s Z position.</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        rotationX: The camera&#39;s rotation around the X-axis.</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        rotationY: The camera&#39;s rotation around the Y-axis.</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        focal: The camera&#39;s focal length.</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        background: The background color value.</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        A video clip with the 3D scene rendered on it.</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    clip = core.std.BlankClip(width=640, height=480, format=vs.GRAYS, length=12000)</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    orig_points = [</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        { &quot;x&quot; : &quot;-100&quot;, &quot;y&quot; : &quot;-100&quot;, &quot;z&quot; : &quot;100&quot;  },</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        { &quot;x&quot; : &quot;100&quot;,  &quot;y&quot; : &quot;-100&quot;, &quot;z&quot; : &quot;100&quot;  },</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        { &quot;x&quot; : &quot;100&quot;,  &quot;y&quot; : &quot;100&quot;,  &quot;z&quot; : &quot;100&quot;  },</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        { &quot;x&quot; : &quot;-100&quot;, &quot;y&quot; : &quot;100&quot;,  &quot;z&quot; : &quot;100&quot;  },</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        { &quot;x&quot; : &quot;-100&quot;, &quot;y&quot; : &quot;-100&quot;, &quot;z&quot; : &quot;-100&quot; },</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        { &quot;x&quot; : &quot;100&quot;,  &quot;y&quot; : &quot;-100&quot;, &quot;z&quot; : &quot;-100&quot; },</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        { &quot;x&quot; : &quot;100&quot;,  &quot;y&quot; : &quot;100&quot;,  &quot;z&quot; : &quot;-100&quot; },</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        { &quot;x&quot; : &quot;-100&quot;, &quot;y&quot; : &quot;100&quot;,  &quot;z&quot; : &quot;-100&quot; }</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">    ]</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    transformed_points = []</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    for pt in orig_points:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        new_pt = {</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            &quot;x&quot;: f&quot;(({pt[&#39;x&#39;]}) * cos($N * 0.02) - ({pt[&#39;z&#39;]}) * sin($N * 0.02) + 20 * sin($N * 0.015))&quot;,</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            &quot;y&quot;: f&quot;(({pt[&#39;y&#39;]}) + 20 * cos($N * 0.015))&quot;,</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            &quot;z&quot;: f&quot;(({pt[&#39;x&#39;]}) * sin($N * 0.02) + ({pt[&#39;z&#39;]}) * cos($N * 0.02))&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        }</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        transformed_points.append(new_pt)</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    faces = [</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        { &quot;a&quot; : 0, &quot;b&quot; : 1, &quot;c&quot; : 2, &quot;color&quot; : &quot;1&quot;   },</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        { &quot;a&quot; : 0, &quot;b&quot; : 2, &quot;c&quot; : 3, &quot;color&quot; : &quot;1&quot;   },</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        { &quot;a&quot; : 4, &quot;b&quot; : 6, &quot;c&quot; : 5, &quot;color&quot; : &quot;0.8&quot; },</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        { &quot;a&quot; : 4, &quot;b&quot; : 7, &quot;c&quot; : 6, &quot;color&quot; : &quot;0.8&quot; },</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        { &quot;a&quot; : 0, &quot;b&quot; : 3, &quot;c&quot; : 7, &quot;color&quot; : &quot;0.9&quot; },</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        { &quot;a&quot; : 0, &quot;b&quot; : 7, &quot;c&quot; : 4, &quot;color&quot; : &quot;0.9&quot; },</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        { &quot;a&quot; : 1, &quot;b&quot; : 5, &quot;c&quot; : 6, &quot;color&quot; : &quot;1.0&quot; },</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        { &quot;a&quot; : 1, &quot;b&quot; : 6, &quot;c&quot; : 2, &quot;color&quot; : &quot;1.0&quot; },</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        { &quot;a&quot; : 3, &quot;b&quot; : 2, &quot;c&quot; : 6, &quot;color&quot; : &quot;1.1&quot; },</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        { &quot;a&quot; : 3, &quot;b&quot; : 6, &quot;c&quot; : 7, &quot;color&quot; : &quot;1.1&quot; },</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        { &quot;a&quot; : 0, &quot;b&quot; : 4, &quot;c&quot; : 5, &quot;color&quot; : &quot;0.7&quot; },</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        { &quot;a&quot; : 0, &quot;b&quot; : 5, &quot;c&quot; : 1, &quot;color&quot; : &quot;0.7&quot; }</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">    ]</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">    lights = [</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">        { &quot;lx&quot; : &quot;cos($N * 0.02)&quot;, &quot;ly&quot; : &quot;0.5&quot;, &quot;lz&quot; : &quot;sin($N * 0.02)&quot;, &quot;intensity&quot; : &quot;0.8&quot; },</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        { &quot;lx&quot; : &quot;-0.5&quot;,          &quot;ly&quot; : &quot;1&quot;,   &quot;lz&quot; : &quot;0.5&quot;,           &quot;intensity&quot; : &quot;0.6&quot; }</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">    ]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    camX = &quot;20 * sin(241 * 0.015) + 500 * cos(241 * 0.01)&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    camY = &quot;20 * cos(241 * 0.015) + 200 + 4 - 2 * abs($N % 8 - 4)&quot;</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">    camZ = &quot;500 * sin(241 * 0.01) - 4 - 2 * abs($N % 8 - 4)&quot;</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    rotationX = &quot;0.38 + (40 - 2 * abs($N % 80 - 40)) / 500&quot;</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    rotationY = &quot;-2.41&quot;</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">    focal = &quot;500&quot;</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    clip_result = render_triangle_scene(</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        clip,</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">        points=transformed_points,</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">        faces=faces,</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">        lights=lights,</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">        camX=camX,</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">        camY=camY,</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">        camZ=camZ,</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">        rotationX=rotationX,</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">        rotationY=rotationY,</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        focal=focal,</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">        background=&quot;0&quot;</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">    )</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">    ```</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">    Renders a rotating and vibrating cubic.</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>    <span class="n">expr_lines</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="s2">&quot;&lt;global&lt;camX&gt;&lt;camY&gt;&lt;camZ&gt;&lt;rotationX&gt;&lt;rotationY&gt;&lt;focal&gt;&lt;screenCenterX&gt;&lt;screenCenterY&gt;&lt;epsilon&gt;&gt;&quot;</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>    <span class="p">)</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;function cam_coord_x(x, y, z) {&quot;</span><span class="p">)</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tx = x - camX&quot;</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    ty = y - camY&quot;</span><span class="p">)</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tz = z - camZ&quot;</span><span class="p">)</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    ty1 = ty * cos(rotationX) - tz * sin(rotationX)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tz1 = ty * sin(rotationX) + tz * cos(rotationX)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    cx = tx * cos(rotationY) + tz1 * sin(rotationY)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    return cx&quot;</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="s2">&quot;&lt;global&lt;camX&gt;&lt;camY&gt;&lt;camZ&gt;&lt;rotationX&gt;&lt;rotationY&gt;&lt;focal&gt;&lt;screenCenterX&gt;&lt;screenCenterY&gt;&lt;epsilon&gt;&gt;&quot;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="p">)</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;function cam_coord_y(x, y, z) {&quot;</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    ty = y - camY&quot;</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tz = z - camZ&quot;</span><span class="p">)</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    cy = ty * cos(rotationX) - tz * sin(rotationX)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    return cy&quot;</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;global&lt;camX&gt;&lt;camY&gt;&lt;camZ&gt;&lt;rotationX&gt;&lt;rotationY&gt;&lt;epsilon&gt;&lt;huge&gt;&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;function cam_coord_z(x, y, z) {&quot;</span><span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tx = x - camX&quot;</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    ty = y - camY&quot;</span><span class="p">)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tz = z - camZ&quot;</span><span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    ty1 = ty * cos(rotationX) - tz * sin(rotationX)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    tz1 = ty * sin(rotationX) + tz * cos(rotationX)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    cz = -tx * sin(rotationY) + tz1 * cos(rotationY)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    return cz &lt; 0 ? huge : cz&quot;</span><span class="p">)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;global&lt;focal&gt;&lt;screenCenterX&gt;&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;function projectX(x, y, z) {&quot;</span><span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    px = cam_coord_x(x, y, z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    pz = cam_coord_z(x, y, z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    return screenCenterX + (px * focal) / pz&quot;</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&lt;global&lt;focal&gt;&lt;screenCenterY&gt;&gt;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;function projectY(x, y, z) {&quot;</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    py = cam_coord_y(x, y, z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    pz = cam_coord_z(x, y, z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;    return screenCenterY + (py * focal) / pz&quot;</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;camX = </span><span class="si">{</span><span class="n">camX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;camY = </span><span class="si">{</span><span class="n">camY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;camZ = </span><span class="si">{</span><span class="n">camZ</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rotationX = </span><span class="si">{</span><span class="n">rotationX</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rotationY = </span><span class="si">{</span><span class="n">rotationY</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;focal = </span><span class="si">{</span><span class="n">focal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;background = </span><span class="si">{</span><span class="n">background</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;screenCenterX = $width / 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;screenCenterY = $height / 2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;epsilon = 0.0001&quot;</span><span class="p">)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;huge = 1e9&quot;</span><span class="p">)</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ambient = 0.2&quot;</span><span class="p">)</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">light</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lights</span><span class="p">):</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_x = </span><span class="si">{</span><span class="n">light</span><span class="p">[</span><span class="s1">&#39;lx&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_y = </span><span class="si">{</span><span class="n">light</span><span class="p">[</span><span class="s1">&#39;ly&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_z = </span><span class="si">{</span><span class="n">light</span><span class="p">[</span><span class="s1">&#39;lz&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_intensity = </span><span class="si">{</span><span class="n">light</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="sa">f</span><span class="s2">&quot;mag_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> = sqrt(light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_x ** 2 + light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_y ** 2 + light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_z ** 2)&quot;</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_nx = light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_x / mag_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_ny = light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_y / mag_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_nz = light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_raw_z / mag_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>            <span class="sa">f</span><span class="s2">&quot;temp_ty_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> = light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_ny * cos(rotationX) - light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_nz * sin(rotationX)&quot;</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="sa">f</span><span class="s2">&quot;temp_tz_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> = light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_ny * sin(rotationX) + light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_nz * cos(rotationX)&quot;</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_lx = light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_nx * cos(rotationY) + temp_tz_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> * sin(rotationY)&quot;</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="p">)</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_ly = temp_ty_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>            <span class="sa">f</span><span class="s2">&quot;light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_lz = -light</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_nx * sin(rotationY) + temp_tz_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> * cos(rotationY)&quot;</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="p">)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">pt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_x = </span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_y = </span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_z = </span><span class="si">{</span><span class="n">pt</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;projX_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = projectX(point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_x, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_y, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;projY_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = projectY(point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_x, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_y, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_z)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="sa">f</span><span class="s2">&quot;cam_x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = cam_coord_x(point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_x, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_y, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_z)&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="p">)</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="sa">f</span><span class="s2">&quot;cam_y_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = cam_coord_y(point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_x, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_y, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_z)&quot;</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>        <span class="p">)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="sa">f</span><span class="s2">&quot;cam_z_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = cam_coord_z(point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_x, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_y, point</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_z)&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="n">face_t_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="n">face_shading_names</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="n">face_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">faces</span><span class="p">)</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="k">for</span> <span class="n">f_idx</span><span class="p">,</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">faces</span><span class="p">):</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="n">a_idx</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="n">b_idx</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="n">c_idx</span> <span class="o">=</span> <span class="n">face</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">face_color</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="sa">f</span><span class="s2">&quot;E0_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ($X - projX_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">) * (projY_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - projY_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">) - ($Y - projY_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">) * (projX_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - projX_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>        <span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="sa">f</span><span class="s2">&quot;E1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ($X - projX_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2">) * (projY_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - projY_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2">) - ($Y - projY_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2">) * (projX_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - projX_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="p">)</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="sa">f</span><span class="s2">&quot;E2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ($X - projX_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2">) * (projY_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2"> - projY_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2">) - ($Y - projY_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2">) * (projX_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2"> - projX_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>        <span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="sa">f</span><span class="s2">&quot;inside_pos_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = E0_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &gt;= 0 &amp;&amp; E1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &gt;= 0 &amp;&amp; E2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &gt;= 0&quot;</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>        <span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>            <span class="sa">f</span><span class="s2">&quot;inside_neg_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = E0_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &lt;= 0 &amp;&amp; E1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &lt;= 0 &amp;&amp; E2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &lt;= 0&quot;</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = (cam_z_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2"> &lt; huge) &amp;&amp; (cam_z_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> &lt; huge) &amp;&amp; (cam_z_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> &lt; huge)&quot;</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>        <span class="p">)</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="sa">f</span><span class="s2">&quot;inside_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = (inside_pos_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> || inside_neg_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">) &amp;&amp; valid_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="p">)</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="sa">f</span><span class="s2">&quot;area_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = (projX_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - projX_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">) * (projY_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - projY_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">) - (projX_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - projX_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">) * (projY_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - projY_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>            <span class="sa">f</span><span class="s2">&quot;alpha_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ((projX_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - $X) * (projY_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - $Y) - (projX_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - $X) * (projY_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - $Y)) / area_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>        <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>            <span class="sa">f</span><span class="s2">&quot;beta_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ((projX_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - $X) * (projY_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2"> - $Y) - (projX_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2"> - $X) * (projY_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - $Y)) / area_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gamma_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = 1 - alpha_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> - beta_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="sa">f</span><span class="s2">&quot;depth_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = alpha_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * cam_z_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2"> + beta_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * cam_z_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> + gamma_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * cam_z_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="p">)</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ex1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = cam_x_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - cam_x_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ey1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = cam_y_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - cam_y_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ez1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = cam_z_</span><span class="si">{</span><span class="n">b_idx</span><span class="si">}</span><span class="s2"> - cam_z_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ex2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = cam_x_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - cam_x_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ey2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = cam_y_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - cam_y_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ez2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = cam_z_</span><span class="si">{</span><span class="n">c_idx</span><span class="si">}</span><span class="s2"> - cam_z_</span><span class="si">{</span><span class="n">a_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="sa">f</span><span class="s2">&quot;nx_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ey1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * ez2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> - ez1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * ey2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>        <span class="p">)</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>            <span class="sa">f</span><span class="s2">&quot;ny_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ez1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * ex2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> - ex1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * ez2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="sa">f</span><span class="s2">&quot;nz_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ex1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * ey2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> - ey1_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * ex2_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>            <span class="sa">f</span><span class="s2">&quot;norm_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = sqrt(nx_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> ** 2 + ny_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> ** 2 + nz_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> ** 2)&quot;</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="p">)</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;nx_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = nx_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> / norm_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ny_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ny_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> / norm_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;nz_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = nz_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> / norm_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="k">for</span> <span class="n">l_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lights</span><span class="p">)):</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>            <span class="n">dot_expr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;nx_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * light</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2">_lx + ny_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * light</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2">_ly + nz_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * light</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2">_lz&quot;</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dot_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">dot_expr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2"> = max(dot_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2">, 0)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                <span class="sa">f</span><span class="s2">&quot;contrib_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2"> = diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2"> * light</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2">_intensity&quot;</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sum_diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = ambient&quot;</span><span class="p">)</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="k">for</span> <span class="n">l_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lights</span><span class="p">)):</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                <span class="sa">f</span><span class="s2">&quot;sum_diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = sum_diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> + contrib_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">l_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>            <span class="p">)</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>            <span class="sa">f</span><span class="s2">&quot;lighting_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = sum_diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> &gt; 1 ? 1 : sum_diffuse_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="p">)</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;faceColor_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">face_color</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shading_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = lighting_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> * faceColor_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>            <span class="sa">f</span><span class="s2">&quot;t_face_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = inside_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> == 1 ? depth_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> : huge&quot;</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="p">)</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>            <span class="sa">f</span><span class="s2">&quot;shading_face_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> = inside_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> == 1 ? shading_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2"> : 0&quot;</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="p">)</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>        <span class="n">face_t_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t_face_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="n">face_shading_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;shading_face_</span><span class="si">{</span><span class="n">f_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="k">if</span> <span class="n">face_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;closest_t_0 = t_face_0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;closest_shading_0 = shading_face_0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">face_count</span><span class="p">):</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>            <span class="n">prev_i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;is_closer_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = t_face_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> &lt; closest_t_</span><span class="si">{</span><span class="n">prev_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                <span class="sa">f</span><span class="s2">&quot;closest_t_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = is_closer_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> ? t_face_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> : closest_t_</span><span class="si">{</span><span class="n">prev_i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>            <span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>            <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                <span class="sa">f</span><span class="s2">&quot;closest_shading_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> = is_closer_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> ? shading_face_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> : closest_shading_</span><span class="si">{</span><span class="n">prev_i</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>            <span class="p">)</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">final_idx</span> <span class="o">=</span> <span class="n">face_count</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;final_t = closest_t_</span><span class="si">{</span><span class="n">final_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;final_shading = closest_shading_</span><span class="si">{</span><span class="n">final_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;RESULT = final_t &lt; huge ? final_shading : background&quot;</span><span class="p">)</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="n">expr_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;RESULT = background&quot;</span><span class="p">)</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>    <span class="n">full_expr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expr_lines</span><span class="p">)</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="n">converted_expr</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">full_expr</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">converted_expr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.render_model_scene" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">render_model_scene</span>


<a href="#y5gfunc.expr.test_atan2.render_model_scene" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">render_model_scene</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.render_model_scene(clip))" href="#y5gfunc.expr.test_atan2.render_model_scene(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="model_path (y5gfunc.expr.test_atan2.render_model_scene(model_path))" href="#y5gfunc.expr.test_atan2.render_model_scene(model_path)">model_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="lights (y5gfunc.expr.test_atan2.render_model_scene(lights))" href="#y5gfunc.expr.test_atan2.render_model_scene(lights)">lights</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="camX (y5gfunc.expr.test_atan2.render_model_scene(camX))" href="#y5gfunc.expr.test_atan2.render_model_scene(camX)">camX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="camY (y5gfunc.expr.test_atan2.render_model_scene(camY))" href="#y5gfunc.expr.test_atan2.render_model_scene(camY)">camY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="camZ (y5gfunc.expr.test_atan2.render_model_scene(camZ))" href="#y5gfunc.expr.test_atan2.render_model_scene(camZ)">camZ</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotationX (y5gfunc.expr.test_atan2.render_model_scene(rotationX))" href="#y5gfunc.expr.test_atan2.render_model_scene(rotationX)">rotationX</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotationY (y5gfunc.expr.test_atan2.render_model_scene(rotationY))" href="#y5gfunc.expr.test_atan2.render_model_scene(rotationY)">rotationY</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="focal (y5gfunc.expr.test_atan2.render_model_scene(focal))" href="#y5gfunc.expr.test_atan2.render_model_scene(focal)">focal</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="background (y5gfunc.expr.test_atan2.render_model_scene(background))" href="#y5gfunc.expr.test_atan2.render_model_scene(background)">background</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n"><a class="autorefs autorefs-internal" title="**mesh_kwargs (y5gfunc.expr.test_atan2.render_model_scene(**mesh_kwargs))" href="#y5gfunc.expr.test_atan2.render_model_scene(**mesh_kwargs)">mesh_kwargs</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Render a 3D model scene.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to render on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(model_path)" class="doc doc-heading doc-heading-parameter">                  <code>model_path</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(model_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the 3D model file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(lights)" class="doc doc-heading doc-heading-parameter">                  <code>lights</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(lights)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, each representing a <strong>directional (parallel) light</strong>.
    This type of light has a direction but no position, and its
    intensity does not decay with distance. Each dictionary should have
    "lx", "ly", "lz" for direction and "intensity".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(camX)" class="doc doc-heading doc-heading-parameter">                  <code>camX</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(camX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the camera position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(camY)" class="doc doc-heading doc-heading-parameter">                  <code>camY</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(camY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the camera position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(camZ)" class="doc doc-heading doc-heading-parameter">                  <code>camZ</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(camZ)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The z-coordinate of the camera position.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(rotationX)" class="doc doc-heading doc-heading-parameter">                  <code>rotationX</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(rotationX)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera rotation angle around the X-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(rotationY)" class="doc doc-heading doc-heading-parameter">                  <code>rotationY</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(rotationY)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The camera rotation angle around the Y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(focal)" class="doc doc-heading doc-heading-parameter">                  <code>focal</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(focal)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The focal length for the projection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(background)" class="doc doc-heading doc-heading-parameter">                  <code>background</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(background)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The background color.</p>
              </div>
            </td>
            <td>
                  <code>&#39;0&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.render_model_scene(**mesh_kwargs)" class="doc doc-heading doc-heading-parameter">                  <code>**mesh_kwargs</code>
<a href="#y5gfunc.expr.test_atan2.render_model_scene(**mesh_kwargs)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for <code>load_mesh</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip with the rendered 3D model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_3d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="k">def</span><span class="w"> </span><span class="nf">render_model_scene</span><span class="p">(</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>    <span class="n">model_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>    <span class="n">lights</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="n">camX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>    <span class="n">camY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>    <span class="n">camZ</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>    <span class="n">rotationX</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="n">rotationY</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>    <span class="n">focal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>    <span class="n">background</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>    <span class="o">**</span><span class="n">mesh_kwargs</span><span class="p">,</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a><span class="sd">    Render a 3D model scene.</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a><span class="sd">        clip: The video clip to render on.</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a><span class="sd">        model_path: The path to the 3D model file.</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a><span class="sd">        lights: A list of dictionaries, each representing a **directional (parallel) light**.</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a><span class="sd">                This type of light has a direction but no position, and its</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a><span class="sd">                intensity does not decay with distance. Each dictionary should have</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a><span class="sd">                &quot;lx&quot;, &quot;ly&quot;, &quot;lz&quot; for direction and &quot;intensity&quot;.</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a><span class="sd">        camX: The x-coordinate of the camera position.</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a><span class="sd">        camY: The y-coordinate of the camera position.</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a><span class="sd">        camZ: The z-coordinate of the camera position.</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a><span class="sd">        rotationX: The camera rotation angle around the X-axis.</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a><span class="sd">        rotationY: The camera rotation angle around the Y-axis.</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a><span class="sd">        focal: The focal length for the projection.</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a><span class="sd">        background: The background color.</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a><span class="sd">        **mesh_kwargs: Additional keyword arguments for `load_mesh`.</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a><span class="sd">        The video clip with the rendered 3D model.</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="n">points</span><span class="p">,</span> <span class="n">faces</span> <span class="o">=</span> <span class="n">load_mesh</span><span class="p">(</span><span class="n">model_path</span><span class="p">,</span> <span class="o">**</span><span class="n">mesh_kwargs</span><span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>    <span class="k">return</span> <span class="n">render_triangle_scene</span><span class="p">(</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="n">clip</span><span class="o">=</span><span class="n">clip</span><span class="p">,</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>        <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>        <span class="n">faces</span><span class="o">=</span><span class="n">faces</span><span class="p">,</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>        <span class="n">lights</span><span class="o">=</span><span class="n">lights</span><span class="p">,</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>        <span class="n">camX</span><span class="o">=</span><span class="n">camX</span><span class="p">,</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>        <span class="n">camY</span><span class="o">=</span><span class="n">camY</span><span class="p">,</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>        <span class="n">camZ</span><span class="o">=</span><span class="n">camZ</span><span class="p">,</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>        <span class="n">rotationX</span><span class="o">=</span><span class="n">rotationX</span><span class="p">,</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>        <span class="n">rotationY</span><span class="o">=</span><span class="n">rotationY</span><span class="p">,</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="n">focal</span><span class="o">=</span><span class="n">focal</span><span class="p">,</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>        <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.load_mesh" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_mesh</span>


<a href="#y5gfunc.expr.test_atan2.load_mesh" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_mesh</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="file_path (y5gfunc.expr.test_atan2.load_mesh(file_path))" href="#y5gfunc.expr.test_atan2.load_mesh(file_path)">file_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="default_color (y5gfunc.expr.test_atan2.load_mesh(default_color))" href="#y5gfunc.expr.test_atan2.load_mesh(default_color)">default_color</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="axis_transform (y5gfunc.expr.test_atan2.load_mesh(axis_transform))" href="#y5gfunc.expr.test_atan2.load_mesh(axis_transform)">axis_transform</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;+xz-y&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rotation (y5gfunc.expr.test_atan2.load_mesh(rotation))" href="#y5gfunc.expr.test_atan2.load_mesh(rotation)">rotation</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Load a 3D model from a file and apply transformations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_mesh(file_path)" class="doc doc-heading doc-heading-parameter">                  <code>file_path</code>
<a href="#y5gfunc.expr.test_atan2.load_mesh(file_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the model file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_mesh(default_color)" class="doc doc-heading doc-heading-parameter">                  <code>default_color</code>
<a href="#y5gfunc.expr.test_atan2.load_mesh(default_color)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default color for the model's faces.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_mesh(axis_transform)" class="doc doc-heading doc-heading-parameter">                  <code>axis_transform</code>
<a href="#y5gfunc.expr.test_atan2.load_mesh(axis_transform)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The axis transformation to apply. Supports "+xz-y" and "xyz".</p>
              </div>
            </td>
            <td>
                  <code>&#39;+xz-y&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_mesh(rotation)" class="doc doc-heading doc-heading-parameter">                  <code>rotation</code>
<a href="#y5gfunc.expr.test_atan2.load_mesh(rotation)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of (rx, ry, rz) rotation angles in degrees.</p>
              </div>
            </td>
            <td>
                  <code>(0.0, 0.0, 0.0)</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the list of points and the list of faces.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/draw_3d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_mesh</span><span class="p">(</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>    <span class="n">default_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>    <span class="n">axis_transform</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;+xz-y&quot;</span><span class="p">,</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="n">rotation</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]:</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">    Load a 3D model from a file and apply transformations.</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">        file_path: The path to the model file.</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a><span class="sd">        default_color: The default color for the model&#39;s faces.</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        axis_transform: The axis transformation to apply. Supports &quot;+xz-y&quot; and &quot;xyz&quot;.</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">        rotation: A tuple of (rx, ry, rz) rotation angles in degrees.</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a><span class="sd">        A tuple containing the list of points and the list of faces.</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">load_mesh</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="s2">&quot;mesh&quot;</span><span class="p">,</span> <span class="n">process</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">if</span> <span class="n">axis_transform</span> <span class="o">==</span> <span class="s2">&quot;+xz-y&quot;</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>    <span class="k">elif</span> <span class="n">axis_transform</span> <span class="o">==</span> <span class="s2">&quot;xyz&quot;</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>        <span class="k">pass</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>    <span class="k">if</span> <span class="n">rotation</span> <span class="o">!=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>        <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">rotation</span><span class="p">]</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>        <span class="n">R_x</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="n">R_y</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span><span class="n">ry</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="n">R_z</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span><span class="n">rz</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>        <span class="n">R</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">transformations</span><span class="o">.</span><span class="n">concatenate_matrices</span><span class="p">(</span><span class="n">R_z</span><span class="p">,</span> <span class="n">R_y</span><span class="p">,</span> <span class="n">R_x</span><span class="p">)</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>        <span class="n">mesh</span><span class="o">.</span><span class="n">apply_transform</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="n">points</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>        <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>    <span class="p">]</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="n">faces</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>    <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">faces</span><span class="p">:</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>        <span class="n">faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>            <span class="p">{</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>                <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">face</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>                <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">face</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>                <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">face</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>                <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">default_color</span><span class="p">,</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>            <span class="p">}</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>        <span class="p">)</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">faces</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.rotate_image" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">rotate_image</span>


<a href="#y5gfunc.expr.test_atan2.rotate_image" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">rotate_image</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.rotate_image(clip))" href="#y5gfunc.expr.test_atan2.rotate_image(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="angle_degrees (y5gfunc.expr.test_atan2.rotate_image(angle_degrees))" href="#y5gfunc.expr.test_atan2.rotate_image(angle_degrees)">angle_degrees</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="zoom (y5gfunc.expr.test_atan2.rotate_image(zoom))" href="#y5gfunc.expr.test_atan2.rotate_image(zoom)">zoom</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ZoomMode (y5gfunc.vfx.misc.ZoomMode)" href="../vfx/misc.html#y5gfunc.vfx.misc.ZoomMode">ZoomMode</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            NO_ZOOM


  
      class-attribute
      instance-attribute
   (y5gfunc.vfx.misc.ZoomMode.NO_ZOOM)" href="../vfx/misc.html#y5gfunc.vfx.misc.ZoomMode.NO_ZOOM">NO_ZOOM</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="bicubic_b (y5gfunc.expr.test_atan2.rotate_image(bicubic_b))" href="#y5gfunc.expr.test_atan2.rotate_image(bicubic_b)">bicubic_b</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1 / 3&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="bicubic_c (y5gfunc.expr.test_atan2.rotate_image(bicubic_c))" href="#y5gfunc.expr.test_atan2.rotate_image(bicubic_c)">bicubic_c</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;1 / 3&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="center_x (y5gfunc.expr.test_atan2.rotate_image(center_x))" href="#y5gfunc.expr.test_atan2.rotate_image(center_x)">center_x</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;$width / 2&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="center_y (y5gfunc.expr.test_atan2.rotate_image(center_y))" href="#y5gfunc.expr.test_atan2.rotate_image(center_y)">center_y</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">=</span> <span class="s1">&#39;$height / 2&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="boundary (y5gfunc.expr.test_atan2.rotate_image(boundary))" href="#y5gfunc.expr.test_atan2.rotate_image(boundary)">boundary</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            BoundaryMode (y5gfunc.vfx.misc.BoundaryMode)" href="../vfx/misc.html#y5gfunc.vfx.misc.BoundaryMode">BoundaryMode</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            CLAMPED


  
      class-attribute
      instance-attribute
   (y5gfunc.vfx.misc.BoundaryMode.CLAMPED)" href="../vfx/misc.html#y5gfunc.vfx.misc.BoundaryMode.CLAMPED">CLAMPED</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Rotate a video clip</p>
<p>This function rotates the given video clip by an angle specified in degrees. The rotation is
performed around a defined center point and uses bicubic interpolation for resampling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source video clip to rotate.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(angle_degrees)" class="doc doc-heading doc-heading-parameter">                  <code>angle_degrees</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(angle_degrees)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rotation angle in degrees, can be an expression to evaluate in run-time.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(zoom)" class="doc doc-heading doc-heading-parameter">                  <code>zoom</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(zoom)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ZoomMode (y5gfunc.vfx.misc.ZoomMode)" href="../vfx/misc.html#y5gfunc.vfx.misc.ZoomMode">ZoomMode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The zoom mode to apply.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            NO_ZOOM


  
      class-attribute
      instance-attribute
   (y5gfunc.vfx.misc.ZoomMode.NO_ZOOM)" href="../vfx/misc.html#y5gfunc.vfx.misc.ZoomMode.NO_ZOOM">NO_ZOOM</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(bicubic_b)" class="doc doc-heading doc-heading-parameter">                  <code>bicubic_b</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(bicubic_b)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 'b' parameter for bicubic interpolation.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1 / 3&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(bicubic_c)" class="doc doc-heading doc-heading-parameter">                  <code>bicubic_c</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(bicubic_c)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 'c' parameter for bicubic interpolation.</p>
              </div>
            </td>
            <td>
                  <code>&#39;1 / 3&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(center_x)" class="doc doc-heading doc-heading-parameter">                  <code>center_x</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(center_x)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The x-coordinate of the rotation center, can be an expression to evaluate in run-time</p>
              </div>
            </td>
            <td>
                  <code>&#39;$width / 2&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(center_y)" class="doc doc-heading doc-heading-parameter">                  <code>center_y</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(center_y)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The y-coordinate of the rotation center, can be an expression to evaluate in run-time</p>
              </div>
            </td>
            <td>
                  <code>&#39;$height / 2&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.rotate_image(boundary)" class="doc doc-heading doc-heading-parameter">                  <code>boundary</code>
<a href="#y5gfunc.expr.test_atan2.rotate_image(boundary)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            BoundaryMode (y5gfunc.vfx.misc.BoundaryMode)" href="../vfx/misc.html#y5gfunc.vfx.misc.BoundaryMode">BoundaryMode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boundary mode to handle pixels outside the frame.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            CLAMPED


  
      class-attribute
      instance-attribute
   (y5gfunc.vfx.misc.BoundaryMode.CLAMPED)" href="../vfx/misc.html#y5gfunc.vfx.misc.BoundaryMode.CLAMPED">CLAMPED</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rotated video clip.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/vfx/misc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="k">def</span><span class="w"> </span><span class="nf">rotate_image</span><span class="p">(</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">angle_degrees</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">zoom</span><span class="p">:</span> <span class="n">ZoomMode</span> <span class="o">=</span> <span class="n">ZoomMode</span><span class="o">.</span><span class="n">NO_ZOOM</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">bicubic_b</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1 / 3&quot;</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">bicubic_c</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;1 / 3&quot;</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">center_x</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;$width / 2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">center_y</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;$height / 2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">boundary</span><span class="p">:</span> <span class="n">BoundaryMode</span> <span class="o">=</span> <span class="n">BoundaryMode</span><span class="o">.</span><span class="n">CLAMPED</span><span class="p">,</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Rotate a video clip</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    This function rotates the given video clip by an angle specified in degrees. The rotation is</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    performed around a defined center point and uses bicubic interpolation for resampling.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        clip: The source video clip to rotate.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        angle_degrees: The rotation angle in degrees, can be an expression to evaluate in run-time.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        zoom: The zoom mode to apply.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        bicubic_b: The &#39;b&#39; parameter for bicubic interpolation.</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        bicubic_c: The &#39;c&#39; parameter for bicubic interpolation.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        center_x: The x-coordinate of the rotation center, can be an expression to evaluate in run-time</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        center_y: The y-coordinate of the rotation center, can be an expression to evaluate in run-time</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        boundary: The boundary mode to handle pixels outside the frame.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        The rotated video clip.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">setup</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="s2">        param_b  = </span><span class="si">{</span><span class="n">bicubic_b</span><span class="si">}</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="s2">        param_c = </span><span class="si">{</span><span class="n">bicubic_c</span><span class="si">}</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="s2">        &lt;global&lt;param_b&gt;&lt;param_c&gt;&gt;</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="s2">        function bicubic_weight(in) </span><span class="se">{{</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="s2">            ax = abs(in)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="s2">            ax2 = ax ** 2</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="s2">            ax3 = ax ** 3</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="s2">            term3_p1 = (12 - 9 * param_b - 6 * param_c) * ax3</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="s2">            term2_p1 = (-18 + 12 * param_b + 6 * param_c) * ax2</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="s2">            term0_p1 = (6 - 2 * param_b)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="s2">            part1 = (term3_p1 + term2_p1 + term0_p1) / 6</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="s2">            term3_p2 = (-param_b - 6 * param_c) * ax3</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="s2">            term2_p2 = (6 * param_b + 30 * param_c) * ax2</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="s2">            term1_p2 = (-12 * param_b - 48 * param_c) * ax</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="s2">            term0_p2 = (8 * param_b + 24 * param_c)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="s2">            part2 = (term3_p2 + term2_p2 + term1_p2 + term0_p2) / 6</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="s2">            result = (ax &lt; 1) ? part1 : (ax &lt; 2) ? part2 : 0</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="s2">            return result</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="s2">        </span><span class="se">}}</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="s2">        angle_degrees = </span><span class="si">{</span><span class="n">angle_degrees</span><span class="si">}</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="s2">        angle_rad = angle_degrees * $pi / 180</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="s2">        center_x = </span><span class="si">{</span><span class="n">center_x</span><span class="si">}</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="s2">        center_y = </span><span class="si">{</span><span class="n">center_y</span><span class="si">}</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="s2">        cos_a = cos(angle_rad)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="s2">        sin_a = sin(angle_rad)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="s2">        out_rel_x = $X - center_x</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="s2">        out_rel_y = $Y - center_y</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="k">if</span> <span class="n">zoom</span> <span class="o">==</span> <span class="n">ZoomMode</span><span class="o">.</span><span class="n">CONSTANT_MAX_ZOOM</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">source_coord_calc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="s2">            qq = 0.7071067811865476</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="s2">            w_bound_const = $width * qq + $height * qq</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="s2">            h_bound_const = $width * qq + $height * qq</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="s2">            shrink_scale = min($width / max(w_bound_const, 1e-9), $height / max(h_bound_const, 1e-9))</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="s2">            src_rel_x_unscaled = out_rel_x * cos_a + out_rel_y * sin_a</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="s2">            src_rel_y_unscaled = -out_rel_x * sin_a + out_rel_y * cos_a</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="s2">            final_src_rel_x = src_rel_x_unscaled * shrink_scale</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="s2">            final_src_rel_y = src_rel_y_unscaled * shrink_scale</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="s2">            source_x = final_src_rel_x + center_x</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="s2">            source_y = final_src_rel_y + center_y</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">elif</span> <span class="n">zoom</span> <span class="o">==</span> <span class="n">ZoomMode</span><span class="o">.</span><span class="n">ZOOM_TO_FIT</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">source_coord_calc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="s2">            ca = abs(cos_a)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="s2">            sa = abs(sin_a)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="s2">            w_bound = $width * ca + $height * sa</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="s2">            h_bound = $width * sa + $height * ca</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="s2">            shrink_scale_x = $width / max(w_bound, 1e-9)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="s2">            shrink_scale_y = $height / max(h_bound, 1e-9)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="s2">            shrink_scale = min(shrink_scale_x, shrink_scale_y)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="s2">            src_rel_x_unscaled = out_rel_x * cos_a + out_rel_y * sin_a</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="s2">            src_rel_y_unscaled = -out_rel_x * sin_a + out_rel_y * cos_a</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="s2">            final_src_rel_x = src_rel_x_unscaled * shrink_scale</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="s2">            final_src_rel_y = src_rel_y_unscaled * shrink_scale</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="s2">            source_x = final_src_rel_x + center_x</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="s2">            source_y = final_src_rel_y + center_y</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">source_coord_calc</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="s2">            final_src_rel_x = out_rel_x * cos_a + out_rel_y * sin_a</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="s2">            final_src_rel_y = -out_rel_x * sin_a + out_rel_y * cos_a</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="s2">            source_x = final_src_rel_x + center_x</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="s2">            source_y = final_src_rel_y + center_y</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="s2">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">interpolate</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="s2">        ix = floor(source_x)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="s2">        iy = floor(source_y)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="s2">        fx = source_x - ix</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="s2">        fy = source_y - iy</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="s2">        x_m1 = ix - 1</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="s2">        x0 = ix </span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="s2">        x1 = ix + 1 </span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="s2">        x2 = ix + 2</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="s2">        y_m1 = iy - 1 </span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="s2">        y0 = iy </span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="s2">        y1 = iy + 1 </span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="s2">        y2 = iy + 2</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="s2">        wx_m1 = bicubic_weight(fx + 1) </span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="s2">        wx0 = bicubic_weight(fx)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="s2">        wx1 = bicubic_weight(fx - 1) </span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="s2">        wx2 = bicubic_weight(fx - 2)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="s2">        wy_m1 = bicubic_weight(fy + 1) </span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="s2">        wy0 = bicubic_weight(fy)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="s2">        wy1 = bicubic_weight(fy - 1) </span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="s2">        wy2 = bicubic_weight(fy - 2)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="s2">        p_m1_m1 = dyn($src0, x_m1, y_m1) </span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="s2">        p0_m1 = dyn($src0, x0, y_m1)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="s2">        p1_m1 = dyn($src0, x1, y_m1)   </span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="s2">        p2_m1 = dyn($src0, x2, y_m1)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="s2">        p_m1_0 = dyn($src0, x_m1, y0)  </span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="s2">        p0_0 = dyn($src0, x0, y0)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="s2">        p1_0 = dyn($src0, x1, y0)    </span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="s2">        p2_0 = dyn($src0, x2, y0)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="s2">        p_m1_1 = dyn($src0, x_m1, y1)  </span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="s2">        p0_1 = dyn($src0, x0, y1)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="s2">        p1_1 = dyn($src0, x1, y1)    </span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="s2">        p2_1 = dyn($src0, x2, y1)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="s2">        p_m1_2 = dyn($src0, x_m1, y2)  </span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="s2">        p0_2 = dyn($src0, x0, y2)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="s2">        p1_2 = dyn($src0, x1, y2)    </span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="s2">        p2_2 = dyn($src0, x2, y2)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="s2">        row_m1 = p_m1_m1 * wx_m1 + p0_m1 * wx0 + p1_m1 * wx1 + p2_m1 * wx2</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="s2">        row_0  = p_m1_0 * wx_m1 + p0_0 * wx0 + p1_0 * wx1 + p2_0 * wx2</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="s2">        row_1  = p_m1_1 * wx_m1 + p0_1 * wx0 + p1_1 * wx1 + p2_1 * wx2</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="s2">        row_2  = p_m1_2 * wx_m1 + p0_2 * wx0 + p1_2 * wx1 + p2_2 * wx2</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="s2">        RESULT = row_m1 * wy_m1 + row_0 * wy0 + row_1 * wy1 + row_2 * wy2</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="s2">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="n">full_expr_str</span> <span class="o">=</span> <span class="n">setup</span> <span class="o">+</span> <span class="n">source_coord_calc</span> <span class="o">+</span> <span class="n">interpolate</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">expr_postfix</span> <span class="o">=</span> <span class="n">infix2postfix</span><span class="p">(</span><span class="n">full_expr_str</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">expr_postfix</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="n">boundary</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.reset_output_index" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">reset_output_index</span>


<a href="#y5gfunc.expr.test_atan2.reset_output_index" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">reset_output_index</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="index (y5gfunc.expr.test_atan2.reset_output_index(index))" href="#y5gfunc.expr.test_atan2.reset_output_index(index)">index</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Resets the global output index counter and the set of used indices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.reset_output_index(index)" class="doc doc-heading doc-heading-parameter">                  <code>index</code>
<a href="#y5gfunc.expr.test_atan2.reset_output_index(index)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to reset the automatic index counter to.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/preview/output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">def</span><span class="w"> </span><span class="nf">reset_output_index</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Resets the global output index counter and the set of used indices.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        index: The value to reset the automatic index counter to.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">global</span> <span class="n">_output_index</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">_output_index</span> <span class="o">=</span> <span class="n">index</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">global</span> <span class="n">used_indices</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">used_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.set_preview" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">set_preview</span>


<a href="#y5gfunc.expr.test_atan2.set_preview" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">set_preview</span><span class="p">(</span><span class="o">*</span><span class="n"><a class="autorefs autorefs-internal" title="*args (y5gfunc.expr.test_atan2.set_preview(*args))" href="#y5gfunc.expr.test_atan2.set_preview(*args)">args</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="debug (y5gfunc.expr.test_atan2.set_preview(debug))" href="#y5gfunc.expr.test_atan2.set_preview(debug)">debug</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Outputs VapourSynth clips in vspreview.</p>
<p>This function handles assigning output indices automatically or allows for explicit index specification.
Nodes are named in <code>vspreview</code> as <code>{index}: {variable_name}</code>. When debug=True, node name is overlaid onto the video.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.set_preview(*args)" class="doc doc-heading doc-heading-parameter">                  <code>*args</code>
<a href="#y5gfunc.expr.test_atan2.set_preview(*args)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A variable number of arguments representing the clips to output.
Each argument can be:
- A single <code>vs.VideoNode</code>: This clip will be assigned the next available automatic output index.
- A list or tuple of <code>vs.VideoNode</code> objects: Each node in the sequence will be assigned the next available automatic output index.
- A tuple in the format <code>(vs.VideoNode, int)</code>: The specified node will be assigned the given integer index. The index must be non-negative.
- A list or tuple containing any combination of the above formats, including mixtures of <code>vs.VideoNode</code> and <code>(vs.VideoNode, int)</code> tuples.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.set_preview(debug)" class="doc doc-heading doc-heading-parameter">                  <code>debug</code>
<a href="#y5gfunc.expr.test_atan2.set_preview(debug)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overlays the inferred variable name onto the output clip for identification during previews.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>debug</code> is True when the script is run for encoding (i.e., <code>__name__ == '__vapoursynth__'</code>).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an explicitly provided output index in a <code>(clip, index)</code> tuple is negative.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an explicitly provided output index is already assigned by a prior call to <code>output</code> in the same script execution (unless <code>reset_output_index</code> has been called).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#TypeError">TypeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any provided argument or an element within a passed list/tuple is not a <code>vs.VideoNode</code> or a <code>(vs.VideoNode, int)</code> tuple.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This function uses global variables (<code>_output_index</code>, <code>used_indices</code>) to track assigned indices across multiple calls within a single script run.
Use <code>reset_output_index()</code> to clear this state if you need to reuse indices or manage output sets independently.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>y5gfunc/preview/output.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_preview</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Outputs VapourSynth clips in vspreview.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    This function handles assigning output indices automatically or allows for explicit index specification.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Nodes are named in `vspreview` as `{index}: {variable_name}`. When debug=True, node name is overlaid onto the video.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        *args: A variable number of arguments representing the clips to output.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">            Each argument can be:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">            - A single `vs.VideoNode`: This clip will be assigned the next available automatic output index.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">            - A list or tuple of `vs.VideoNode` objects: Each node in the sequence will be assigned the next available automatic output index.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            - A tuple in the format `(vs.VideoNode, int)`: The specified node will be assigned the given integer index. The index must be non-negative.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">            - A list or tuple containing any combination of the above formats, including mixtures of `vs.VideoNode` and `(vs.VideoNode, int)` tuples.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        debug: If True, overlays the inferred variable name onto the output clip for identification during previews.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        ValueError: If `debug` is True when the script is run for encoding (i.e., `__name__ == &#39;__vapoursynth__&#39;`).</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        ValueError: If an explicitly provided output index in a `(clip, index)` tuple is negative.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        ValueError: If an explicitly provided output index is already assigned by a prior call to `output` in the same script execution (unless `reset_output_index` has been called).</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        TypeError: If any provided argument or an element within a passed list/tuple is not a `vs.VideoNode` or a `(vs.VideoNode, int)` tuple.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        This function uses global variables (`_output_index`, `used_indices`) to track assigned indices across multiple calls within a single script run.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        Use `reset_output_index()` to clear this state if you need to reuse indices or manage output sets independently.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">if</span> <span class="n">debug</span> <span class="ow">and</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__vapoursynth__&quot;</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;output: Do not set debug=True when encoding!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">frame</span><span class="p">:</span> <span class="n">FrameType</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">()</span><span class="o">.</span><span class="n">f_back</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="k">global</span> <span class="n">_output_index</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">global</span> <span class="n">used_indices</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">clips_to_process</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                    <span class="n">clip</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">item</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                            <span class="s2">&quot;output: Expected a tuple of (VideoNode, int) for explicit indexing.&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                        <span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;output: Output index must be non-negative.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                    <span class="n">clips_to_process</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">clip</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>                    <span class="n">clips_to_process</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                        <span class="sa">f</span><span class="s2">&quot;output: Invalid element type in list/tuple: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="si">}</span><span class="s2">. Expected VideoNode or (VideoNode, int).&quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                    <span class="p">)</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">clips_to_process</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">arg</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">clip</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">arg</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                    <span class="s2">&quot;output: Expected a tuple of (VideoNode, int) for explicit indexing.&quot;</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                <span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;output: Output index must be non-negative.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="n">clips_to_process</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">clip</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="sa">f</span><span class="s2">&quot;output: Invalid argument type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="si">}</span><span class="s2">. Expected VideoNode, list/tuple of VideoNodes, or (VideoNode, int).&quot;</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="p">)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="c1"># Explicitly Indexed Clips</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>    <span class="k">for</span> <span class="n">clip</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">clips_to_process</span><span class="p">:</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">used_indices</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>                    <span class="sa">f</span><span class="s2">&quot;output: Output index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> is already in use. Reset with reset_output_index() or choose another index.&quot;</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="n">variable_name</span> <span class="o">=</span> <span class="n">_get_variable_name</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">processed_clip</span> <span class="o">=</span> <span class="n">_add_text</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">debug</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">set_output</span><span class="p">(</span><span class="n">processed_clip</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="n">used_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="c1"># Automatically Indexed Clips</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">for</span> <span class="n">clip</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">clips_to_process</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="k">while</span> <span class="n">_output_index</span> <span class="ow">in</span> <span class="n">used_indices</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="n">_output_index</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">current_auto_index</span> <span class="o">=</span> <span class="n">_output_index</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">variable_name</span> <span class="o">=</span> <span class="n">_get_variable_name</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="n">processed_clip</span> <span class="o">=</span> <span class="n">_add_text</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="n">clip</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_auto_index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">debug</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">set_output</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="n">processed_clip</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="n">current_auto_index</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">current_auto_index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="n">used_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_auto_index</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="n">_output_index</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.load_source" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_source</span>


<a href="#y5gfunc.expr.test_atan2.load_source" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_source</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="file_path (y5gfunc.expr.test_atan2.load_source(file_path))" href="#y5gfunc.expr.test_atan2.load_source(file_path)">file_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="track (y5gfunc.expr.test_atan2.load_source(track))" href="#y5gfunc.expr.test_atan2.load_source(track)">track</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="matrix (y5gfunc.expr.test_atan2.load_source(matrix))" href="#y5gfunc.expr.test_atan2.load_source(matrix)">matrix</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="matrix_in (y5gfunc.expr.test_atan2.load_source(matrix_in))" href="#y5gfunc.expr.test_atan2.load_source(matrix_in)">matrix_in</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="timecodes_v2_path (y5gfunc.expr.test_atan2.load_source(timecodes_v2_path))" href="#y5gfunc.expr.test_atan2.load_source(timecodes_v2_path)">timecodes_v2_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Bestsource and Wobbly wrapper to load a video source.</p>
<p>This function acts as a primary interface for loading video sources.
It checks the file extension:
    - If it's a ".wob" file, it uses <code>wobbly_source</code>.
    - Otherwise, it uses <code>bestsource</code>, attempting to automatically detect if the source uses RFF (Repeat First Field) based on frame counts.</p>
<p>After loading, it applies a color matrix conversion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_source(file_path)" class="doc doc-heading doc-heading-parameter">                  <code>file_path</code>
<a href="#y5gfunc.expr.test_atan2.load_source(file_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the video file or .wob project file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_source(track)" class="doc doc-heading doc-heading-parameter">                  <code>track</code>
<a href="#y5gfunc.expr.test_atan2.load_source(track)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the video track to load. Ignored for .wob files.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_source(matrix)" class="doc doc-heading doc-heading-parameter">                  <code>matrix</code>
<a href="#y5gfunc.expr.test_atan2.load_source(matrix)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target color matrix.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_source(matrix_in)" class="doc doc-heading doc-heading-parameter">                  <code>matrix_in</code>
<a href="#y5gfunc.expr.test_atan2.load_source(matrix_in)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="vstools.Matrix" href="https://sgt0.github.io/jet-docs/api/vstools/enums/color/#vstools.enums.color.Matrix">Matrix</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input color matrix.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_source(timecodes_v2_path)" class="doc doc-heading doc-heading-parameter">                  <code>timecodes_v2_path</code>
<a href="#y5gfunc.expr.test_atan2.load_source(timecodes_v2_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a V2 timecodes file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VapourSynth VideoNode representing the loaded and matrix-converted video clip.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError">FileNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the resolved <code>file_path</code> does not exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a <code>.wob</code> file is specified but <code>track</code> is not 0.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_source</span><span class="p">(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">track</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">matrix</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">matrix_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">timecodes_v2_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Bestsource and Wobbly wrapper to load a video source.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    This function acts as a primary interface for loading video sources.</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    It checks the file extension:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        - If it&#39;s a &quot;.wob&quot; file, it uses `wobbly_source`.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        - Otherwise, it uses `bestsource`, attempting to automatically detect if the source uses RFF (Repeat First Field) based on frame counts.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    After loading, it applies a color matrix conversion.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        file_path: Path to the video file or .wob project file.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        track: Index of the video track to load. Ignored for .wob files.</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        matrix: Target color matrix.</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        matrix_in: Input color matrix.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        timecodes_v2_path: Path to a V2 timecodes file.</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        A VapourSynth VideoNode representing the loaded and matrix-converted video clip.</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        FileNotFoundError: If the resolved `file_path` does not exist.</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        AssertionError: If a `.wob` file is specified but `track` is not 0.</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;load_source: File </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">if</span> <span class="n">file_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.wob&quot;</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="k">assert</span> <span class="n">track</span> <span class="o">==</span> <span class="mi">0</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">clip</span> <span class="o">=</span> <span class="n">wobbly_source</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">timecodes_v2_path</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="c1"># modified from https://guides.vcb-s.com/basic-guide-10/#%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E4%B8%BA%E5%85%A8%E7%A8%8B-soft-pulldownpure-film</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">bestsource</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">rff</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">bestsource</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">rff</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">rff</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">True</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">clip</span> <span class="o">=</span> <span class="n">bestsource</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">track</span><span class="p">,</span> <span class="n">timecodes_v2_path</span><span class="p">,</span> <span class="n">rff</span><span class="o">=</span><span class="n">rff</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="k">if</span> <span class="n">matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_res</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">if</span> <span class="n">matrix_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">matrix_in</span> <span class="o">=</span> <span class="n">Matrix</span><span class="o">.</span><span class="n">from_res</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">primaries</span> <span class="o">=</span> <span class="n">Primaries</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">primaries_in</span> <span class="o">=</span> <span class="n">Primaries</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix_in</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">transfer</span> <span class="o">=</span> <span class="n">Transfer</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">value_vs</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">transfer_in</span> <span class="o">=</span> <span class="n">Transfer</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">value_vs</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Spline36</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">matrix_in</span><span class="o">=</span><span class="n">matrix_in</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">primaries</span><span class="o">=</span><span class="n">primaries</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="n">primaries_in</span><span class="o">=</span><span class="n">primaries_in</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">transfer</span><span class="o">=</span><span class="n">transfer</span><span class="p">,</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">transfer_in</span><span class="o">=</span><span class="n">transfer_in</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.get_frame_timestamp" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_frame_timestamp</span>


<a href="#y5gfunc.expr.test_atan2.get_frame_timestamp" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_frame_timestamp</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="frame_num (y5gfunc.expr.test_atan2.get_frame_timestamp(frame_num))" href="#y5gfunc.expr.test_atan2.get_frame_timestamp(frame_num)">frame_num</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.get_frame_timestamp(clip))" href="#y5gfunc.expr.test_atan2.get_frame_timestamp(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="precision (y5gfunc.expr.test_atan2.get_frame_timestamp(precision))" href="#y5gfunc.expr.test_atan2.get_frame_timestamp(precision)">precision</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a></span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="s1">&#39;millisecond&#39;</span><span class="p">,</span> <span class="s1">&#39;microsecond&#39;</span><span class="p">,</span> <span class="s1">&#39;nanosecond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;millisecond&#39;</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="timecodes_v2_file (y5gfunc.expr.test_atan2.get_frame_timestamp(timecodes_v2_file))" href="#y5gfunc.expr.test_atan2.get_frame_timestamp(timecodes_v2_file)">timecodes_v2_file</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the timestamp of a frame in a video clip.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_frame_timestamp(frame_num)" class="doc doc-heading doc-heading-parameter">                  <code>frame_num</code>
<a href="#y5gfunc.expr.test_atan2.get_frame_timestamp(frame_num)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frame number to get the timestamp for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_frame_timestamp(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.get_frame_timestamp(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to get the timestamp for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_frame_timestamp(precision)" class="doc doc-heading doc-heading-parameter">                  <code>precision</code>
<a href="#y5gfunc.expr.test_atan2.get_frame_timestamp(precision)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Literal" href="https://docs.python.org/3/library/typing.html#typing.Literal">Literal</a>[&#39;second&#39;, &#39;millisecond&#39;, &#39;microsecond&#39;, &#39;nanosecond&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The precision of the timestamp.</p>
              </div>
            </td>
            <td>
                  <code>&#39;millisecond&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_frame_timestamp(timecodes_v2_file)" class="doc doc-heading doc-heading-parameter">                  <code>timecodes_v2_file</code>
<a href="#y5gfunc.expr.test_atan2.get_frame_timestamp(timecodes_v2_file)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optional path to the timecodes file. If provided, the timestamp will be read from the file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The timestamp of the frame.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/timecodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_frame_timestamp</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">frame_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">precision</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="s2">&quot;second&quot;</span><span class="p">,</span> <span class="s2">&quot;millisecond&quot;</span><span class="p">,</span> <span class="s2">&quot;microsecond&quot;</span><span class="p">,</span> <span class="s2">&quot;nanosecond&quot;</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;millisecond&quot;</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">timecodes_v2_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Get the timestamp of a frame in a video clip.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        frame_num: The frame number to get the timestamp for.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        clip: The video clip to get the timestamp for.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        precision: The precision of the timestamp.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        timecodes_v2_file: The optional path to the timecodes file. If provided, the timestamp will be read from the file.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        The timestamp of the frame.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="k">assert</span> <span class="n">frame_num</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">assert</span> <span class="n">timecodes_v2_file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">timecodes_v2_file</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="k">if</span> <span class="n">frame_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">elif</span> <span class="n">clip</span><span class="o">.</span><span class="n">fps</span> <span class="o">!=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="n">t</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span> <span class="o">*</span> <span class="n">frame_num</span> <span class="o">*</span> <span class="n">clip</span><span class="o">.</span><span class="n">fps</span><span class="o">**-</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">9</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="k">if</span> <span class="n">timecodes_v2_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="n">timecodes</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>                <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">timecodes_v2_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>            <span class="p">]</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">timecodes</span><span class="p">[</span><span class="n">frame_num</span><span class="p">]</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>            <span class="n">s</span> <span class="o">=</span> <span class="n">clip_to_timecodes</span><span class="p">(</span><span class="n">clip</span><span class="p">)[</span><span class="n">frame_num</span><span class="p">]</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">s</span> <span class="o">//</span> <span class="mi">60</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">s</span> <span class="o">%=</span> <span class="mi">60</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">h</span> <span class="o">=</span> <span class="n">m</span> <span class="o">//</span> <span class="mi">60</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">m</span> <span class="o">%=</span> <span class="mi">60</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="k">if</span> <span class="n">precision</span> <span class="o">==</span> <span class="s2">&quot;second&quot;</span><span class="p">:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">elif</span> <span class="n">precision</span> <span class="o">==</span> <span class="s2">&quot;millisecond&quot;</span><span class="p">:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">06.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="k">elif</span> <span class="n">precision</span> <span class="o">==</span> <span class="s2">&quot;microsecond&quot;</span><span class="p">:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">09.6f</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">elif</span> <span class="n">precision</span> <span class="o">==</span> <span class="s2">&quot;nanosecond&quot;</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">m</span><span class="si">:</span><span class="s2">02.0f</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">012.9f</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.clip_to_timecodes" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">clip_to_timecodes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
  </span>

<a href="#y5gfunc.expr.test_atan2.clip_to_timecodes" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">clip_to_timecodes</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.clip_to_timecodes(clip))" href="#y5gfunc.expr.test_atan2.clip_to_timecodes(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="path (y5gfunc.expr.test_atan2.clip_to_timecodes(path))" href="#y5gfunc.expr.test_atan2.clip_to_timecodes(path)">path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="collections.deque" href="https://docs.python.org/3/library/collections.html#collections.deque">deque</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate timecodes for a video clip.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.clip_to_timecodes(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.clip_to_timecodes(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The video clip to generate timecodes for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.clip_to_timecodes(path)" class="doc doc-heading doc-heading-parameter">                  <code>path</code>
<a href="#y5gfunc.expr.test_atan2.clip_to_timecodes(path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The optional path to the timecodes file. If provided, the timecodes will be written to the file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.deque" href="https://docs.python.org/3/library/collections.html#collections.deque">deque</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A deque of timecodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/timecodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="k">def</span><span class="w"> </span><span class="nf">clip_to_timecodes</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">deque</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    Generate timecodes for a video clip.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        clip: The video clip to generate timecodes for.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        path: The optional path to the timecodes file. If provided, the timecodes will be written to the file.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        A deque of timecodes.</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">timecodes</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">deque</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">maxlen</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">curr_time</span> <span class="o">=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">()</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">init_percentage</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# timecode format v2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clip</span><span class="o">.</span><span class="n">frames</span><span class="p">()):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>            <span class="n">num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;_DurationNum&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="n">den</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;_DurationDen&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">curr_time</span> <span class="o">+=</span> <span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">den</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="n">timecode</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">curr_time</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>            <span class="n">timecodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timecode</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timecode</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="n">percentage_done</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">timecodes</span><span class="p">)</span> <span class="o">/</span> <span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="k">if</span> <span class="n">percentage_done</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">percentage_done</span> <span class="o">!=</span> <span class="n">init_percentage</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                    <span class="sa">f</span><span class="s2">&quot;Finding timecodes for variable-framerate clip: </span><span class="si">{</span><span class="n">percentage_done</span><span class="si">}</span><span class="s2">% done&quot;</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">init_percentage</span> <span class="o">=</span> <span class="n">percentage_done</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">return</span> <span class="n">timecodes</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.load_dv_p7" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">load_dv_p7</span>


<a href="#y5gfunc.expr.test_atan2.load_dv_p7" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">load_dv_p7</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="file_path (y5gfunc.expr.test_atan2.load_dv_p7(file_path))" href="#y5gfunc.expr.test_atan2.load_dv_p7(file_path)">file_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="bl_index (y5gfunc.expr.test_atan2.load_dv_p7(bl_index))" href="#y5gfunc.expr.test_atan2.load_dv_p7(bl_index)">bl_index</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="el_index (y5gfunc.expr.test_atan2.load_dv_p7(el_index))" href="#y5gfunc.expr.test_atan2.load_dv_p7(el_index)">el_index</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="rpu_file_path (y5gfunc.expr.test_atan2.load_dv_p7(rpu_file_path))" href="#y5gfunc.expr.test_atan2.load_dv_p7(rpu_file_path)">rpu_file_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Loads a Dolby Vision Profile 7 video file.</p>
<p>This function incorporates workarounds for an underlying FFmpeg issue that causes source filters
(e.g., bestsource) to fail to extract the <code>DolbyVisionRpu</code> frame property from the last few
frames of a video. For more details, see: https://github.com/vapoursynth/bestsource/issues/97</p>
<p>Workarounds:
1.  Default method (rpu_file_path=None): It uses FFMS2 to extract the RPU data from the video file.
    While convenient, this method has a significant caveat: FFMS2 might return stale RPU data for the final frames.
    Specifically, it carries over the RPU from the last valid frame even after seeking. This behavior is documented
    in the discussion of the linked issue.</p>
<ol>
<li>External RPU file (rpu_file_path is provided): This method uses an externally supplied RPU file.
    This is the most reliable workaround as it completely bypasses reliance on FFmpeg for RPU extraction.
    RPU data is required to be extracted into a file first using dovi_tool and then provided to this function.</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_dv_p7(file_path)" class="doc doc-heading doc-heading-parameter">                  <code>file_path</code>
<a href="#y5gfunc.expr.test_atan2.load_dv_p7(file_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the video file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_dv_p7(bl_index)" class="doc doc-heading doc-heading-parameter">                  <code>bl_index</code>
<a href="#y5gfunc.expr.test_atan2.load_dv_p7(bl_index)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the Base Layer (BL) stream.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_dv_p7(el_index)" class="doc doc-heading doc-heading-parameter">                  <code>el_index</code>
<a href="#y5gfunc.expr.test_atan2.load_dv_p7(el_index)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the Enhancement Layer (EL) stream.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.load_dv_p7(rpu_file_path)" class="doc doc-heading doc-heading-parameter">                  <code>rpu_file_path</code>
<a href="#y5gfunc.expr.test_atan2.load_dv_p7(rpu_file_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional path to the RPU file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VapourSynth VideoNode representing the Dolby Vision P7 video clip.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/source.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_dv_p7</span><span class="p">(</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">bl_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">el_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">rpu_file_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    Loads a Dolby Vision Profile 7 video file.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    This function incorporates workarounds for an underlying FFmpeg issue that causes source filters</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    (e.g., bestsource) to fail to extract the `DolbyVisionRpu` frame property from the last few</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    frames of a video. For more details, see: https://github.com/vapoursynth/bestsource/issues/97</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Workarounds:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    1.  Default method (rpu_file_path=None): It uses FFMS2 to extract the RPU data from the video file.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        While convenient, this method has a significant caveat: FFMS2 might return stale RPU data for the final frames.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        Specifically, it carries over the RPU from the last valid frame even after seeking. This behavior is documented</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        in the discussion of the linked issue.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    2.  External RPU file (rpu_file_path is provided): This method uses an externally supplied RPU file.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        This is the most reliable workaround as it completely bypasses reliance on FFmpeg for RPU extraction.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        RPU data is required to be extracted into a file first using dovi_tool and then provided to this function.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        file_path: Path to the video file.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        bl_index: Index of the Base Layer (BL) stream.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        el_index: Index of the Enhancement Layer (EL) stream.</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        rpu_file_path: Optional path to the RPU file.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        A VapourSynth VideoNode representing the Dolby Vision P7 video clip.</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">bl</span> <span class="o">=</span> <span class="n">LSMAS</span><span class="o">.</span><span class="n">source</span><span class="p">(</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">file_path</span><span class="p">,</span> <span class="n">stream_index</span><span class="o">=</span><span class="n">bl_index</span><span class="p">,</span> <span class="n">chroma_location</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">CHROMA_TOP_LEFT</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Spline36</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV420P16</span><span class="p">)</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">el</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">LSMAS</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">stream_index</span><span class="o">=</span><span class="n">el_index</span><span class="p">)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">bl</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">bl</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV420P10</span><span class="p">)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">PlaneStats</span><span class="p">()</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="p">)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="k">if</span> <span class="n">rpu_file_path</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">bl</span> <span class="o">=</span> <span class="n">write_rpu</span><span class="p">(</span><span class="n">rpu_file_path</span><span class="p">,</span> <span class="n">bl</span><span class="p">)</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">el</span> <span class="o">=</span> <span class="n">write_rpu</span><span class="p">(</span><span class="n">rpu_file_path</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">rpu</span> <span class="o">=</span> <span class="n">FFMS2</span><span class="o">.</span><span class="n">source</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">el_index</span><span class="p">)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">bl</span> <span class="o">=</span> <span class="n">bl</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">CopyFrameProps</span><span class="p">(</span><span class="n">rpu</span><span class="p">,</span> <span class="s2">&quot;DolbyVisionRPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">el</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">CopyFrameProps</span><span class="p">(</span><span class="n">rpu</span><span class="p">,</span> <span class="s2">&quot;DolbyVisionRPU&quot;</span><span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="n">bl</span> <span class="o">=</span> <span class="n">tonemap</span><span class="p">(</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">bl</span><span class="p">,</span> <span class="n">src_csp</span><span class="o">=</span><span class="n">ColorSpace</span><span class="o">.</span><span class="n">DOLBY_VISION</span><span class="p">,</span> <span class="n">dst_csp</span><span class="o">=</span><span class="n">ColorSpace</span><span class="o">.</span><span class="n">HDR10</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="p">)</span><span class="o">.</span><span class="n">resize2</span><span class="o">.</span><span class="n">Spline36</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">YUV420P16</span><span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">hdr</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">vsnlq</span><span class="o">.</span><span class="n">MapNLQ</span><span class="p">(</span><span class="n">bl</span><span class="p">,</span> <span class="n">el</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">SetFrameProps</span><span class="p">(</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">_Matrix</span><span class="o">=</span><span class="n">Matrix</span><span class="o">.</span><span class="n">BT2020NCL</span><span class="p">,</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="n">_Primaries</span><span class="o">=</span><span class="n">PRIMARIES_BT2020</span><span class="p">,</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">_Transfer</span><span class="o">=</span><span class="n">Transfer</span><span class="o">.</span><span class="n">ST2084</span><span class="o">.</span><span class="n">value_vs</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">hdr</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">PropExpr</span><span class="p">([</span><span class="n">hdr</span><span class="p">,</span> <span class="n">el</span><span class="p">],</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;_FEL&quot;</span><span class="p">:</span> <span class="s2">&quot;y.PlaneStatsAverage 0 &gt;&quot;</span><span class="p">})</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">return</span> <span class="n">hdr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.write_rpu" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">write_rpu</span>


<a href="#y5gfunc.expr.test_atan2.write_rpu" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">write_rpu</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.write_rpu(rpu_file_path)">rpu_file_path</span></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><span title="y5gfunc.expr.test_atan2.write_rpu(clip)">clip</span></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Writes the RPU data to the clip.</p>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/source/rpu.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="k">def</span><span class="w"> </span><span class="nf">write_rpu</span><span class="p">(</span><span class="n">rpu_file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    Writes the RPU data to the clip.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">rpu_file</span> <span class="o">=</span> <span class="n">RpuFile</span><span class="p">(</span><span class="n">rpu_file_path</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_frame</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">rpu_data</span> <span class="o">=</span> <span class="n">rpu_file</span><span class="o">.</span><span class="n">get_frame_data</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">fout</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;DolbyVisionRPU&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rpu_data</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="k">return</span> <span class="n">fout</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ModifyFrame</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">selector</span><span class="o">=</span><span class="n">write_frame</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.encode_audio" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">encode_audio</span>


<a href="#y5gfunc.expr.test_atan2.encode_audio" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">encode_audio</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="input_file (y5gfunc.expr.test_atan2.encode_audio(input_file))" href="#y5gfunc.expr.test_atan2.encode_audio(input_file)">input_file</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="output_file (y5gfunc.expr.test_atan2.encode_audio(output_file))" href="#y5gfunc.expr.test_atan2.encode_audio(output_file)">output_file</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="audio_track (y5gfunc.expr.test_atan2.encode_audio(audio_track))" href="#y5gfunc.expr.test_atan2.encode_audio(audio_track)">audio_track</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="bitrate (y5gfunc.expr.test_atan2.encode_audio(bitrate))" href="#y5gfunc.expr.test_atan2.encode_audio(bitrate)">bitrate</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="overwrite (y5gfunc.expr.test_atan2.encode_audio(overwrite))" href="#y5gfunc.expr.test_atan2.encode_audio(overwrite)">overwrite</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="copy (y5gfunc.expr.test_atan2.encode_audio(copy))" href="#y5gfunc.expr.test_atan2.encode_audio(copy)">copy</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="delay (y5gfunc.expr.test_atan2.encode_audio(delay))" href="#y5gfunc.expr.test_atan2.encode_audio(delay)">delay</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Encodes or copies a single audio track from an input file using FFmpeg.</p>
<p>Handles lossless (FLAC) and lossy (AAC, MP3) encoding, stream copying, and applying audio delay (positive or negative).
Special handling exists for applying positive delay when copying lossy streams.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(input_file)" class="doc doc-heading doc-heading-parameter">                  <code>input_file</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(input_file)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the input media file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(output_file)" class="doc doc-heading doc-heading-parameter">                  <code>output_file</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(output_file)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path for the output audio file. Extension determines format.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(audio_track)" class="doc doc-heading doc-heading-parameter">                  <code>audio_track</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(audio_track)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the audio track to process (0-based relative to audio streams only, after FFmpeg maps it).</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(bitrate)" class="doc doc-heading doc-heading-parameter">                  <code>bitrate</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(bitrate)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target bitrate for lossy encoding (e.g., "320k"). Auto-set for AAC/MP3 if None and not copying. Ignored for FLAC/copy.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(overwrite)" class="doc doc-heading doc-heading-parameter">                  <code>overwrite</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(overwrite)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, overwrite the output file if it exists.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(copy)" class="doc doc-heading doc-heading-parameter">                  <code>copy</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(copy)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, perform a stream copy without re-encoding. Cannot be used with <code>bitrate</code>.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_audio(delay)" class="doc doc-heading doc-heading-parameter">                  <code>delay</code>
<a href="#y5gfunc.expr.test_atan2.encode_audio(delay)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Audio delay in milliseconds. Positive values add silence at the start; negative values trim from the start.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the created audio file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError">FileNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input file does not exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If FFmpeg/FFprobe fails, the output file exists and <code>overwrite</code> is False, or the specified audio track is not found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If incompatible options are used (e.g., <code>copy</code> and <code>bitrate</code>, bitrate for FLAC).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/audio/audio.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">encode_audio</span><span class="p">(</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">input_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">output_file</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">audio_track</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">bitrate</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># ms</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Encodes or copies a single audio track from an input file using FFmpeg.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    Handles lossless (FLAC) and lossy (AAC, MP3) encoding, stream copying, and applying audio delay (positive or negative).</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Special handling exists for applying positive delay when copying lossy streams.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        input_file: Path to the input media file.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        output_file: Path for the output audio file. Extension determines format.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        audio_track: Index of the audio track to process (0-based relative to audio streams only, after FFmpeg maps it).</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        bitrate: Target bitrate for lossy encoding (e.g., &quot;320k&quot;). Auto-set for AAC/MP3 if None and not copying. Ignored for FLAC/copy.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        overwrite: If True, overwrite the output file if it exists.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        copy: If True, perform a stream copy without re-encoding. Cannot be used with `bitrate`.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        delay: Audio delay in milliseconds. Positive values add silence at the start; negative values trim from the start.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        Path to the created audio file.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        FileNotFoundError: If the input file does not exist.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        RuntimeError: If FFmpeg/FFprobe fails, the output file exists and `overwrite` is False, or the specified audio track is not found.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        ValueError: If incompatible options are used (e.g., `copy` and `bitrate`, bitrate for FLAC).</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">input_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">input_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;encode_audio: Input file not found: </span><span class="si">{</span><span class="n">input_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="k">if</span> <span class="n">output_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>        <span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>            <span class="n">output_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="sa">f</span><span class="s2">&quot;encode_audio: Output file already exists! </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>            <span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="k">if</span> <span class="n">copy</span> <span class="ow">and</span> <span class="n">bitrate</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;encode_audio: Cannot apply bitrate using copy mode!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">output_ext</span> <span class="o">=</span> <span class="n">output_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="k">if</span> <span class="n">output_ext</span> <span class="o">==</span> <span class="s2">&quot;.flac&quot;</span> <span class="ow">and</span> <span class="n">bitrate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;encode_audio: Don&#39;t set bitrate for flac file!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">probe_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="s2">&quot;ffprobe&quot;</span><span class="p">,</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="s2">&quot;quiet&quot;</span><span class="p">,</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="s2">&quot;-print_format&quot;</span><span class="p">,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>        <span class="s2">&quot;-show_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="s2">&quot;-select_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="sa">f</span><span class="s2">&quot;a:</span><span class="si">{</span><span class="n">audio_track</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">input_path</span><span class="p">),</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="p">]</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">probe_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">probe_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="k">if</span> <span class="n">probe_result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;encode_audio: FFprobe failed: </span><span class="si">{</span><span class="n">probe_result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">audio_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">probe_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">audio_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;streams&quot;</span><span class="p">):</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;encode_audio: No audio track </span><span class="si">{</span><span class="n">audio_track</span><span class="si">}</span><span class="s2"> found in file&quot;</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">input_stream</span> <span class="o">=</span> <span class="n">audio_info</span><span class="p">[</span><span class="s2">&quot;streams&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">input_is_lossless</span> <span class="o">=</span> <span class="n">check_audio_stream_lossless</span><span class="p">(</span><span class="n">input_stream</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">output_is_lossless</span> <span class="o">=</span> <span class="n">output_ext</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.flac&quot;</span><span class="p">,</span> <span class="s2">&quot;.wav&quot;</span><span class="p">,</span> <span class="s2">&quot;.alac&quot;</span><span class="p">]</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">if</span> <span class="n">output_ext</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;.aac&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp3&quot;</span><span class="p">}</span> <span class="ow">and</span> <span class="n">bitrate</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">copy</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">bitrate</span> <span class="o">=</span> <span class="s2">&quot;320k&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">if</span> <span class="n">delay</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">copy</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">input_is_lossless</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">output_is_lossless</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">())</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">extracted_audio</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;extracted</span><span class="si">{</span><span class="n">output_ext</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">silence_file</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;silence</span><span class="si">{</span><span class="n">output_ext</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">concat_list</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="s2">&quot;concat.txt&quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">extract_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="s2">&quot;ffmpeg&quot;</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="s2">&quot;-i&quot;</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">input_path</span><span class="p">),</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s2">&quot;-map&quot;</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="sa">f</span><span class="s2">&quot;0:a:</span><span class="si">{</span><span class="n">audio_track</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="s2">&quot;-c:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="s2">&quot;copy&quot;</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">extracted_audio</span><span class="p">),</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">]</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">extract_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">extract_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">if</span> <span class="n">extract_process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>                <span class="sa">f</span><span class="s2">&quot;encode_audio: Failed to extract audio: </span><span class="si">{</span><span class="n">extract_process</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="se">\n</span><span class="s2">Command: </span><span class="si">{</span><span class="n">extract_cmd</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">extract_probe_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="s2">&quot;ffprobe&quot;</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="s2">&quot;quiet&quot;</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="s2">&quot;-print_format&quot;</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="s2">&quot;-show_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">extracted_audio</span><span class="p">),</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="p">]</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">extract_probe_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">extract_probe_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">if</span> <span class="n">extract_probe_result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="sa">f</span><span class="s2">&quot;encode_audio: FFprobe failed on extracted audio: </span><span class="si">{</span><span class="n">extract_probe_result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">extracted_info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">extract_probe_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">extracted_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;streams&quot;</span><span class="p">):</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;encode_audio: No streams found in extracted audio&quot;</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">stream</span> <span class="o">=</span> <span class="n">extracted_info</span><span class="p">[</span><span class="s2">&quot;streams&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">codec</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;codec_name&quot;</span><span class="p">]</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">sample_rate</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;sample_rate&quot;</span><span class="p">]</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">sample_fmt</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sample_fmt&quot;</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">if</span> <span class="s2">&quot;channel_layout&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">channel_layout</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;channel_layout&quot;</span><span class="p">]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="c1"># Fallback based on channel count</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>            <span class="n">channels</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;channels&quot;</span><span class="p">]</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="k">if</span> <span class="n">channels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="n">channel_layout</span> <span class="o">=</span> <span class="s2">&quot;mono&quot;</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>            <span class="k">elif</span> <span class="n">channels</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                <span class="n">channel_layout</span> <span class="o">=</span> <span class="s2">&quot;stereo&quot;</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="k">elif</span> <span class="n">channels</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="n">channel_layout</span> <span class="o">=</span> <span class="s2">&quot;5.1&quot;</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="k">elif</span> <span class="n">channels</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="n">channel_layout</span> <span class="o">=</span> <span class="s2">&quot;7.1&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="n">channel_layout</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s2">c&quot;</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="k">if</span> <span class="s2">&quot;bit_rate&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">audio_bitrate</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;bit_rate&quot;</span><span class="p">]</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="n">audio_bitrate</span> <span class="o">=</span> <span class="s2">&quot;320k&quot;</span> <span class="k">if</span> <span class="n">output_ext</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;.aac&quot;</span><span class="p">,</span> <span class="s2">&quot;.mp3&quot;</span><span class="p">}</span> <span class="k">else</span> <span class="s2">&quot;192k&quot;</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">delay_sec</span> <span class="o">=</span> <span class="n">delay</span> <span class="o">/</span> <span class="mi">1000</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">silence_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="s2">&quot;ffmpeg&quot;</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="s2">&quot;-f&quot;</span><span class="p">,</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>            <span class="s2">&quot;lavfi&quot;</span><span class="p">,</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>            <span class="s2">&quot;-i&quot;</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>            <span class="sa">f</span><span class="s2">&quot;anullsrc=channel_layout=</span><span class="si">{</span><span class="n">channel_layout</span><span class="si">}</span><span class="s2">:sample_rate=</span><span class="si">{</span><span class="n">sample_rate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="s2">&quot;-t&quot;</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">delay_sec</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="s2">&quot;-c:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="n">codec</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="s2">&quot;-b:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="n">audio_bitrate</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="p">]</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">if</span> <span class="n">sample_fmt</span><span class="p">:</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">silence_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-sample_fmt&quot;</span><span class="p">,</span> <span class="n">sample_fmt</span><span class="p">])</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">silence_cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">silence_file</span><span class="p">))</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">silence_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">silence_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="k">if</span> <span class="n">silence_process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="sa">f</span><span class="s2">&quot;encode_audio: Failed to generate silence: </span><span class="si">{</span><span class="n">silence_process</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="se">\n</span><span class="s2">Command: </span><span class="si">{</span><span class="n">silence_cmd</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">concat_list</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;file &#39;</span><span class="si">{</span><span class="n">silence_file</span><span class="si">}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;file &#39;</span><span class="si">{</span><span class="n">extracted_audio</span><span class="si">}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">ffmpeg_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="s2">&quot;ffmpeg&quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="s2">&quot;-f&quot;</span><span class="p">,</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="s2">&quot;concat&quot;</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="s2">&quot;-safe&quot;</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="s2">&quot;0&quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="s2">&quot;-i&quot;</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">concat_list</span><span class="p">),</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="s2">&quot;-c&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="s2">&quot;copy&quot;</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="nb">str</span><span class="p">(</span><span class="n">output_path</span><span class="p">),</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="p">]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ffmpeg_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                <span class="sa">f</span><span class="s2">&quot;encode_audio: FFmpeg concat failed: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="se">\n</span><span class="s2">Command: </span><span class="si">{</span><span class="n">ffmpeg_cmd</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">return</span> <span class="n">output_path</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">ffmpeg_cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ffmpeg&quot;</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">input_path</span><span class="p">)]</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">if</span> <span class="n">delay</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">delay_sec</span> <span class="o">=</span> <span class="n">delay</span> <span class="o">/</span> <span class="mi">1000</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="n">delay_sec</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-af&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;adelay=</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-ss&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="o">-</span><span class="n">delay_sec</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-map&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;0:a:</span><span class="si">{</span><span class="n">audio_track</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-c:a&quot;</span><span class="p">,</span> <span class="s2">&quot;copy&quot;</span><span class="p">])</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="k">if</span> <span class="n">output_ext</span> <span class="o">==</span> <span class="s2">&quot;.flac&quot;</span><span class="p">:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">sample_fmt</span> <span class="o">=</span> <span class="n">audio_info</span><span class="p">[</span><span class="s2">&quot;streams&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;sample_fmt&quot;</span><span class="p">]</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="k">if</span> <span class="s2">&quot;16&quot;</span> <span class="ow">in</span> <span class="n">sample_fmt</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>                <span class="n">sample_fmt</span> <span class="o">=</span> <span class="s2">&quot;s16&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>                <span class="n">sample_fmt</span> <span class="o">=</span> <span class="s2">&quot;s32&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">sample_rate</span> <span class="o">=</span> <span class="n">audio_info</span><span class="p">[</span><span class="s2">&quot;streams&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;sample_rate&quot;</span><span class="p">]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                <span class="p">[</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                    <span class="s2">&quot;-c:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                    <span class="s2">&quot;flac&quot;</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                    <span class="s2">&quot;-sample_fmt&quot;</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>                    <span class="n">sample_fmt</span><span class="p">,</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                    <span class="s2">&quot;-ar&quot;</span><span class="p">,</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                    <span class="n">sample_rate</span><span class="p">,</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                    <span class="s2">&quot;-compression_level&quot;</span><span class="p">,</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                    <span class="s2">&quot;12&quot;</span><span class="p">,</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>                <span class="p">]</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="p">)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="k">elif</span> <span class="n">output_ext</span> <span class="o">==</span> <span class="s2">&quot;.aac&quot;</span><span class="p">:</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bitrate</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                    <span class="p">[</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                        <span class="s2">&quot;-c:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>                        <span class="s2">&quot;aac_at&quot;</span><span class="p">,</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>                        <span class="s2">&quot;-global_quality:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>                        <span class="s2">&quot;14&quot;</span><span class="p">,</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>                        <span class="s2">&quot;-aac_at_mode&quot;</span><span class="p">,</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>                        <span class="s2">&quot;2&quot;</span><span class="p">,</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>                        <span class="s2">&quot;-b:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>                        <span class="n">bitrate</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>                    <span class="p">]</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>                <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>                <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>                    <span class="p">[</span>  <span class="c1"># better qaac?</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>                        <span class="s2">&quot;-c:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>                        <span class="s2">&quot;libfdk_aac&quot;</span><span class="p">,</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>                        <span class="s2">&quot;-vbr&quot;</span><span class="p">,</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>                        <span class="s2">&quot;5&quot;</span><span class="p">,</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>                        <span class="s2">&quot;-cutoff&quot;</span><span class="p">,</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>                        <span class="s2">&quot;20000&quot;</span><span class="p">,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>                        <span class="s2">&quot;-b:a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>                        <span class="n">bitrate</span><span class="p">,</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>                    <span class="p">]</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>                <span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">elif</span> <span class="n">output_ext</span> <span class="o">==</span> <span class="s2">&quot;.mp3&quot;</span><span class="p">:</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bitrate</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-c:a&quot;</span><span class="p">,</span> <span class="s2">&quot;libmp3lame&quot;</span><span class="p">,</span> <span class="s2">&quot;-q:a&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;-b:a&quot;</span><span class="p">,</span> <span class="n">bitrate</span><span class="p">])</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">elif</span> <span class="n">bitrate</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;-b:a&quot;</span><span class="p">,</span> <span class="n">bitrate</span><span class="p">])</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">ffmpeg_cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_path</span><span class="p">))</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ffmpeg_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="sa">f</span><span class="s2">&quot;encode_audio: FFmpeg failed: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="se">\n</span><span class="s2"> FFMPEG cmd: </span><span class="si">{</span><span class="n">ffmpeg_cmd</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="p">)</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.extract_audio_tracks" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">extract_audio_tracks</span>


<a href="#y5gfunc.expr.test_atan2.extract_audio_tracks" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">extract_audio_tracks</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="input_path (y5gfunc.expr.test_atan2.extract_audio_tracks(input_path))" href="#y5gfunc.expr.test_atan2.extract_audio_tracks(input_path)">input_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="output_dir (y5gfunc.expr.test_atan2.extract_audio_tracks(output_dir))" href="#y5gfunc.expr.test_atan2.extract_audio_tracks(output_dir)">output_dir</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="config (y5gfunc.expr.test_atan2.extract_audio_tracks(config))" href="#y5gfunc.expr.test_atan2.extract_audio_tracks(config)">config</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            AudioConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.AudioConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.AudioConfig">AudioConfig</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            AudioConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.AudioConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.AudioConfig">AudioConfig</a></span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extracts and processes audio tracks from a media file based on AudioConfig.</p>
<p>Probes the input file for video and audio streams, attempts to get delays using tsMuxeR (if available), determines the processing mode
(copy, compress, lossy encode, drop) for each track based on the provided AudioConfig, and then calls <code>encode_audio</code> for each track to be kept.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.extract_audio_tracks(input_path)" class="doc doc-heading doc-heading-parameter">                  <code>input_path</code>
<a href="#y5gfunc.expr.test_atan2.extract_audio_tracks(input_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the input media file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.extract_audio_tracks(output_dir)" class="doc doc-heading doc-heading-parameter">                  <code>output_dir</code>
<a href="#y5gfunc.expr.test_atan2.extract_audio_tracks(output_dir)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to save extracted audio files. Defaults to a folder named "{input_stem}_audio" next to the input file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.extract_audio_tracks(config)" class="doc doc-heading doc-heading-parameter">                  <code>config</code>
<a href="#y5gfunc.expr.test_atan2.extract_audio_tracks(config)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            AudioConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.AudioConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.AudioConfig">AudioConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An AudioConfig object defining how to process different types of audio tracks.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            AudioConfig


  
      dataclass
   (y5gfunc.encode.audio.audio_config.AudioConfig)" href="../encode/audio/audio_config.html#y5gfunc.encode.audio.audio_config.AudioConfig">AudioConfig</a>()</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, where each dictionary represents a successfully extracted track and contains keys suitable for use in muxing functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError">FileNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input file or required executables (ffprobe, ffmpeg, optionally tsMuxeR) are not found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If ffprobe fails, no audio tracks are found, or if <code>encode_audio</code> fails for any track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/audio/audio.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_audio_tracks</span><span class="p">(</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="n">input_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">output_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">AudioConfig</span> <span class="o">=</span> <span class="n">AudioConfig</span><span class="p">(),</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]]:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    Extracts and processes audio tracks from a media file based on AudioConfig.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Probes the input file for video and audio streams, attempts to get delays using tsMuxeR (if available), determines the processing mode</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    (copy, compress, lossy encode, drop) for each track based on the provided AudioConfig, and then calls `encode_audio` for each track to be kept.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        input_path: Path to the input media file.</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        output_dir: Directory to save extracted audio files. Defaults to a folder named &quot;{input_stem}_audio&quot; next to the input file.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        config: An AudioConfig object defining how to process different types of audio tracks.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        A list of dictionaries, where each dictionary represents a successfully extracted track and contains keys suitable for use in muxing functions.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        FileNotFoundError: If the input file or required executables (ffprobe, ffmpeg, optionally tsMuxeR) are not found.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        RuntimeError: If ffprobe fails, no audio tracks are found, or if `encode_audio` fails for any track.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>    <span class="n">input_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">input_path</span><span class="p">)</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">input_path</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">input_path</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_audio&quot;</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">output_dir</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="n">video_track_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="s2">&quot;ffprobe&quot;</span><span class="p">,</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="s2">&quot;quiet&quot;</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="s2">&quot;-print_format&quot;</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="s2">&quot;-show_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="s2">&quot;-select_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="s2">&quot;v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">input_path</span><span class="p">),</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>    <span class="p">]</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>    <span class="n">video_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">video_track_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="k">if</span> <span class="n">video_result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: ffprobe failed when detecting video tracks: </span><span class="si">{</span><span class="n">video_result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">video_streams</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">video_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;streams&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">video_track_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">video_streams</span><span class="p">)</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Detected </span><span class="si">{</span><span class="n">video_track_count</span><span class="si">}</span><span class="s2"> video tracks.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">audio_track_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>        <span class="s2">&quot;ffprobe&quot;</span><span class="p">,</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="s2">&quot;quiet&quot;</span><span class="p">,</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="s2">&quot;-print_format&quot;</span><span class="p">,</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="s2">&quot;-show_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="s2">&quot;-select_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="s2">&quot;a&quot;</span><span class="p">,</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">input_path</span><span class="p">),</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="p">]</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">audio_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">audio_track_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="k">if</span> <span class="n">audio_result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: ffprobe failed when detecting audio tracks: </span><span class="si">{</span><span class="n">audio_result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>        <span class="p">)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">streams</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">audio_result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;streams&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">streams</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;extract_audio_tracks: No audio tracks found!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">streams</span><span class="p">)</span><span class="si">}</span><span class="s2"> audio tracks:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="n">delays</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="n">tsmuxer_cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tsMuxeR&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">input_path</span><span class="p">)]</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">tsmuxer_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="n">tsmuxer_cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="p">)</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">tsmuxer_output</span> <span class="o">=</span> <span class="n">tsmuxer_process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="n">current_track</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tsmuxer_output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Track ID:&quot;</span><span class="p">):</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="n">current_track</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Stream delay:&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">current_track</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="n">delay_str</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="k">if</span> <span class="n">delay_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">):</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                    <span class="n">delay_str</span> <span class="o">=</span> <span class="n">delay_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>                    <span class="n">delays</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">current_track</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">delay_str</span><span class="p">)</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>                    <span class="k">pass</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Failed to get delays from tsmuxer: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">delays</span><span class="p">)</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="n">default_str</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="s2">&quot; (Default)&quot;</span> <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disposition&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="p">)</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">comment_str</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="s2">&quot; (Commentary)&quot;</span> <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disposition&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;comment&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="p">)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">):</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="nb">int</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="p">)</span>  <span class="c1"># make up id for non-m2ts sources</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">language</span> <span class="o">=</span> <span class="n">get_language_by_trackid</span><span class="p">(</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">m2ts_path</span><span class="o">=</span><span class="n">input_path</span><span class="p">,</span> <span class="n">ffprobe_id</span><span class="o">=</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="p">)</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="k">if</span> <span class="n">language</span> <span class="o">==</span> <span class="s2">&quot;und&quot;</span><span class="p">:</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="k">if</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">):</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>                <span class="n">language</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                    <span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;und&quot;</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                <span class="p">)</span>  <span class="c1"># also try ffprobe</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">language</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="sa">f</span><span class="s2">&quot;Track </span><span class="si">{</span><span class="n">stream</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;codec_name&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;channels&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">ch &quot;</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>            <span class="sa">f</span><span class="s2">&quot;Language: </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="sa">f</span><span class="s2">&quot;Delay: </span><span class="si">{</span><span class="n">delays</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="w"> </span><span class="mi">16</span><span class="p">),</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">default_str</span><span class="si">}{</span><span class="n">comment_str</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>        <span class="p">)</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="n">output_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>    <span class="n">extracted_tracks</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">:</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>        <span class="n">track_num</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="n">codec_name</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;codec_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>        <span class="n">language</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="n">channels</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;channels&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>        <span class="n">is_default</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disposition&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">))</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="n">is_comment</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disposition&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;comment&quot;</span><span class="p">))</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="n">is_stream_lossless</span> <span class="o">=</span> <span class="n">check_audio_stream_lossless</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="n">is_core_track</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="k">if</span> <span class="n">codec_name</span> <span class="o">==</span> <span class="s2">&quot;dts&quot;</span><span class="p">:</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>            <span class="n">base_id</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>            <span class="k">for</span> <span class="n">other_stream</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>                    <span class="p">[</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>                        <span class="n">other_stream</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">track_num</span><span class="p">,</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>                        <span class="n">other_stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_id</span><span class="p">),</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>                        <span class="n">other_stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;profile&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;dts-hd ma&quot;</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>                    <span class="p">]</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="p">):</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>                    <span class="n">is_core_track</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>                    <span class="k">break</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">elif</span> <span class="n">codec_name</span> <span class="o">==</span> <span class="s2">&quot;ac3&quot;</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="n">base_id</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>            <span class="k">for</span> <span class="n">other_stream</span> <span class="ow">in</span> <span class="n">streams</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>                <span class="k">if</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                    <span class="p">[</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                        <span class="n">other_stream</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">track_num</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                        <span class="n">other_stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;codec_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;truehd&quot;</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                        <span class="n">other_stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_id</span><span class="p">),</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>                    <span class="p">]</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>                <span class="p">):</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>                    <span class="n">is_core_track</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>                    <span class="k">break</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="k">if</span> <span class="n">is_core_track</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Skipping core track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">codec_name</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="k">continue</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">source_bitrate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="k">if</span> <span class="s2">&quot;bit_rate&quot;</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>                <span class="n">source_bitrate</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;bit_rate&quot;</span><span class="p">])</span> <span class="o">//</span> <span class="mi">1000</span>  <span class="c1"># kbps</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                <span class="k">pass</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">track_config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_track_config</span><span class="p">(</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="n">is_comment</span><span class="o">=</span><span class="n">is_comment</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">is_lossless</span><span class="o">=</span><span class="n">is_stream_lossless</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="n">channels</span><span class="o">=</span><span class="n">channels</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>            <span class="n">bitrate</span><span class="o">=</span><span class="n">source_bitrate</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="p">)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="k">if</span> <span class="n">track_config</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">ProcessMode</span><span class="o">.</span><span class="n">DROP</span><span class="p">:</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Dropping track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="k">continue</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="k">if</span> <span class="n">track_config</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">ProcessMode</span><span class="o">.</span><span class="n">COPY</span><span class="p">:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="n">output_ext</span> <span class="o">=</span> <span class="n">codec_name</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="n">should_copy</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>            <span class="n">encode_bitrate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>        <span class="k">elif</span> <span class="n">track_config</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">ProcessMode</span><span class="o">.</span><span class="n">COMPRESS</span><span class="p">:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>            <span class="n">output_ext</span> <span class="o">=</span> <span class="n">track_config</span><span class="o">.</span><span class="n">format</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">should_copy</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="n">encode_bitrate</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># LOSSY</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="n">output_ext</span> <span class="o">=</span> <span class="n">track_config</span><span class="o">.</span><span class="n">format</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="n">should_copy</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">encode_bitrate</span> <span class="o">=</span> <span class="n">track_config</span><span class="o">.</span><span class="n">bitrate</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;comment_&quot;</span> <span class="k">if</span> <span class="n">is_comment</span> <span class="k">else</span> <span class="s2">&quot;track_&quot;</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">output_ext</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">extract_audio_tracks: Processing </span><span class="si">{</span><span class="s1">&#39;comment &#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">is_comment</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">audio track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Codec: </span><span class="si">{</span><span class="n">codec_name</span><span class="si">}</span><span class="s2">, Channels: </span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s2">, Language: </span><span class="si">{</span><span class="n">language</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="k">if</span> <span class="n">source_bitrate</span><span class="p">:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original bitrate: </span><span class="si">{</span><span class="n">source_bitrate</span><span class="si">}</span><span class="s2">kbps&quot;</span><span class="p">)</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="n">delay</span> <span class="o">=</span> <span class="n">delays</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;-0x1&quot;</span><span class="p">),</span> <span class="mi">16</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="k">if</span> <span class="n">delay</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Applying delay of </span><span class="si">{</span><span class="n">delay</span><span class="si">}</span><span class="s2">ms for track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="p">)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="n">output_path</span> <span class="o">=</span> <span class="n">encode_audio</span><span class="p">(</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>                <span class="n">input_file</span><span class="o">=</span><span class="n">input_path</span><span class="p">,</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                <span class="n">output_file</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>                <span class="n">audio_track</span><span class="o">=</span><span class="n">track_num</span> <span class="o">-</span> <span class="n">video_track_count</span><span class="p">,</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>                <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>                <span class="n">copy</span><span class="o">=</span><span class="n">should_copy</span><span class="p">,</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>                <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>                <span class="n">bitrate</span><span class="o">=</span><span class="n">encode_bitrate</span><span class="p">,</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>            <span class="p">)</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>            <span class="n">extracted_tracks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>                <span class="p">{</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">output_path</span><span class="p">,</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                    <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">language</span><span class="p">,</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">is_default</span><span class="p">,</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>                    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="n">is_comment</span><span class="p">,</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>                <span class="p">}</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>            <span class="p">)</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Successfully extracted to: </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>                <span class="sa">f</span><span class="s2">&quot;extract_audio_tracks: Failed to extract track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="k">return</span> <span class="n">extracted_tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.get_bd_chapter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_bd_chapter</span>


<a href="#y5gfunc.expr.test_atan2.get_bd_chapter" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_bd_chapter</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="m2ts_or_mpls_path (y5gfunc.expr.test_atan2.get_bd_chapter(m2ts_or_mpls_path))" href="#y5gfunc.expr.test_atan2.get_bd_chapter(m2ts_or_mpls_path)">m2ts_or_mpls_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="chapter_save_path (y5gfunc.expr.test_atan2.get_bd_chapter(chapter_save_path))" href="#y5gfunc.expr.test_atan2.get_bd_chapter(chapter_save_path)">chapter_save_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="target_clip (y5gfunc.expr.test_atan2.get_bd_chapter(target_clip))" href="#y5gfunc.expr.test_atan2.get_bd_chapter(target_clip)">target_clip</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="all (y5gfunc.expr.test_atan2.get_bd_chapter(all))" href="#y5gfunc.expr.test_atan2.get_bd_chapter(all)">all</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extracts chapters from a Blu-ray MPLS or M2TS file to an OGM chapter file.</p>
<p>If an M2TS path is provided, it searches the corresponding BDMV structure for the MPLS file containing that M2TS clip.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_bd_chapter(m2ts_or_mpls_path)" class="doc doc-heading doc-heading-parameter">                  <code>m2ts_or_mpls_path</code>
<a href="#y5gfunc.expr.test_atan2.get_bd_chapter(m2ts_or_mpls_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the input M2TS or MPLS file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_bd_chapter(chapter_save_path)" class="doc doc-heading doc-heading-parameter">                  <code>chapter_save_path</code>
<a href="#y5gfunc.expr.test_atan2.get_bd_chapter(chapter_save_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the output OGM chapter file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_bd_chapter(target_clip)" class="doc doc-heading doc-heading-parameter">                  <code>target_clip</code>
<a href="#y5gfunc.expr.test_atan2.get_bd_chapter(target_clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The 5-digit clip name (e.g., "00001") if input is MPLS and <code>all</code> is False. Auto-detected if input is M2TS.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_bd_chapter(all)" class="doc doc-heading doc-heading-parameter">                  <code>all</code>
<a href="#y5gfunc.expr.test_atan2.get_bd_chapter(all)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, extract all chapter marks from the relevant MPLS. If False, extract chapters relative to the target_clip's start time.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the saved OGM chapter file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError">FileNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input path or required BDMV structure doesn't exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input is invalid (e.g., MPLS without target_clip/all=True, or no chapters found).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On errors during MPLS parsing.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IOError">IOError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On failure to write the chapter file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/chapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_bd_chapter</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">m2ts_or_mpls_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">chapter_save_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">target_clip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="nb">all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># True: return all mpls marks; False: return chapter</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Extracts chapters from a Blu-ray MPLS or M2TS file to an OGM chapter file.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    If an M2TS path is provided, it searches the corresponding BDMV structure for the MPLS file containing that M2TS clip.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        m2ts_or_mpls_path: Path to the input M2TS or MPLS file.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        chapter_save_path: Path to save the output OGM chapter file.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        target_clip: The 5-digit clip name (e.g., &quot;00001&quot;) if input is MPLS and `all` is False. Auto-detected if input is M2TS.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        all: If True, extract all chapter marks from the relevant MPLS. If False, extract chapters relative to the target_clip&#39;s start time.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        Path to the saved OGM chapter file.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        FileNotFoundError: If input path or required BDMV structure doesn&#39;t exist.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        ValueError: If input is invalid (e.g., MPLS without target_clip/all=True, or no chapters found).</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        RuntimeError: On errors during MPLS parsing.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        IOError: On failure to write the chapter file.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">m2ts_or_mpls_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">m2ts_or_mpls_path</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">chapter_save_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">chapter_save_path</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_format_timestamp</span><span class="p">(</span><span class="n">seconds</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">hours</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">3600</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="n">minutes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">seconds</span> <span class="o">%</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="n">seconds_remainder</span> <span class="o">=</span> <span class="n">seconds</span> <span class="o">%</span> <span class="mi">60</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="n">whole_seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds_remainder</span><span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">milliseconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">seconds_remainder</span> <span class="o">-</span> <span class="n">whole_seconds</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hours</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">minutes</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">whole_seconds</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">milliseconds</span><span class="si">:</span><span class="s2">03d</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_process_mpls</span><span class="p">(</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">mpls_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">target_clip</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>            <span class="k">with</span> <span class="n">mpls_path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="sa">b</span><span class="s2">&quot;MPLS&quot;</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>                        <span class="sa">f</span><span class="s2">&quot;get_bd_chapter: Invalid MPLS format in file: </span><span class="si">{</span><span class="n">mpls_path</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>                    <span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>                <span class="n">header</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>                <span class="n">header</span><span class="p">[</span><span class="s2">&quot;TypeIndicator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>                <span class="n">header</span><span class="p">[</span><span class="s2">&quot;VersionNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>                <span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;PlayListStartAddress&quot;</span><span class="p">],)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>                <span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;PlayListMarkStartAddress&quot;</span><span class="p">],)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>                <span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;ExtensionDataStartAddress&quot;</span><span class="p">],)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;PlayListStartAddress&quot;</span><span class="p">])</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>                <span class="p">(</span><span class="n">playlist_length</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>                <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># reserved</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>                <span class="p">(</span><span class="n">num_items</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;H&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>                <span class="p">(</span><span class="n">num_subpaths</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;H&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>                <span class="n">play_items</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>                <span class="n">target_item_index</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_items</span><span class="p">):</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>                    <span class="p">(</span><span class="n">item_length</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;H&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>                    <span class="n">item_start</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>                    <span class="n">clip_name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>                    <span class="n">codec_id</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>  <span class="c1"># noqa: F841</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                    <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># reserved</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>                    <span class="n">stc_id</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># noqa: F841</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>                    <span class="p">(</span><span class="n">in_time</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                    <span class="p">(</span><span class="n">out_time</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                    <span class="k">if</span> <span class="n">target_clip</span> <span class="ow">and</span> <span class="n">clip_name</span> <span class="o">==</span> <span class="n">target_clip</span><span class="p">:</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>                        <span class="n">target_item_index</span> <span class="o">=</span> <span class="n">i</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>                    <span class="n">play_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>                        <span class="p">{</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>                            <span class="s2">&quot;clip_name&quot;</span><span class="p">:</span> <span class="n">clip_name</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                            <span class="s2">&quot;in_time&quot;</span><span class="p">:</span> <span class="n">in_time</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                            <span class="s2">&quot;out_time&quot;</span><span class="p">:</span> <span class="n">out_time</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                        <span class="p">}</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                    <span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">item_start</span> <span class="o">+</span> <span class="n">item_length</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                <span class="k">if</span> <span class="n">target_clip</span> <span class="ow">and</span> <span class="n">target_item_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                    <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="s2">&quot;PlayListMarkStartAddress&quot;</span><span class="p">])</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="p">(</span><span class="n">marks_length</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="p">(</span><span class="n">num_marks</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;H&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">chapters_by_item</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_marks</span><span class="p">):</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                    <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># reserved</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                    <span class="p">(</span><span class="n">mark_type</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;B&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="p">(</span><span class="n">ref_play_item_id</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;H&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                    <span class="p">(</span><span class="n">mark_timestamp</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                    <span class="p">(</span><span class="n">entry_es_pid</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;H&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                    <span class="p">(</span><span class="n">duration</span><span class="p">,)</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">&quot;&gt;I&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                    <span class="k">if</span> <span class="n">mark_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                        <span class="k">if</span> <span class="n">ref_play_item_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chapters_by_item</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>                            <span class="n">chapters_by_item</span><span class="p">[</span><span class="n">ref_play_item_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                        <span class="n">chapters_by_item</span><span class="p">[</span><span class="n">ref_play_item_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mark_timestamp</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="k">if</span> <span class="n">target_clip</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>                    <span class="k">if</span> <span class="n">target_item_index</span> <span class="ow">in</span> <span class="n">chapters_by_item</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>                        <span class="n">marks</span> <span class="o">=</span> <span class="n">chapters_by_item</span><span class="p">[</span><span class="n">target_item_index</span><span class="p">]</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                        <span class="n">offset</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">marks</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                        <span class="k">if</span> <span class="n">play_items</span><span class="p">[</span><span class="n">target_item_index</span><span class="p">][</span><span class="s2">&quot;in_time&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">offset</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>                            <span class="n">offset</span> <span class="o">=</span> <span class="n">play_items</span><span class="p">[</span><span class="n">target_item_index</span><span class="p">][</span><span class="s2">&quot;in_time&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>                        <span class="k">for</span> <span class="n">timestamp</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                            <span class="n">relative_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">timestamp</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">/</span> <span class="mf">45000.0</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>                            <span class="k">if</span> <span class="n">relative_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relative_time</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                    <span class="k">for</span> <span class="n">item_id</span><span class="p">,</span> <span class="n">marks</span> <span class="ow">in</span> <span class="n">chapters_by_item</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                        <span class="n">offset</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">marks</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                        <span class="k">if</span> <span class="n">play_items</span><span class="p">[</span><span class="n">item_id</span><span class="p">][</span><span class="s2">&quot;in_time&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">offset</span><span class="p">:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                            <span class="n">offset</span> <span class="o">=</span> <span class="n">play_items</span><span class="p">[</span><span class="n">item_id</span><span class="p">][</span><span class="s2">&quot;in_time&quot;</span><span class="p">]</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                        <span class="k">for</span> <span class="n">timestamp</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                            <span class="n">relative_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">timestamp</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span> <span class="o">/</span> <span class="mf">45000.0</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                            <span class="k">if</span> <span class="n">relative_time</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">relative_time</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="k">raise</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;get_bd_chapter: Error processing MPLS file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">m2ts_or_mpls_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="sa">f</span><span class="s2">&quot;get_bd_chapter: Path does not exist: </span><span class="si">{</span><span class="n">m2ts_or_mpls_path</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="p">)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="n">is_mpls</span> <span class="o">=</span> <span class="n">m2ts_or_mpls_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.mpls&quot;</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="k">if</span> <span class="n">is_mpls</span><span class="p">:</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">target_clip</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                <span class="s2">&quot;get_bd_chapter: target_clip must be provided with MPLS input if all is False!&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="n">chapters</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">_process_mpls</span><span class="p">(</span><span class="n">m2ts_or_mpls_path</span><span class="p">,</span> <span class="n">target_clip</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">else</span> <span class="n">_process_mpls</span><span class="p">(</span><span class="n">m2ts_or_mpls_path</span><span class="p">)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>        <span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">bdmv_root</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">parent</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">m2ts_or_mpls_path</span><span class="o">.</span><span class="n">parents</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;BDMV&quot;</span><span class="p">),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">bdmv_root</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="s2">&quot;get_bd_chapter: Could not find BDMV directory in path hierarchy&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="n">target_clip</span> <span class="o">=</span> <span class="n">m2ts_or_mpls_path</span><span class="o">.</span><span class="n">stem</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">mpls_dir</span> <span class="o">=</span> <span class="n">bdmv_root</span> <span class="o">/</span> <span class="s2">&quot;BDMV&quot;</span> <span class="o">/</span> <span class="s2">&quot;PLAYLIST&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">mpls_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PLAYLIST directory not found: </span><span class="si">{</span><span class="n">mpls_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">chapters</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">for</span> <span class="n">mpls_file</span> <span class="ow">in</span> <span class="n">mpls_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.mpls&quot;</span><span class="p">):</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                <span class="n">chapters</span> <span class="o">=</span> <span class="n">_process_mpls</span><span class="p">(</span><span class="n">mpls_file</span><span class="p">,</span> <span class="n">target_clip</span><span class="o">=</span><span class="n">target_clip</span><span class="p">)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="k">if</span> <span class="n">chapters</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                    <span class="k">if</span> <span class="nb">all</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                        <span class="n">chapters</span> <span class="o">=</span> <span class="n">_process_mpls</span><span class="p">(</span><span class="n">mpls_file</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                    <span class="k">break</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">):</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="k">continue</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">chapters</span><span class="p">:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;get_bd_chapter: No chapters found in the Blu-ray disc&quot;</span><span class="p">)</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">with</span> <span class="n">chapter_save_path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">chapters</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>                <span class="n">chapter_num</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">_format_timestamp</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CHAPTER</span><span class="si">{</span><span class="n">chapter_num</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CHAPTER</span><span class="si">{</span><span class="n">chapter_num</span><span class="si">}</span><span class="s2">NAME=Chapter </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;get_bd_chapter: Failed to write chapter file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">return</span> <span class="n">chapter_save_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.get_mkv_chapter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_mkv_chapter</span>


<a href="#y5gfunc.expr.test_atan2.get_mkv_chapter" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_mkv_chapter</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="mkv_path (y5gfunc.expr.test_atan2.get_mkv_chapter(mkv_path))" href="#y5gfunc.expr.test_atan2.get_mkv_chapter(mkv_path)">mkv_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="output_path (y5gfunc.expr.test_atan2.get_mkv_chapter(output_path))" href="#y5gfunc.expr.test_atan2.get_mkv_chapter(output_path)">output_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extracts chapters from an MKV file using mkvextract to an OGM chapter file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_mkv_chapter(mkv_path)" class="doc doc-heading doc-heading-parameter">                  <code>mkv_path</code>
<a href="#y5gfunc.expr.test_atan2.get_mkv_chapter(mkv_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the input MKV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_mkv_chapter(output_path)" class="doc doc-heading doc-heading-parameter">                  <code>output_path</code>
<a href="#y5gfunc.expr.test_atan2.get_mkv_chapter(output_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the output OGM chapter file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the saved OGM chapter file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If mkvextract fails to extract chapters.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#IOError">IOError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On failure to write the chapter file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/chapter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_mkv_chapter</span><span class="p">(</span><span class="n">mkv_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    Extracts chapters from an MKV file using mkvextract to an OGM chapter file.</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        mkv_path: Path to the input MKV file.</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        output_path: Path to save the output OGM chapter file.</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        Path to the saved OGM chapter file.</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        RuntimeError: If mkvextract fails to extract chapters.</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        IOError: On failure to write the chapter file.</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">mkv_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">mkv_path</span><span class="p">)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="p">[</span><span class="s2">&quot;mkvextract&quot;</span><span class="p">,</span> <span class="s2">&quot;chapters&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">mkv_path</span><span class="p">),</span> <span class="s2">&quot;-s&quot;</span><span class="p">],</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="sa">f</span><span class="s2">&quot;get_mkv_chapter: Error extracting chapters from &#39;</span><span class="si">{</span><span class="n">mkv_path</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">chapter_data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">output_path</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">chapter_data</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="sa">f</span><span class="s2">&quot;get_mkv_chapter: Failed to write chapter file &#39;</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.mux_mkv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">mux_mkv</span>


<a href="#y5gfunc.expr.test_atan2.mux_mkv" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">mux_mkv</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="output_path (y5gfunc.expr.test_atan2.mux_mkv(output_path))" href="#y5gfunc.expr.test_atan2.mux_mkv(output_path)">output_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="videos (y5gfunc.expr.test_atan2.mux_mkv(videos))" href="#y5gfunc.expr.test_atan2.mux_mkv(videos)">videos</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="audios (y5gfunc.expr.test_atan2.mux_mkv(audios))" href="#y5gfunc.expr.test_atan2.mux_mkv(audios)">audios</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="subtitles (y5gfunc.expr.test_atan2.mux_mkv(subtitles))" href="#y5gfunc.expr.test_atan2.mux_mkv(subtitles)">subtitles</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="fonts_dir (y5gfunc.expr.test_atan2.mux_mkv(fonts_dir))" href="#y5gfunc.expr.test_atan2.mux_mkv(fonts_dir)">fonts_dir</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="chapters (y5gfunc.expr.test_atan2.mux_mkv(chapters))" href="#y5gfunc.expr.test_atan2.mux_mkv(chapters)">chapters</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Muxes video, audio, subtitle tracks, chapters, and fonts into an MKV file.</p>
<p>Uses mkvmerge for muxing tracks and chapters, and mkvpropedit for attaching fonts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.mux_mkv(output_path)" class="doc doc-heading doc-heading-parameter">                  <code>output_path</code>
<a href="#y5gfunc.expr.test_atan2.mux_mkv(output_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path for the output MKV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.mux_mkv(videos)" class="doc doc-heading doc-heading-parameter">                  <code>videos</code>
<a href="#y5gfunc.expr.test_atan2.mux_mkv(videos)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Video track(s). Can be a single dict or a list of dicts.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.mux_mkv(audios)" class="doc doc-heading doc-heading-parameter">                  <code>audios</code>
<a href="#y5gfunc.expr.test_atan2.mux_mkv(audios)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Audio track(s). Can be a single dict or a list of dicts.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.mux_mkv(subtitles)" class="doc doc-heading doc-heading-parameter">                  <code>subtitles</code>
<a href="#y5gfunc.expr.test_atan2.mux_mkv(subtitles)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Subtitle track(s). Can be a single dict or a list of dicts.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.mux_mkv(fonts_dir)" class="doc doc-heading doc-heading-parameter">                  <code>fonts_dir</code>
<a href="#y5gfunc.expr.test_atan2.mux_mkv(fonts_dir)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional directory containing TTF/OTF fonts to attach.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.mux_mkv(chapters)" class="doc doc-heading doc-heading-parameter">                  <code>chapters</code>
<a href="#y5gfunc.expr.test_atan2.mux_mkv(chapters)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional path to an OGM chapter file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Track dictionary structure:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>    <span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>       <span class="c1"># Path to the track file (Required)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>          <span class="c1"># Language code</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="s2">&quot;track_name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>        <span class="c1"># Name for the track</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>          <span class="c1"># True to set the default flag</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>          <span class="c1"># True to set the commentary flag</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>        <span class="s2">&quot;timecode&quot;</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span>    <span class="c1"># Path to a timecode file</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="p">}</span>
</code></pre></div>
    The first track of each type (video, audio, subtitle) will be marked as default unless explicitly set otherwise via the "default" key.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the created MKV file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no video, audio, subtitle, chapter, or font inputs are provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError">FileNotFoundError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an input file (track, chapter) is not found.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If mkvmerge or mkvpropedit encounters an error during execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/mux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-7">  7</a></span>
<span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">mux_mkv</span><span class="p">(</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">output_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">videos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>        <span class="n">Union</span><span class="p">[</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>            <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">audios</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="n">Union</span><span class="p">[</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>            <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="p">]</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">subtitles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="n">Union</span><span class="p">[</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>            <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]],</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="p">]</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">fonts_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">chapters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Muxes video, audio, subtitle tracks, chapters, and fonts into an MKV file.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Uses mkvmerge for muxing tracks and chapters, and mkvpropedit for attaching fonts.</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">        output_path: Path for the output MKV file.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        videos: Video track(s). Can be a single dict or a list of dicts.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        audios: Audio track(s). Can be a single dict or a list of dicts.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        subtitles: Subtitle track(s). Can be a single dict or a list of dicts.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        fonts_dir: Optional directory containing TTF/OTF fonts to attach.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        chapters: Optional path to an OGM chapter file.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        Track dictionary structure:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">            {</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">                &quot;path&quot;: str | Path,       # Path to the track file (Required)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">                &quot;language&quot;: str,          # Language code</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">                &quot;track_name&quot;: str,        # Name for the track</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">                &quot;default&quot;: bool,          # True to set the default flag</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">                &quot;comment&quot;: bool,          # True to set the commentary flag</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">                &quot;timecode&quot;: str | Path    # Path to a timecode file</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            }</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        ```</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            The first track of each type (video, audio, subtitle) will be marked as default unless explicitly set otherwise via the &quot;default&quot; key.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        Path to the created MKV file.</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        ValueError: If no video, audio, subtitle, chapter, or font inputs are provided.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        FileNotFoundError: If an input file (track, chapter) is not found.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        RuntimeError: If mkvmerge or mkvpropedit encounters an error during execution.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">if</span> <span class="n">fonts_dir</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>        <span class="n">fonts_dir</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">fonts_dir</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">if</span> <span class="n">chapters</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">chapters</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">chapters</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">((</span><span class="n">videos</span><span class="p">,</span> <span class="n">audios</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">,</span> <span class="n">chapters</span><span class="p">,</span> <span class="n">fonts_dir</span><span class="p">)):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>            <span class="s2">&quot;mux_mkv: At least one input (videos, audios, subtitles, chapters, fonts_dir) must be provided.&quot;</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_inputs</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">inputs</span><span class="p">]</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">return</span> <span class="n">inputs</span> <span class="ow">or</span> <span class="p">[]</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">videos</span> <span class="o">=</span> <span class="n">_normalize_inputs</span><span class="p">(</span><span class="n">videos</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">audios</span> <span class="o">=</span> <span class="n">_normalize_inputs</span><span class="p">(</span><span class="n">audios</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">subtitles</span> <span class="o">=</span> <span class="n">_normalize_inputs</span><span class="p">(</span><span class="n">subtitles</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">for</span> <span class="n">track_list</span> <span class="ow">in</span> <span class="p">(</span><span class="n">videos</span><span class="p">,</span> <span class="n">audios</span><span class="p">,</span> <span class="n">subtitles</span><span class="p">):</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_list</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="n">track</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">all_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">videos</span> <span class="o">+</span> <span class="n">audios</span> <span class="o">+</span> <span class="n">subtitles</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="p">[</span><span class="n">chapters</span><span class="p">]</span> <span class="k">if</span> <span class="n">chapters</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">all_files</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mux_mkv: Required file not found: </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">mkvmerge_cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mkvmerge&quot;</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_path</span><span class="p">)]</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_process_tracks</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">first_default_set</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tracks</span><span class="p">):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="k">if</span> <span class="s2">&quot;language&quot;</span> <span class="ow">in</span> <span class="n">track</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--language&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;0:</span><span class="si">{</span><span class="n">track</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="k">if</span> <span class="s2">&quot;track_name&quot;</span> <span class="ow">in</span> <span class="n">track</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--track-name&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;0:</span><span class="si">{</span><span class="n">track</span><span class="p">[</span><span class="s1">&#39;track_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">if</span> <span class="s2">&quot;comment&quot;</span> <span class="ow">in</span> <span class="n">track</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--commentary-flag&quot;</span><span class="p">,</span> <span class="s2">&quot;0:yes&quot;</span><span class="p">])</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="k">if</span> <span class="s2">&quot;timecode&quot;</span> <span class="ow">in</span> <span class="n">track</span><span class="p">:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--timestamps&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;0:</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">track</span><span class="p">[</span><span class="s1">&#39;timecode&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--default-track&quot;</span><span class="p">,</span> <span class="s2">&quot;0:yes&quot;</span><span class="p">])</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="n">first_default_set</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="k">elif</span> <span class="n">track</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--default-track&quot;</span><span class="p">,</span> <span class="s2">&quot;0:no&quot;</span><span class="p">])</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">first_default_set</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--default-track&quot;</span><span class="p">,</span> <span class="s2">&quot;0:yes&quot;</span><span class="p">])</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="n">first_default_set</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>                <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--default-track&quot;</span><span class="p">,</span> <span class="s2">&quot;0:no&quot;</span><span class="p">])</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="n">_process_tracks</span><span class="p">(</span><span class="n">videos</span><span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">_process_tracks</span><span class="p">(</span><span class="n">audios</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">_process_tracks</span><span class="p">(</span><span class="n">subtitles</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="k">if</span> <span class="n">chapters</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">mkvmerge_cmd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;--chapters&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">chapters</span><span class="p">)])</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">mkvmerge_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mux_mkv: Error executing mkvmerge:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">if</span> <span class="n">fonts_dir</span> <span class="ow">and</span> <span class="n">fonts_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="k">for</span> <span class="n">font_ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ttf&quot;</span><span class="p">,</span> <span class="s2">&quot;otf&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="k">for</span> <span class="n">font_file</span> <span class="ow">in</span> <span class="n">fonts_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*.</span><span class="si">{</span><span class="n">font_ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">):</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>                <span class="n">font_cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                    <span class="s2">&quot;mkvpropedit&quot;</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                    <span class="nb">str</span><span class="p">(</span><span class="n">output_path</span><span class="p">),</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>                    <span class="s2">&quot;--attachment-mime-type&quot;</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>                    <span class="sa">f</span><span class="s2">&quot;font/</span><span class="si">{</span><span class="n">font_ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>                    <span class="s2">&quot;--add-attachment&quot;</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                    <span class="nb">str</span><span class="p">(</span><span class="n">font_file</span><span class="p">),</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>                <span class="p">]</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="n">font_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">font_cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                <span class="k">if</span> <span class="n">font_result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                        <span class="sa">f</span><span class="s2">&quot;mux_mkv: Error adding font </span><span class="si">{</span><span class="n">font_file</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">font_result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                    <span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">return</span> <span class="n">output_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.encode_check" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">encode_check</span>


<a href="#y5gfunc.expr.test_atan2.encode_check" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">encode_check</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="encoded (y5gfunc.expr.test_atan2.encode_check(encoded))" href="#y5gfunc.expr.test_atan2.encode_check(encoded)">encoded</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="source (y5gfunc.expr.test_atan2.encode_check(source))" href="#y5gfunc.expr.test_atan2.encode_check(source)">source</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="mode (y5gfunc.expr.test_atan2.encode_check(mode))" href="#y5gfunc.expr.test_atan2.encode_check(mode)">mode</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            QcMode (y5gfunc.encode.qc.QcMode)" href="../encode/qc.html#y5gfunc.encode.qc.QcMode">QcMode</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            BOTH


  
      class-attribute
      instance-attribute
   (y5gfunc.encode.qc.QcMode.BOTH)" href="../encode/qc.html#y5gfunc.encode.qc.QcMode.BOTH">BOTH</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="threshold_cambi (y5gfunc.expr.test_atan2.encode_check(threshold_cambi))" href="#y5gfunc.expr.test_atan2.encode_check(threshold_cambi)">threshold_cambi</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="threshold_ssim (y5gfunc.expr.test_atan2.encode_check(threshold_ssim))" href="#y5gfunc.expr.test_atan2.encode_check(threshold_ssim)">threshold_ssim</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="return_type (y5gfunc.expr.test_atan2.encode_check(return_type))" href="#y5gfunc.expr.test_atan2.encode_check(return_type)">return_type</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ReturnType (y5gfunc.encode.qc.ReturnType)" href="../encode/qc.html#y5gfunc.encode.qc.ReturnType">ReturnType</a></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="            ENCODED


  
      class-attribute
      instance-attribute
   (y5gfunc.encode.qc.ReturnType.ENCODED)" href="../encode/qc.html#y5gfunc.encode.qc.ReturnType.ENCODED">ENCODED</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform a quality check on an encoded video using SSIM and/or CAMBI metrics.</p>
<p>This function compares the encoded video against optional source video (for SSIM) and calculates CAMBI scores. It identifies frames
that fall below the SSIM threshold or exceed the CAMBI threshold, printing information about problematic frames to the console.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_check(encoded)" class="doc doc-heading doc-heading-parameter">                  <code>encoded</code>
<a href="#y5gfunc.expr.test_atan2.encode_check(encoded)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The encoded video clip to check.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_check(source)" class="doc doc-heading doc-heading-parameter">                  <code>source</code>
<a href="#y5gfunc.expr.test_atan2.encode_check(source)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<span title="vstools.vs.VideoNode">VideoNode</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The source video clip for SSIM comparison. Required if mode includes SSIM. Must have the same format as <code>encoded</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_check(mode)" class="doc doc-heading doc-heading-parameter">                  <code>mode</code>
<a href="#y5gfunc.expr.test_atan2.encode_check(mode)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            QcMode (y5gfunc.encode.qc.QcMode)" href="../encode/qc.html#y5gfunc.encode.qc.QcMode">QcMode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which metrics to use.</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            BOTH


  
      class-attribute
      instance-attribute
   (y5gfunc.encode.qc.QcMode.BOTH)" href="../encode/qc.html#y5gfunc.encode.qc.QcMode.BOTH">BOTH</a></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_check(threshold_cambi)" class="doc doc-heading doc-heading-parameter">                  <code>threshold_cambi</code>
<a href="#y5gfunc.expr.test_atan2.encode_check(threshold_cambi)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum allowed CAMBI score. Frames exceeding this are flagged. Must be between 0 and 24.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_check(threshold_ssim)" class="doc doc-heading doc-heading-parameter">                  <code>threshold_ssim</code>
<a href="#y5gfunc.expr.test_atan2.encode_check(threshold_ssim)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The minimum allowed PlaneSSIM score. Frames below this are flagged. Must be between 0 and 1.</p>
              </div>
            </td>
            <td>
                  <code>0.9</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_check(return_type)" class="doc doc-heading doc-heading-parameter">                  <code>return_type</code>
<a href="#y5gfunc.expr.test_atan2.encode_check(return_type)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ReturnType (y5gfunc.encode.qc.ReturnType)" href="../encode/qc.html#y5gfunc.encode.qc.ReturnType">ReturnType</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>What to return:</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ENCODED


  
      class-attribute
      instance-attribute
   (y5gfunc.encode.qc.ReturnType.ENCODED)" href="../encode/qc.html#y5gfunc.encode.qc.ReturnType.ENCODED">ENCODED</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<span title="vstools.vs.VideoNode">VideoNode</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<span title="vstools.vs.VideoNode">VideoNode</span>, <span title="vstools.vs.VideoNode">VideoNode</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Depending on <code>return_type</code>, either the annotated encoded clip, a clip with only error frames, or a tuple containing both.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#AssertionError">AssertionError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If input parameters are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/qc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="k">def</span><span class="w"> </span><span class="nf">encode_check</span><span class="p">(</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">encoded</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">source</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">mode</span><span class="p">:</span> <span class="n">QcMode</span> <span class="o">=</span> <span class="n">QcMode</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">threshold_cambi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="n">threshold_ssim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">return_type</span><span class="p">:</span> <span class="n">ReturnType</span> <span class="o">=</span> <span class="n">ReturnType</span><span class="o">.</span><span class="n">ENCODED</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">]]:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    Perform a quality check on an encoded video using SSIM and/or CAMBI metrics.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    This function compares the encoded video against optional source video (for SSIM) and calculates CAMBI scores. It identifies frames</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    that fall below the SSIM threshold or exceed the CAMBI threshold, printing information about problematic frames to the console.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        encoded: The encoded video clip to check.</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        source: The source video clip for SSIM comparison. Required if mode includes SSIM. Must have the same format as `encoded`.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        mode: Which metrics to use.</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        threshold_cambi: The maximum allowed CAMBI score. Frames exceeding this are flagged. Must be between 0 and 24.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        threshold_ssim: The minimum allowed PlaneSSIM score. Frames below this are flagged. Must be between 0 and 1.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        return_type: What to return:</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        Depending on `return_type`, either the annotated encoded clip, a clip with only error frames, or a tuple containing both.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        AssertionError: If input parameters are invalid.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">threshold_cambi</span> <span class="o">&lt;=</span> <span class="mi">24</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">threshold_ssim</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">QcMode</span><span class="o">.</span><span class="n">BOTH</span><span class="p">:</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">enable_ssim</span> <span class="o">=</span> <span class="n">enable_cambi</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">QcMode</span><span class="o">.</span><span class="n">SSIM</span><span class="p">:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">enable_ssim</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">enable_cambi</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">enable_ssim</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="n">enable_cambi</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="k">if</span> <span class="n">enable_ssim</span><span class="p">:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="k">assert</span> <span class="n">source</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="k">assert</span> <span class="n">encoded</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">source</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">ssim</span> <span class="o">=</span> <span class="n">SSIM</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">if</span> <span class="n">enable_cambi</span><span class="p">:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">cambi</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">cambi</span><span class="o">.</span><span class="n">Cambi</span><span class="p">(</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>            <span class="p">(</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>                <span class="n">encoded</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>                <span class="k">if</span> <span class="n">vstools</span><span class="o">.</span><span class="n">get_depth</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">10</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>                <span class="k">else</span> <span class="n">vstools</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dither_type</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>            <span class="p">),</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="n">prop</span><span class="o">=</span><span class="s2">&quot;CAMBI&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">error_frames</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_chk</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">f</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoFrame</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">print_red_bold</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[1;31m&quot;</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">fout</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="n">ssim_err</span> <span class="o">=</span> <span class="n">cambi_err</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="k">if</span> <span class="n">enable_ssim</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PlaneSSIM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssim_val</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PlaneSSIM&quot;</span><span class="p">]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;ssim_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssim_err</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="mi">1</span> <span class="k">if</span> <span class="n">threshold_ssim</span> <span class="o">&gt;</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PlaneSSIM&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="k">if</span> <span class="n">enable_cambi</span><span class="p">:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;CAMBI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cambi_val</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;CAMBI&quot;</span><span class="p">]</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">fout</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;cambi_err&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cambi_err</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="mi">1</span> <span class="k">if</span> <span class="n">threshold_cambi</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;CAMBI&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">if</span> <span class="n">cambi_err</span> <span class="ow">and</span> <span class="n">enable_cambi</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">print_red_bold</span><span class="p">(</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>                <span class="sa">f</span><span class="s2">&quot;frame </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: Banding detected! CAMBI: </span><span class="si">{</span><span class="n">cambi_val</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>                <span class="sa">f</span><span class="s2">&quot;    Note: banding threshold is </span><span class="si">{</span><span class="n">threshold_cambi</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">if</span> <span class="n">ssim_err</span> <span class="ow">and</span> <span class="n">enable_ssim</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="n">print_red_bold</span><span class="p">(</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>                <span class="sa">f</span><span class="s2">&quot;frame </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: Distortion detected! SSIM: </span><span class="si">{</span><span class="n">ssim_val</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>                <span class="sa">f</span><span class="s2">&quot;    Note: distortion threshold is </span><span class="si">{</span><span class="n">threshold_ssim</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">cambi_err</span> <span class="ow">or</span> <span class="n">ssim_err</span><span class="p">):</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">: OK!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">error_frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">return</span> <span class="n">fout</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">if</span> <span class="n">enable_ssim</span> <span class="ow">and</span> <span class="n">enable_cambi</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ModifyFrame</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="p">[</span><span class="n">encoded</span><span class="p">,</span> <span class="n">cambi</span><span class="p">,</span> <span class="n">ssim</span><span class="p">],</span> <span class="n">_chk</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">elif</span> <span class="n">enable_cambi</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ModifyFrame</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="p">[</span><span class="n">encoded</span><span class="p">,</span> <span class="n">cambi</span><span class="p">,</span> <span class="n">cambi</span><span class="p">],</span> <span class="n">_chk</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">ModifyFrame</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="p">[</span><span class="n">encoded</span><span class="p">,</span> <span class="n">ssim</span><span class="p">,</span> <span class="n">ssim</span><span class="p">],</span> <span class="n">_chk</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="n">ReturnType</span><span class="o">.</span><span class="n">ENCODED</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">frames</span><span class="p">():</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="k">pass</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">err</span> <span class="o">=</span> <span class="n">PickFrames</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">error_frames</span><span class="p">)</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="n">ReturnType</span><span class="o">.</span><span class="n">BOTH</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">return</span> <span class="n">output</span><span class="p">,</span> <span class="n">err</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="k">return</span> <span class="n">err</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.subset_fonts" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">subset_fonts</span>


<a href="#y5gfunc.expr.test_atan2.subset_fonts" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">subset_fonts</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="ass_path (y5gfunc.expr.test_atan2.subset_fonts(ass_path))" href="#y5gfunc.expr.test_atan2.subset_fonts(ass_path)">ass_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">]],</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="fonts_path (y5gfunc.expr.test_atan2.subset_fonts(fonts_path))" href="#y5gfunc.expr.test_atan2.subset_fonts(fonts_path)">fonts_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="output_directory (y5gfunc.expr.test_atan2.subset_fonts(output_directory))" href="#y5gfunc.expr.test_atan2.subset_fonts(output_directory)">output_directory</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a subset of fonts containing only the glyphs used by specified ASS files.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.subset_fonts(ass_path)" class="doc doc-heading doc-heading-parameter">                  <code>ass_path</code>
<a href="#y5gfunc.expr.test_atan2.subset_fonts(ass_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a single ASS file or a list of paths to ASS files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.subset_fonts(fonts_path)" class="doc doc-heading doc-heading-parameter">                  <code>fonts_path</code>
<a href="#y5gfunc.expr.test_atan2.subset_fonts(fonts_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory containing the original font files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.subset_fonts(output_directory)" class="doc doc-heading doc-heading-parameter">                  <code>output_directory</code>
<a href="#y5gfunc.expr.test_atan2.subset_fonts(output_directory)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the directory where the subsetted fonts will be saved. This directory will be created if it doesn't exist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path object representing the output directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the 'assfonts' command fails (returns a non-zero exit code) or if there are warnings or errors.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/subtitle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">subset_fonts</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">ass_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]],</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">fonts_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">output_directory</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Create a subset of fonts containing only the glyphs used by specified ASS files.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        ass_path: Path to a single ASS file or a list of paths to ASS files.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        fonts_path: Path to the directory containing the original font files.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        output_directory: Path to the directory where the subsetted fonts will be saved. This directory will be created if it doesn&#39;t exist.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        The Path object representing the output directory.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        RuntimeError: If the &#39;assfonts&#39; command fails (returns a non-zero exit code) or if there are warnings or errors.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ass_path</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">)):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="n">ass_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">ass_path</span><span class="p">]</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">ass_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">resolve_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">ass_path</span><span class="p">]</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">fonts_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">fonts_path</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="n">output_directory</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">output_directory</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">subtitle_command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;assfonts&quot;</span><span class="p">]</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">ass_paths</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">subtitle_command</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)]</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="n">subtitle_command</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">fonts_path</span><span class="p">),</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_directory</span><span class="p">)]</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">subtitle_command</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;subset_fonts: assfonts failed: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;[WARN]&quot;</span><span class="p">,</span> <span class="s2">&quot;[ERROR]&quot;</span><span class="p">]):</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;subset_fonts: assfonts failed: </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="k">return</span> <span class="n">output_directory</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.extract_pgs_subtitles" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">extract_pgs_subtitles</span>


<a href="#y5gfunc.expr.test_atan2.extract_pgs_subtitles" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">extract_pgs_subtitles</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="m2ts_path (y5gfunc.expr.test_atan2.extract_pgs_subtitles(m2ts_path))" href="#y5gfunc.expr.test_atan2.extract_pgs_subtitles(m2ts_path)">m2ts_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="output_dir (y5gfunc.expr.test_atan2.extract_pgs_subtitles(output_dir))" href="#y5gfunc.expr.test_atan2.extract_pgs_subtitles(output_dir)">output_dir</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span><span class="p">]]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract all PGS (HDMV PGS) subtitle tracks from an M2TS file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.extract_pgs_subtitles(m2ts_path)" class="doc doc-heading doc-heading-parameter">                  <code>m2ts_path</code>
<a href="#y5gfunc.expr.test_atan2.extract_pgs_subtitles(m2ts_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the input M2TS file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.extract_pgs_subtitles(output_dir)" class="doc doc-heading doc-heading-parameter">                  <code>output_dir</code>
<a href="#y5gfunc.expr.test_atan2.extract_pgs_subtitles(output_dir)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional path to the directory where extracted .sup files will be saved. If None, defaults to a subdirectory
        'named '{m2ts_file_stem}_subs' next to the input M2TS file. The directory will be created if it doesn't exist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, where each dictionary represents a successfully extracted pgs subtitle and contains keys suitable for use in muxing functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If ffprobe fails, if tsMuxeR fails, if no PGS subtitles are found, or if an expected demuxed subtitle file is not found after tsMuxeR runs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/subtitle.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_pgs_subtitles</span><span class="p">(</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">m2ts_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]]:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    Extract all PGS (HDMV PGS) subtitle tracks from an M2TS file.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        m2ts_path: Path to the input M2TS file.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        output_dir: Optional path to the directory where extracted .sup files will be saved. If None, defaults to a subdirectory</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">                    &#39;named &#39;{m2ts_file_stem}_subs&#39; next to the input M2TS file. The directory will be created if it doesn&#39;t exist.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        A list of dictionaries, where each dictionary represents a successfully extracted pgs subtitle and contains keys suitable for use in muxing functions.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        RuntimeError: If ffprobe fails, if tsMuxeR fails, if no PGS subtitles are found, or if an expected demuxed subtitle file is not found after tsMuxeR runs.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">m2ts_path</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">m2ts_path</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">m2ts_path</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m2ts_path</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">_subs&quot;</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">output_dir</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Analyzing </span><span class="si">{</span><span class="n">m2ts_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="s2">&quot;ffprobe&quot;</span><span class="p">,</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="s2">&quot;-v&quot;</span><span class="p">,</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="s2">&quot;quiet&quot;</span><span class="p">,</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="s2">&quot;-print_format&quot;</span><span class="p">,</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="s2">&quot;-show_streams&quot;</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="nb">str</span><span class="p">(</span><span class="n">m2ts_path</span><span class="p">),</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="p">]</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: ffprobe failed: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">probe_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">pgs_streams</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">probe_data</span><span class="p">[</span><span class="s2">&quot;streams&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">):</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="k">if</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;codec_name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hdmv_pgs_subtitle&quot;</span><span class="p">:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>            <span class="n">stream_id</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="n">language</span> <span class="o">=</span> <span class="n">get_language_by_trackid</span><span class="p">(</span><span class="n">m2ts_path</span><span class="p">,</span> <span class="n">stream_id</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">pgs_streams</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="p">{</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                    <span class="s2">&quot;track_id&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">stream_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                    <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">language</span> <span class="ow">or</span> <span class="s2">&quot;und&quot;</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                    <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">stream</span><span class="p">[</span><span class="s2">&quot;disposition&quot;</span><span class="p">][</span><span class="s2">&quot;default&quot;</span><span class="p">]),</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;PGS&quot;</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="p">}</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">pgs_streams</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;extract_pgs_subtitles: No PGS subtitles found!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pgs_streams</span><span class="p">)</span><span class="si">}</span><span class="s2"> PGS subtitle streams:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">pgs_streams</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">default_str</span> <span class="o">=</span> <span class="s2">&quot; (Default)&quot;</span> <span class="k">if</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Track </span><span class="si">{</span><span class="n">stream</span><span class="p">[</span><span class="s1">&#39;track_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: Language </span><span class="si">{</span><span class="n">stream</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span><span class="si">}{</span><span class="n">default_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">temp_dir</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">resolve_path</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Using temporary directory: </span><span class="si">{</span><span class="n">temp_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">meta_content</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MUXOPT --no-pcr-on-video-pid --new-audio-pes --demux</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">pgs_streams</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="n">meta_line</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;S_HDMV/PGS, </span><span class="se">\&quot;</span><span class="si">{</span><span class="n">m2ts_path</span><span class="si">}</span><span class="se">\&quot;</span><span class="s2">, track=</span><span class="si">{</span><span class="n">stream</span><span class="p">[</span><span class="s1">&#39;track_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">meta_content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta_line</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Adding to meta: </span><span class="si">{</span><span class="n">meta_line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">meta_file</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="s2">&quot;meta.txt&quot;</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="n">meta_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">meta_content</span><span class="p">))</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Created meta file at: </span><span class="si">{</span><span class="n">meta_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">output_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Output directory: </span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">extract_pgs_subtitles: Running tsMuxeR...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tsmuxer&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">meta_file</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">)]</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Command: </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">cmd</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">bufsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="p">)</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">output</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">process</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="k">break</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="k">if</span> <span class="n">output</span><span class="p">:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: tsMuxeR: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">if</span> <span class="n">stdout</span><span class="p">:</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: tsMuxeR additional output: </span><span class="si">{</span><span class="n">stdout</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>        <span class="k">if</span> <span class="n">stderr</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: tsMuxeR error output: </span><span class="si">{</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: tsMuxeR failed with return code </span><span class="si">{</span><span class="n">process</span><span class="o">.</span><span class="n">returncode</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">extract_pgs_subtitles: Extracting subtitles...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">subtitles</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">pgs_streams</span><span class="p">:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="n">track_num</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;track_id&quot;</span><span class="p">]</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="n">sup_file</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">temp_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*track_</span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">.sup&quot;</span><span class="p">))</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                <span class="n">final_path</span> <span class="o">=</span> <span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;track_</span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">stream</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.sup&quot;</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sup_file</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">final_path</span><span class="p">))</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                <span class="n">default_str</span> <span class="o">=</span> <span class="s2">&quot; (Default)&quot;</span> <span class="k">if</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                    <span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Extracted subtitle track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">final_path</span><span class="si">}{</span><span class="n">default_str</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="p">)</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                <span class="n">subtitles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                    <span class="p">{</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">final_path</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                        <span class="s2">&quot;language&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">],</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                    <span class="p">}</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="p">)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                    <span class="sa">f</span><span class="s2">&quot;extract_pgs_subtitles: Could not find extracted subtitle for track </span><span class="si">{</span><span class="n">track_num</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">extract_pgs_subtitles: Extraction completed!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">return</span> <span class="n">subtitles</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.get_language_by_trackid" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_language_by_trackid</span>


<a href="#y5gfunc.expr.test_atan2.get_language_by_trackid" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_language_by_trackid</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="m2ts_path (y5gfunc.expr.test_atan2.get_language_by_trackid(m2ts_path))" href="#y5gfunc.expr.test_atan2.get_language_by_trackid(m2ts_path)">m2ts_path</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="ffprobe_id (y5gfunc.expr.test_atan2.get_language_by_trackid(ffprobe_id))" href="#y5gfunc.expr.test_atan2.get_language_by_trackid(ffprobe_id)">ffprobe_id</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the language code for a specific track ID within an M2TS file.</p>
<p>Uses tsMuxeR to analyze the M2TS file and extract the language tag
associated with the given track ID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_language_by_trackid(m2ts_path)" class="doc doc-heading doc-heading-parameter">                  <code>m2ts_path</code>
<a href="#y5gfunc.expr.test_atan2.get_language_by_trackid(m2ts_path)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the M2TS file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.get_language_by_trackid(ffprobe_id)" class="doc doc-heading doc-heading-parameter">                  <code>ffprobe_id</code>
<a href="#y5gfunc.expr.test_atan2.get_language_by_trackid(ffprobe_id)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The track ID. Can be a hexadecimal string (e.g., '0x1011') or an integer representing the 0-based index from ffprobe.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The language code (e.g., "eng", "jpn") or "und" if not found or if tsMuxeR fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_language_by_trackid</span><span class="p">(</span><span class="n">m2ts_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">ffprobe_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="sd">    Get the language code for a specific track ID within an M2TS file.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="sd">    Uses tsMuxeR to analyze the M2TS file and extract the language tag</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    associated with the given track ID.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="sd">        m2ts_path: Path to the M2TS file.</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">        ffprobe_id: The track ID. Can be a hexadecimal string (e.g., &#39;0x1011&#39;) or an integer representing the 0-based index from ffprobe.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        The language code (e.g., &quot;eng&quot;, &quot;jpn&quot;) or &quot;und&quot; if not found or if tsMuxeR fails.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">ffprobe_id</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">):</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>        <span class="n">track_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ffprobe_id</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="n">track_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ffprobe_id</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="n">tsmuxer_output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="s2">&quot;tsMuxeR&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">m2ts_path</span><span class="p">)],</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">return</span> <span class="s2">&quot;und&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">current_track</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">track_langs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tsmuxer_output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Track ID:&quot;</span><span class="p">):</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>            <span class="n">current_track</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Stream lang:&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">current_track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="n">lang</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="n">track_langs</span><span class="p">[</span><span class="n">current_track</span><span class="p">]</span> <span class="o">=</span> <span class="n">lang</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="n">current_track</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">return</span> <span class="n">track_langs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">track_id</span><span class="p">,</span> <span class="s2">&quot;und&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;und&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.encode_video" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">encode_video</span>


<a href="#y5gfunc.expr.test_atan2.encode_video" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">encode_video</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.encode_video(clip))" href="#y5gfunc.expr.test_atan2.encode_video(clip)">clip</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></span><span class="p">[</span><span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">]]]],</span> <span class="n"><a class="autorefs autorefs-internal" title="encoder (y5gfunc.expr.test_atan2.encode_video(encoder))" href="#y5gfunc.expr.test_atan2.encode_video(encoder)">encoder</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.IO" href="https://docs.python.org/3/library/typing.html#typing.IO">IO</a></span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="multi (y5gfunc.expr.test_atan2.encode_video(multi))" href="#y5gfunc.expr.test_atan2.encode_video(multi)">multi</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Encode one or multiple VapourSynth video nodes using external encoders or output directly to stdout.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_video(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.encode_video(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<span title="vstools.vs.VideoNode">VideoNode</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<span title="vstools.vs.VideoNode">VideoNode</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<span title="vstools.vs.VideoNode">VideoNode</span>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VapourSynth video node or a list of video nodes/tuples to encode.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_video(encoder)" class="doc doc-heading doc-heading-parameter">                  <code>encoder</code>
<a href="#y5gfunc.expr.test_atan2.encode_video(encoder)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>], <a class="autorefs autorefs-external" title="subprocess.Popen" href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">Popen</a>, <a class="autorefs autorefs-external" title="typing.IO" href="https://docs.python.org/3/library/typing.html#typing.IO">IO</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>External encoder process(es) created with subprocess.Popen, a file-like object, or None to output to stdout.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.encode_video(multi)" class="doc doc-heading doc-heading-parameter">                  <code>multi</code>
<a href="#y5gfunc.expr.test_atan2.encode_video(multi)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, handle multiple input clips and multiple encoders. If False, handle a single clip.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<div class="highlight"><pre><span></span><code>```python

# Output to an external encoder
encoder = subprocess.Popen([&#39;x264&#39;, &#39;--demuxer&#39;, &#39;y4m&#39;, &#39;-&#39;, &#39;-o&#39;, &#39;output.mp4&#39;], stdin=subprocess.PIPE)
encode_video(clip, encoder)

# Output directly to stdout (like vspipe)
encode_video(clip, None)
# or
encode_video(clip, sys.stdout)

# Output to a file
with open(&#39;output.y4m&#39;, &#39;wb&#39;) as f:
    encode_video(clip, f)

# Example with multiple encoders
encoders = [
    subprocess.Popen([&#39;x264&#39;, &#39;--demuxer&#39;, &#39;y4m&#39;, &#39;-&#39;, &#39;-o&#39;, &#39;output1.mp4&#39;], stdin=subprocess.PIPE),
    subprocess.Popen([&#39;x264&#39;, &#39;--demuxer&#39;, &#39;y4m&#39;, &#39;-&#39;, &#39;-o&#39;, &#39;output2.mp4&#39;], stdin=subprocess.PIPE)
]
encode_video([clip1, clip2], encoders, multi=True)

```
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/video.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="k">def</span><span class="w"> </span><span class="nf">encode_video</span><span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">clip</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]],</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">encoder</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Popen</span><span class="p">],</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">IO</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">multi</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="sd">    Encode one or multiple VapourSynth video nodes using external encoders or output directly to stdout.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        clip: A VapourSynth video node or a list of video nodes/tuples to encode.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        encoder: External encoder process(es) created with subprocess.Popen, a file-like object, or None to output to stdout.</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        multi: If True, handle multiple input clips and multiple encoders. If False, handle a single clip.</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        # Output to an external encoder</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        encoder = subprocess.Popen([&#39;x264&#39;, &#39;--demuxer&#39;, &#39;y4m&#39;, &#39;-&#39;, &#39;-o&#39;, &#39;output.mp4&#39;], stdin=subprocess.PIPE)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        encode_video(clip, encoder)</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        # Output directly to stdout (like vspipe)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        encode_video(clip, None)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        # or</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        encode_video(clip, sys.stdout)</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        # Output to a file</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        with open(&#39;output.y4m&#39;, &#39;wb&#39;) as f:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            encode_video(clip, f)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        # Example with multiple encoders</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        encoders = [</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">            subprocess.Popen([&#39;x264&#39;, &#39;--demuxer&#39;, &#39;y4m&#39;, &#39;-&#39;, &#39;-o&#39;, &#39;output1.mp4&#39;], stdin=subprocess.PIPE),</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            subprocess.Popen([&#39;x264&#39;, &#39;--demuxer&#39;, &#39;y4m&#39;, &#39;-&#39;, &#39;-o&#39;, &#39;output2.mp4&#39;], stdin=subprocess.PIPE)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        ]</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        encode_video([clip1, clip2], encoders, multi=True)</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        ```</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">multi</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">output_clip</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">):</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">output_clip</span> <span class="o">=</span> <span class="n">clip</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">clip</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                    <span class="n">clip</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">item</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                            <span class="n">output_clip</span> <span class="o">=</span> <span class="n">clip</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;encode_video: Tuple must be (VideoNode, int)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">output_clip</span><span class="p">:</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="n">output_clip</span> <span class="o">=</span> <span class="n">clip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">clip</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">output_clip</span><span class="p">:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;encode_video: Couldn&#39;t parse clip!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_clip</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="k">assert</span> <span class="p">(</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>            <span class="n">output_clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">color_family</span> <span class="o">==</span> <span class="n">vs</span><span class="o">.</span><span class="n">YUV</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: All clips must be YUV color family&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="k">assert</span> <span class="n">output_clip</span><span class="o">.</span><span class="n">fps</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;encode_video: all clips must be CFR&quot;</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="c1"># Allow direct output to stdout when encoder is None</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="k">if</span> <span class="n">encoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">_MIMO</span><span class="p">([</span><span class="n">output_clip</span><span class="p">],</span> <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">])</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">write</span><span class="p">):</span>  <span class="c1"># type: ignore # type: ignore # File-like object</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">_MIMO</span><span class="p">([</span><span class="n">output_clip</span><span class="p">],</span> <span class="p">[</span><span class="n">encoder</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Subprocess.Popen object</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">_MIMO</span><span class="p">([</span><span class="n">output_clip</span><span class="p">],</span> <span class="p">[</span><span class="n">encoder</span><span class="o">.</span><span class="n">stdin</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">encoder</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="n">encoder</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">encoder</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: encoder must be a list when multi=True&quot;</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">clip</span><span class="p">,</span> <span class="nb">list</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: clip must be a list when multi=True&quot;</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">encoder</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">clip</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: encoder and clip must have the same length&quot;</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">clip</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: all items in clip must be VideoNodes&quot;</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">clip</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">color_family</span> <span class="o">==</span> <span class="n">vs</span><span class="o">.</span><span class="n">YUV</span> <span class="k">for</span> <span class="n">clip</span> <span class="ow">in</span> <span class="n">clip</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: all clips must be YUV color family&quot;</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">clip</span><span class="o">.</span><span class="n">fps</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">clip</span> <span class="ow">in</span> <span class="n">clip</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="p">),</span> <span class="s2">&quot;encode_video: all clips must be CFR&quot;</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">output_clips</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">stdins</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">clip</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clip</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="n">output_clips</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">encoder</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s2">&quot;write&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">encoder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">):</span>  <span class="c1"># type: ignore # File-like object</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>                <span class="n">stdins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">encoder</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Subprocess.Popen object</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">stdins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">encoder</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">_MIMO</span><span class="p">(</span><span class="n">output_clips</span><span class="p">,</span> <span class="n">stdins</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="c1"># Only call communicate and wait for Popen objects</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">enc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">encoder</span><span class="p">):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">enc</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">enc</span><span class="o">.</span><span class="n">write</span><span class="p">):</span>  <span class="c1"># type: ignore # Not a file-like object</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="n">enc</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="n">enc</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.check_audio_stream_lossless" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">check_audio_stream_lossless</span>


<a href="#y5gfunc.expr.test_atan2.check_audio_stream_lossless" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">check_audio_stream_lossless</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="stream (y5gfunc.expr.test_atan2.check_audio_stream_lossless(stream))" href="#y5gfunc.expr.test_atan2.check_audio_stream_lossless(stream)">stream</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Checks if an audio stream from ffprobe represents a lossless format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.check_audio_stream_lossless(stream)" class="doc doc-heading doc-heading-parameter">                  <code>stream</code>
<a href="#y5gfunc.expr.test_atan2.check_audio_stream_lossless(stream)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary representing an audio stream from ffprobe JSON.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the stream is identified as lossless, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/encode/audio/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="k">def</span><span class="w"> </span><span class="nf">check_audio_stream_lossless</span><span class="p">(</span><span class="n">stream</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Checks if an audio stream from ffprobe represents a lossless format.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        stream: A dictionary representing an audio stream from ffprobe JSON.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">        True if the stream is identified as lossless, False otherwise.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">codec_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;codec_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">profile</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;profile&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">if</span> <span class="s2">&quot;dts&quot;</span> <span class="ow">in</span> <span class="n">profile</span> <span class="ow">or</span> <span class="n">codec_name</span> <span class="o">==</span> <span class="s2">&quot;dts&quot;</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="k">if</span> <span class="n">profile</span> <span class="o">==</span> <span class="s2">&quot;dts-hd ma&quot;</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="k">if</span> <span class="n">codec_name</span> <span class="ow">in</span> <span class="n">LOSSLESS_CODEC_NAMES</span><span class="p">:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.ranger" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">ranger</span>


<a href="#y5gfunc.expr.test_atan2.ranger" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">ranger</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="start (y5gfunc.expr.test_atan2.ranger(start))" href="#y5gfunc.expr.test_atan2.ranger(start)">start</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="end (y5gfunc.expr.test_atan2.ranger(end))" href="#y5gfunc.expr.test_atan2.ranger(end)">end</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" title="step (y5gfunc.expr.test_atan2.ranger(step))" href="#y5gfunc.expr.test_atan2.ranger(step)">step</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates a sequence of numbers similar to range(), but allows floats.</p>
<p>Creates a list of numbers starting from <code>start</code>, incrementing by <code>step</code>, and stopping before <code>end</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.ranger(start)" class="doc doc-heading doc-heading-parameter">                  <code>start</code>
<a href="#y5gfunc.expr.test_atan2.ranger(start)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The starting value of the sequence (inclusive).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.ranger(end)" class="doc doc-heading doc-heading-parameter">                  <code>end</code>
<a href="#y5gfunc.expr.test_atan2.ranger(end)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The end value of the sequence (exclusive). The sequence generated will contain values strictly
less than <code>end</code> if <code>step</code> is positive, or strictly greater than <code>end</code> if <code>step</code> is negative.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.ranger(step)" class="doc doc-heading doc-heading-parameter">                  <code>step</code>
<a href="#y5gfunc.expr.test_atan2.ranger(step)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The step/increment between consecutive numbers. Must not be zero. Can be negative for descending sequences.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" title="typing.Union" href="https://docs.python.org/3/library/typing.html#typing.Union">Union</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of numbers (integers or floats) representing the generated sequence.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>step</code> is 0.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">ranger</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">start</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">end</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">step</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="sd">    Generates a sequence of numbers similar to range(), but allows floats.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">    Creates a list of numbers starting from `start`, incrementing by `step`, and stopping before `end`.</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        start: The starting value of the sequence (inclusive).</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">        end: The end value of the sequence (exclusive). The sequence generated will contain values strictly</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">            less than `end` if `step` is positive, or strictly greater than `end` if `step` is negative.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        step: The step/increment between consecutive numbers. Must not be zero. Can be negative for descending sequences.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        A list of numbers (integers or floats) representing the generated sequence.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        ValueError: If `step` is 0.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ranger: Step cannot be zero.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">step</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">step</span><span class="p">)))</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.PickFrames" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">PickFrames</span>


<a href="#y5gfunc.expr.test_atan2.PickFrames" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">PickFrames</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="clip (y5gfunc.expr.test_atan2.PickFrames(clip))" href="#y5gfunc.expr.test_atan2.PickFrames(clip)">clip</a></span><span class="p">:</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="indices (y5gfunc.expr.test_atan2.PickFrames(indices))" href="#y5gfunc.expr.test_atan2.PickFrames(indices)">indices</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="vstools.vs.VideoNode">VideoNode</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a new clip with frames picked from input clip from the indices array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.PickFrames(clip)" class="doc doc-heading doc-heading-parameter">                  <code>clip</code>
<a href="#y5gfunc.expr.test_atan2.PickFrames(clip)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input clip where frames are from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
<h3 id="y5gfunc.expr.test_atan2.PickFrames(indices)" class="doc doc-heading doc-heading-parameter">                  <code>indices</code>
<a href="#y5gfunc.expr.test_atan2.PickFrames(indices)" class="headerlink" title="Permanent link">&para;</a></h3>            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The indices array representing the frames to be picked.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="vstools.vs.VideoNode">VideoNode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New clip with frames picked from input clip from the indices array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>y5gfunc/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">def</span><span class="w"> </span><span class="nf">PickFrames</span><span class="p">(</span><span class="n">clip</span><span class="p">:</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">vs</span><span class="o">.</span><span class="n">VideoNode</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Return a new clip with frames picked from input clip from the indices array.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        clip: Input clip where frames are from.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        indices: The indices array representing the frames to be picked.</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        New clip with frames picked from input clip from the indices array.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">return</span> <span class="n">clip</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">SelectEvery</span><span class="p">(</span><span class="n">cycle</span><span class="o">=</span><span class="n">clip</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.calc_atan2_expr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">calc_atan2_expr</span>


<a href="#y5gfunc.expr.test_atan2.calc_atan2_expr" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">calc_atan2_expr</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.calc_atan2_expr(y)">y</span></span><span class="p">,</span> <span class="n"><span title="y5gfunc.expr.test_atan2.calc_atan2_expr(x)">x</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/test_atan2.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">expr</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> dup 0 = dup2 0 &lt; -1.5708 1.5708 ? dup2 0 = dup4 0 = and 0 dup4 0 = dup6 and dup6 0 &lt; -1.5708 1.5708 ? dup6 0 &lt; dup8 dup8 / 0 &lt; dup9 dup9 / abs 1 &gt; 1.5708 -2.02586e-05 dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.00116407 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.00918456 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0258268 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0409264 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0523923 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0666586 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * 0.000223022 dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.00385597 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.016978 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0340678 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0467395 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0587731 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0769221 + + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * -0.090909 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * 0.111111 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * -0.142857 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * 0.2 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * -0.333333 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? * dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? + -1 * + -2.02586e-05 dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.00116407 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.00918456 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0258268 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0409264 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0523923 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow 2 pow * -0.0666586 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * 0.000223022 dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.00385597 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.016978 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0340678 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0467395 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0587731 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * 0.0769221 + + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * -0.090909 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * 0.111111 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * -0.142857 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * 0.2 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * -0.333333 + dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? 2 pow * dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? * dup12 dup12 / abs 1 &gt; 1 dup14 dup14 / abs / dup14 dup14 / abs ? + ? abs -1 * dup10 dup10 / abs 1 &gt; 1.5708 -2.02586e-05 dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.00116407 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.00918456 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0258268 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0409264 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0523923 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0666586 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * 0.000223022 dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.00385597 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.016978 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0340678 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0467395 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0587731 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0769221 + + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * -0.090909 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * 0.111111 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * -0.142857 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * 0.2 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * -0.333333 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? * dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? + -1 * + -2.02586e-05 dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.00116407 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.00918456 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0258268 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0409264 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0523923 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow 2 pow * -0.0666586 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * 0.000223022 dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.00385597 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.016978 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0340678 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0467395 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0587731 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * 0.0769221 + + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * -0.090909 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * 0.111111 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * -0.142857 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * 0.2 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * -0.333333 + dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? 2 pow * dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? * dup13 dup13 / abs 1 &gt; 1 dup15 dup15 / abs / dup15 dup15 / abs ? + ? abs ? dup9 0 &lt; -3.14159 3.14159 ? + dup8 0 &gt; dup10 dup10 / 0 &lt; dup11 dup11 / abs 1 &gt; 1.5708 -2.02586e-05 dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.00116407 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.00918456 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0258268 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0409264 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0523923 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0666586 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * 0.000223022 dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.00385597 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.016978 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0340678 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0467395 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0587731 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0769221 + + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * -0.090909 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * 0.111111 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * -0.142857 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * 0.2 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * -0.333333 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? * dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? + -1 * + -2.02586e-05 dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.00116407 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.00918456 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0258268 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0409264 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0523923 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow 2 pow * -0.0666586 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * 0.000223022 dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.00385597 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.016978 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0340678 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0467395 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0587731 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * 0.0769221 + + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * -0.090909 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * 0.111111 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * -0.142857 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * 0.2 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * -0.333333 + dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? 2 pow * dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? * dup14 dup14 / abs 1 &gt; 1 dup16 dup16 / abs / dup16 dup16 / abs ? + ? abs -1 * dup12 dup12 / abs 1 &gt; 1.5708 -2.02586e-05 dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.00116407 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.00918456 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0258268 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0409264 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0523923 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0666586 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * 0.000223022 dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.00385597 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.016978 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0340678 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0467395 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0587731 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0769221 + + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * -0.090909 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * 0.111111 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * -0.142857 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * 0.2 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * -0.333333 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? * dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? + -1 * + -2.02586e-05 dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.00116407 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.00918456 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0258268 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0409264 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0523923 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow 2 pow * -0.0666586 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * 0.000223022 dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.00385597 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.016978 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0340678 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0467395 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0587731 + dup16 dup16 / abs 1 &gt; 1 dup18 dup18 / abs / dup18 dup18 / abs ? 2 pow 2 pow * 0.0769221 + + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * -0.090909 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * 0.111111 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * -0.142857 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * 0.2 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * -0.333333 + dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? 2 pow * dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? * dup15 dup15 / abs 1 &gt; 1 dup17 dup17 / abs / dup17 dup17 / abs ? + ? abs ? 0 ? ? ? ? ? swap 0 * + swap 0 * +&#39;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">akarin</span> <span class="o">=</span> <span class="n">get_pixel_value</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">akarin</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">BlankClip</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">GRAYS</span><span class="p">),</span> <span class="n">expr</span><span class="p">))</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">std</span> <span class="o">=</span> <span class="n">get_pixel_value</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">Expr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">std</span><span class="o">.</span><span class="n">BlankClip</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="n">GRAYS</span><span class="p">),</span> <span class="n">expr</span><span class="p">))</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">py</span> <span class="o">=</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">akarin</span> <span class="o">-</span> <span class="n">std</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">akarin</span> <span class="o">-</span> <span class="n">py</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">std</span> <span class="o">-</span> <span class="n">py</span><span class="p">))</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">if_pass</span> <span class="o">=</span> <span class="n">max_diff</span> <span class="o">&lt;</span> <span class="mf">1e-5</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;atan(</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">) =&gt; Akarin: </span><span class="si">{</span><span class="n">akarin</span><span class="si">}</span><span class="s2">, Std: </span><span class="si">{</span><span class="n">std</span><span class="si">}</span><span class="s2">, Python: </span><span class="si">{</span><span class="n">py</span><span class="si">}</span><span class="s2">; max_diff: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Pass&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">if_pass</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Fail&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="k">return</span> <span class="n">if_pass</span><span class="p">,</span> <span class="n">max_diff</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.get_pixel_value" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_pixel_value</span>


<a href="#y5gfunc.expr.test_atan2.get_pixel_value" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">get_pixel_value</span><span class="p">(</span><span class="n"><span title="y5gfunc.expr.test_atan2.get_pixel_value(clip)">clip</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/test_atan2.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_pixel_value</span><span class="p">(</span><span class="n">clip</span><span class="p">):</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">frame</span> <span class="o">=</span> <span class="n">clip</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">return</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="y5gfunc.expr.test_atan2.test_atan2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">test_atan2</span>


<a href="#y5gfunc.expr.test_atan2.test_atan2" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="doc-signature highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">test_atan2</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>y5gfunc/expr/test_atan2.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="k">def</span><span class="w"> </span><span class="nf">test_atan2</span><span class="p">():</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="c1"># Test with various y, x pairs</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="n">success</span> <span class="o">=</span> <span class="n">fail</span> <span class="o">=</span> <span class="n">total</span> <span class="o">=</span> <span class="n">max_diff</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="n">test_cases</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>   <span class="c1"># atan2(0, 1) = 0</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>   <span class="c1"># atan2(1, 0) = /2</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># atan2(0, -1) = </span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>  <span class="c1"># atan2(-1, 0) = -/2</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>   <span class="c1"># atan2(1, 1) = /4</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># atan2(-1, -1) = -3/4</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># atan2(1, -1) = 3/4</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># atan2(-1, 1) = -/4</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="p">]</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_cases</span><span class="p">:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="n">is_success</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="k">if</span> <span class="n">is_success</span><span class="p">:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>            <span class="n">success</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>            <span class="n">fail</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">)</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">is_success</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="k">if</span> <span class="n">is_success</span><span class="p">:</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>            <span class="n">success</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>            <span class="n">fail</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>        <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">is_success</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="k">if</span> <span class="n">is_success</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>            <span class="n">success</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>            <span class="n">fail</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>        <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>        <span class="n">is_success</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>        <span class="k">if</span> <span class="n">is_success</span><span class="p">:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>            <span class="n">success</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>            <span class="n">fail</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="n">is_success</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">if</span> <span class="n">is_success</span><span class="p">:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>            <span class="n">success</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>            <span class="n">fail</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="n">is_success</span><span class="p">,</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">calc_atan2_expr</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">if</span> <span class="n">is_success</span><span class="p">:</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>            <span class="n">success</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>            <span class="n">fail</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">total</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_diff</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Success: </span><span class="si">{</span><span class="n">success</span><span class="si">}</span><span class="s2">, Fail: </span><span class="si">{</span><span class="n">fail</span><span class="si">}</span><span class="s2">, Total: </span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2025, yuygfgg
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>